<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Origin::BuilderPlugin
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Origin.html" title="Origin (module)">Origin</a></span></span>
     &raquo; 
    <span class="title">BuilderPlugin</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Origin::BuilderPlugin
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../OpenShift/Builder.html" title="OpenShift::Builder (class)">OpenShift::Builder</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Thor</li>
          
            <li class="next"><span class='object_link'><a href="../OpenShift/Builder.html" title="OpenShift::Builder (class)">OpenShift::Builder</a></span></li>
          
            <li class="next">Origin::BuilderPlugin</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../OpenShift/BuilderHelper.html" title="OpenShift::BuilderHelper (module)">OpenShift::BuilderHelper</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">origin-dev-tools/build/devenv</dd>
  
</dl>
<div class="clear"></div>


  <h2>Constant Summary</h2>
  



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../OpenShift/SSH.html" title="OpenShift::SSH (module)">OpenShift::SSH</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../OpenShift/SSH.html#SCP_CMD-constant" title="OpenShift::SSH::SCP_CMD (constant)">OpenShift::SSH::SCP_CMD</a></span>, <span class='object_link'><a href="../OpenShift/SSH.html#SSH_CMD-constant" title="OpenShift::SSH::SSH_CMD (constant)">OpenShift::SSH::SSH_CMD</a></span></p>





  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_vm_image-instance_method" title="#build_vm_image (instance method)">- (Object) <strong>build_vm_image</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Task to build an OpenShift Origin VM image.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#docs-instance_method" title="#docs (instance method)">- (Object) <strong>docs</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Task to build YARD documentation for all Ruby Code.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#install_required_packages-instance_method" title="#install_required_packages (instance method)">- (Object) <strong>install_required_packages</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#local_build-instance_method" title="#local_build (instance method)">- (Object) <strong>local_build</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#release_build-instance_method" title="#release_build (instance method)">- (Object) <strong>release_build</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tag_for_release-instance_method" title="#tag_for_release (instance method)">- (Object) <strong>tag_for_release</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../OpenShift/BuilderHelper.html" title="OpenShift::BuilderHelper (module)">OpenShift::BuilderHelper</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../OpenShift/BuilderHelper.html#add_ssh_cmd_to_threads-instance_method" title="OpenShift::BuilderHelper#add_ssh_cmd_to_threads (method)">#add_ssh_cmd_to_threads</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#build_and_install-instance_method" title="OpenShift::BuilderHelper#build_and_install (method)">#build_and_install</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#devenv_base_branch_wildcard-instance_method" title="OpenShift::BuilderHelper#devenv_base_branch_wildcard (method)">#devenv_base_branch_wildcard</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#devenv_branch_wildcard-instance_method" title="OpenShift::BuilderHelper#devenv_branch_wildcard (method)">#devenv_branch_wildcard</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#get_host_by_name_or_tag-instance_method" title="OpenShift::BuilderHelper#get_host_by_name_or_tag (method)">#get_host_by_name_or_tag</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#get_ignore_packages-instance_method" title="OpenShift::BuilderHelper#get_ignore_packages (method)">#get_ignore_packages</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#get_required_packages-instance_method" title="OpenShift::BuilderHelper#get_required_packages (method)">#get_required_packages</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#get_sorted_package_names-instance_method" title="OpenShift::BuilderHelper#get_sorted_package_names (method)">#get_sorted_package_names</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#init_repos-instance_method" title="OpenShift::BuilderHelper#init_repos (method)">#init_repos</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#mcollective_logs-instance_method" title="OpenShift::BuilderHelper#mcollective_logs (method)">#mcollective_logs</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#print_and_exit-instance_method" title="OpenShift::BuilderHelper#print_and_exit (method)">#print_and_exit</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#print_highlighted_output-instance_method" title="OpenShift::BuilderHelper#print_highlighted_output (method)">#print_highlighted_output</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#reboot-instance_method" title="OpenShift::BuilderHelper#reboot (method)">#reboot</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#repo_clone_commands-instance_method" title="OpenShift::BuilderHelper#repo_clone_commands (method)">#repo_clone_commands</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#repo_path-instance_method" title="OpenShift::BuilderHelper#repo_path (method)">#repo_path</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#reset_temp_commit-instance_method" title="OpenShift::BuilderHelper#reset_temp_commit (method)">#reset_temp_commit</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#reset_test_dir-instance_method" title="OpenShift::BuilderHelper#reset_test_dir (method)">#reset_test_dir</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#retry_test_failures-instance_method" title="OpenShift::BuilderHelper#retry_test_failures (method)">#retry_test_failures</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#run_ssh-instance_method" title="OpenShift::BuilderHelper#run_ssh (method)">#run_ssh</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#scp_remote_tests-instance_method" title="OpenShift::BuilderHelper#scp_remote_tests (method)">#scp_remote_tests</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#sync_available_sibling_repos-instance_method" title="OpenShift::BuilderHelper#sync_available_sibling_repos (method)">#sync_available_sibling_repos</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#sync_repo-instance_method" title="OpenShift::BuilderHelper#sync_repo (method)">#sync_repo</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#sync_repos-instance_method" title="OpenShift::BuilderHelper#sync_repos (method)">#sync_repos</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#sync_sibling_repo-instance_method" title="OpenShift::BuilderHelper#sync_sibling_repo (method)">#sync_sibling_repo</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#temp_commit-instance_method" title="OpenShift::BuilderHelper#temp_commit (method)">#temp_commit</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#update_api_file-instance_method" title="OpenShift::BuilderHelper#update_api_file (method)">#update_api_file</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#update_express_server-instance_method" title="OpenShift::BuilderHelper#update_express_server (method)">#update_express_server</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#update_remote_tests-instance_method" title="OpenShift::BuilderHelper#update_remote_tests (method)">#update_remote_tests</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#update_ssh_config_verifier-instance_method" title="OpenShift::BuilderHelper#update_ssh_config_verifier (method)">#update_ssh_config_verifier</a></span>, <span class='object_link'><a href="../OpenShift/BuilderHelper.html#update_test_bundle-instance_method" title="OpenShift::BuilderHelper#update_test_bundle (method)">#update_test_bundle</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../OpenShift/Amazon.html" title="OpenShift::Amazon (module)">OpenShift::Amazon</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../OpenShift/Amazon.html#add_tag-instance_method" title="OpenShift::Amazon#add_tag (method)">#add_tag</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#block_until_available-instance_method" title="OpenShift::Amazon#block_until_available (method)">#block_until_available</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#check_update-instance_method" title="OpenShift::Amazon#check_update (method)">#check_update</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#connect-instance_method" title="OpenShift::Amazon#connect (method)">#connect</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#delete_detached_volumes-instance_method" title="OpenShift::Amazon#delete_detached_volumes (method)">#delete_detached_volumes</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#delete_unused_snapshots-instance_method" title="OpenShift::Amazon#delete_unused_snapshots (method)">#delete_unused_snapshots</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#find_instance-instance_method" title="OpenShift::Amazon#find_instance (method)">#find_instance</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#flag_old_devenvs-instance_method" title="OpenShift::Amazon#flag_old_devenvs (method)">#flag_old_devenvs</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#flag_old_qe_devenvs-instance_method" title="OpenShift::Amazon#flag_old_qe_devenvs (method)">#flag_old_qe_devenvs</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#get_amis-instance_method" title="OpenShift::Amazon#get_amis (method)">#get_amis</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#get_internal_hostname-instance_method" title="OpenShift::Amazon#get_internal_hostname (method)">#get_internal_hostname</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#get_latest_ami-instance_method" title="OpenShift::Amazon#get_latest_ami (method)">#get_latest_ami</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#get_private_ip-instance_method" title="OpenShift::Amazon#get_private_ip (method)">#get_private_ip</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#get_specific_ami-instance_method" title="OpenShift::Amazon#get_specific_ami (method)">#get_specific_ami</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#get_specific_public_ami-instance_method" title="OpenShift::Amazon#get_specific_public_ami (method)">#get_specific_public_ami</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#instance_status-instance_method" title="OpenShift::Amazon#instance_status (method)">#instance_status</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#is_valid%3F-instance_method" title="OpenShift::Amazon#is_valid? (method)">#is_valid?</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#launch_instance-instance_method" title="OpenShift::Amazon#launch_instance (method)">#launch_instance</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#register_image-instance_method" title="OpenShift::Amazon#register_image (method)">#register_image</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#set_instance_ip-instance_method" title="OpenShift::Amazon#set_instance_ip (method)">#set_instance_ip</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#setup_rsa_key-instance_method" title="OpenShift::Amazon#setup_rsa_key (method)">#setup_rsa_key</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#stop_untagged_instances-instance_method" title="OpenShift::Amazon#stop_untagged_instances (method)">#stop_untagged_instances</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#tag_to_terminate-instance_method" title="OpenShift::Amazon#tag_to_terminate (method)">#tag_to_terminate</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#terminate_flagged_instances-instance_method" title="OpenShift::Amazon#terminate_flagged_instances (method)">#terminate_flagged_instances</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#terminate_instance-instance_method" title="OpenShift::Amazon#terminate_instance (method)">#terminate_instance</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#terminate_old_verifiers-instance_method" title="OpenShift::Amazon#terminate_old_verifiers (method)">#terminate_old_verifiers</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#update_facts-instance_method" title="OpenShift::Amazon#update_facts (method)">#update_facts</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#use_private_ip-instance_method" title="OpenShift::Amazon#use_private_ip (method)">#use_private_ip</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#use_public_ip-instance_method" title="OpenShift::Amazon#use_public_ip (method)">#use_public_ip</a></span>, <span class='object_link'><a href="../OpenShift/Amazon.html#verify_image-instance_method" title="OpenShift::Amazon#verify_image (method)">#verify_image</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../OpenShift/SSH.html" title="OpenShift::SSH (module)">OpenShift::SSH</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../OpenShift/SSH.html#can_ssh%3F-instance_method" title="OpenShift::SSH#can_ssh? (method)">#can_ssh?</a></span>, <span class='object_link'><a href="../OpenShift/SSH.html#scp_from-instance_method" title="OpenShift::SSH#scp_from (method)">#scp_from</a></span>, <span class='object_link'><a href="../OpenShift/SSH.html#scp_to-instance_method" title="OpenShift::SSH#scp_to (method)">#scp_to</a></span>, <span class='object_link'><a href="../OpenShift/SSH.html#ssh-instance_method" title="OpenShift::SSH#ssh (method)">#ssh</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../OpenShift/Tito.html" title="OpenShift::Tito (module)">OpenShift::Tito</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../OpenShift/Tito.html#get_build_dirs-instance_method" title="OpenShift::Tito#get_build_dirs (method)">#get_build_dirs</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#get_packages-instance_method" title="OpenShift::Tito#get_packages (method)">#get_packages</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#get_stale_dirs-instance_method" title="OpenShift::Tito#get_stale_dirs (method)">#get_stale_dirs</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#get_sync_dirs-instance_method" title="OpenShift::Tito#get_sync_dirs (method)">#get_sync_dirs</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#get_version-instance_method" title="OpenShift::Tito#get_version (method)">#get_version</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#get_yum_version-instance_method" title="OpenShift::Tito#get_yum_version (method)">#get_yum_version</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#next_minor_version-instance_method" title="OpenShift::Tito#next_minor_version (method)">#next_minor_version</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#next_patch_version-instance_method" title="OpenShift::Tito#next_patch_version (method)">#next_patch_version</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#next_tito_version-instance_method" title="OpenShift::Tito#next_tito_version (method)">#next_tito_version</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#update_gemfile_version-instance_method" title="OpenShift::Tito#update_gemfile_version (method)">#update_gemfile_version</a></span>, <span class='object_link'><a href="../OpenShift/Tito.html#update_sync_history-instance_method" title="OpenShift::Tito#update_sync_history (method)">#update_sync_history</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../OpenShift/Builder.html" title="OpenShift::Builder (class)">OpenShift::Builder</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../OpenShift/Builder.html#build-instance_method" title="OpenShift::Builder#build (method)">#build</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#clone_addtl_repos-instance_method" title="OpenShift::Builder#clone_addtl_repos (method)">#clone_addtl_repos</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#find_and_build_specs-instance_method" title="OpenShift::Builder#find_and_build_specs (method)">#find_and_build_specs</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#install_local_client-instance_method" title="OpenShift::Builder#install_local_client (method)">#install_local_client</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#launch-instance_method" title="OpenShift::Builder#launch (method)">#launch</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#print_hostname-instance_method" title="OpenShift::Builder#print_hostname (method)">#print_hostname</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#sanity_check-instance_method" title="OpenShift::Builder#sanity_check (method)">#sanity_check</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#sync-instance_method" title="OpenShift::Builder#sync (method)">#sync</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#terminate-instance_method" title="OpenShift::Builder#terminate (method)">#terminate</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#test-instance_method" title="OpenShift::Builder#test (method)">#test</a></span>, <span class='object_link'><a href="../OpenShift/Builder.html#update-instance_method" title="OpenShift::Builder#update (method)">#update</a></span></p>

  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="build_vm_image-instance_method">
  
    - (<tt>Object</tt>) <strong>build_vm_image</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Task to build an OpenShift Origin VM image
</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Thor options hash
</p>
<ul>
<li>--verbose: Enable verbose logging

</li>
</ul>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-dev-tools/build/devenv', line 68</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_build_vm_image identifier id'>build_vm_image</span>
  <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span> <span class='integer val'>? </span><span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_DEBUG constant id'>DEBUG</span> <span class='colon op'>:</span> <span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_ERROR constant id'>ERROR</span>
  <span class='rubyid_def_constants identifier id'>def_constants</span><span class='lparen token'>(</span><span class='rubyid_guess_os identifier id'>guess_os</span><span class='lparen token'>(</span><span class='string val'>&quot;fedora&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

  <span class='comment val'># Override the machine type to launch if necessary</span>
  <span class='rubyid_$amz_options gvar id'>$amz_options</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_type</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_type</span><span class='rbrack token'>]</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_type</span><span class='rbrack token'>]</span>
  <span class='rubyid_$amz_options gvar id'>$amz_options</span><span class='lbrack token'>[</span><span class='symbol val'>:block_device_mappings</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='string val'>&quot;/dev/sdb&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;ephemeral0&quot;</span><span class='rbrace token'>}</span>
  
  <span class='comment val'># Establish a new connection</span>
  <span class='rubyid_conn identifier id'>conn</span> <span class='assign token'>=</span> <span class='rubyid_connect identifier id'>connect</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_region identifier id'>region</span><span class='rparen token'>)</span>
  
  <span class='rubyid_image identifier id'>image</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='comment val'># Create a new builder instance</span>
  <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_region? fid id'>region?</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_image identifier id'>image</span> <span class='assign token'>=</span> <span class='rubyid_conn identifier id'>conn</span><span class='dot token'>.</span><span class='rubyid_images identifier id'>images</span><span class='lbrack token'>[</span><span class='rubyid_AMI constant id'>AMI</span><span class='lbrack token'>[</span><span class='string val'>&quot;us-east-1&quot;</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
  <span class='rubyid_elsif elsif kw'>elsif</span> <span class='rubyid_AMI constant id'>AMI</span><span class='lbrack token'>[</span><span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_region identifier id'>region</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;No AMI specified for region:&quot;</span> <span class='plus op'>+</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_region identifier id'>region</span>
    <span class='rubyid_exit identifier id'>exit</span> <span class='integer val'>1</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_image identifier id'>image</span> <span class='assign token'>=</span> <span class='rubyid_conn identifier id'>conn</span><span class='dot token'>.</span><span class='rubyid_images identifier id'>images</span><span class='lbrack token'>[</span><span class='rubyid_AMI constant id'>AMI</span><span class='lbrack token'>[</span><span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_region identifier id'>region</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Launching AMI: #{image.id} - #{image.name}&quot;</span>
  <span class='rubyid_instance identifier id'>instance</span> <span class='assign token'>=</span> <span class='rubyid_launch_instance identifier id'>launch_instance</span><span class='lparen token'>(</span><span class='rubyid_image identifier id'>image</span><span class='comma token'>,</span> <span class='string val'>&quot;oso-image-builder&quot;</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
  <span class='rubyid_hostname identifier id'>hostname</span> <span class='assign token'>=</span> <span class='rubyid_instance identifier id'>instance</span><span class='dot token'>.</span><span class='rubyid_dns_name identifier id'>dns_name</span>
  <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Done&quot;</span>
  <span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Hostname: #{hostname}&quot;</span>
  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_ssh identifier id'>ssh</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='string val'>'su - -c &quot;setenforce 0&quot;'</span> <span class='comma token'>,</span> <span class='integer val'>60</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_ssh identifier id'>ssh</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='string val'>'su - -c &quot;yum update -y&quot;'</span> <span class='comma token'>,</span> <span class='integer val'>300</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_ssh identifier id'>ssh</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='string val'>'su - -c &quot;yum install -y appliance-tools qemu-img&quot;'</span> <span class='comma token'>,</span> <span class='integer val'>60</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_scp_to identifier id'>scp_to</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{__FILE__ }/../templates/openshift-origin.ks&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>'/home/ec2-user/'</span><span class='comma token'>,</span> <span class='integer val'>60</span><span class='comma token'>,</span> <span class='integer val'>5</span><span class='comma token'>,</span><span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_scp_to identifier id'>scp_to</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{__FILE__ }/../templates/openshift-origin.vmx&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>'/home/ec2-user/'</span><span class='comma token'>,</span> <span class='integer val'>60</span><span class='comma token'>,</span> <span class='integer val'>5</span><span class='comma token'>,</span><span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_scp_to identifier id'>scp_to</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{__FILE__ }/../templates/openshift-origin.ovf&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>'/home/ec2-user/'</span><span class='comma token'>,</span> <span class='integer val'>60</span><span class='comma token'>,</span> <span class='integer val'>5</span><span class='comma token'>,</span><span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>      
    <span class='rubyid_ssh identifier id'>ssh</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='string val'>'su - -c &quot;mv -f /home/ec2-user/openshift-origin.ks /mnt/&quot;'</span> <span class='comma token'>,</span> <span class='integer val'>60</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_ssh identifier id'>ssh</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='string val'>'su - -c &quot;mkdir -p /mnt/tmp/build &amp;&amp; mkdir -p /mnt/openshift-origin&quot;'</span><span class='comma token'>,</span> <span class='integer val'>60</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span><span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_ssh identifier id'>ssh</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='string val'>'su - -c &quot;cd /mnt &amp;&amp; appliance-creator -d -n openshift-origin -c openshift-origin.ks '</span> <span class='plus op'>+</span>
        <span class='string val'>'--format=vmdk --vmem=1024 --checksum --logfile=build.log --tmpdir=/mnt/tmp/build --cache /mnt/tmp/cache/&quot;'</span><span class='comma token'>,</span> <span class='integer val'>3600</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_ssh identifier id'>ssh</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='string val'>'su - -c &quot;'</span> <span class='plus op'>+</span> <span class='string val'>%{
      /bin/cp -f /mnt/openshift-origin.ks /mnt/openshift-origin/ &amp;&amp;
      /bin/mv -f /home/ec2-user/openshift-origin.v* /mnt/openshift-origin/ &amp;&amp; 
      /bin/mv -f /home/ec2-user/openshift-origin.ovf /mnt/openshift-origin/ &amp;&amp; 
      cd /mnt/openshift-origin &amp;&amp; tar zcf openshift-origin.tgz *
    }</span> <span class='plus op'>+</span> <span class='string val'>'&quot;'</span> <span class='comma token'>,</span> <span class='integer val'>3600</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkdir_p identifier id'>mkdir_p</span> <span class='string val'>&quot;vm/&quot;</span>
    <span class='rubyid_scp_from identifier id'>scp_from</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='comma token'>,</span> <span class='string val'>&quot;/mnt/openshift-origin/openshift-origin.tgz&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;vm/&quot;</span><span class='comma token'>,</span> <span class='integer val'>1200</span><span class='comma token'>,</span> <span class='rubyid_SSH_USER constant id'>SSH_USER</span><span class='rparen token'>)</span>
  <span class='rubyid_ensure ensure kw'>ensure</span>
    <span class='rubyid_begin begin kw'>begin</span>
      <span class='rubyid_terminate_instance identifier id'>terminate_instance</span><span class='lparen token'>(</span><span class='rubyid_hostname identifier id'>hostname</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_terminate identifier id'>terminate</span>
    <span class='rubyid_rescue rescue kw'>rescue</span>
      <span class='comment val'># suppress termination errors - they have been logged already</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="docs-instance_method">
  
    - (<tt>Object</tt>) <strong>docs</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Task to build YARD documentation for all Ruby Code
</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Thor options hash
</p>
<ul>
<li>--verbose: Enable verbose logging

</li>
</ul>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-dev-tools/build/devenv', line 29</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_docs identifier id'>docs</span>
  <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span> <span class='integer val'>? </span><span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_DEBUG constant id'>DEBUG</span> <span class='colon op'>:</span> <span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_ERROR constant id'>ERROR</span>
  <span class='rubyid_repo_parent_dir identifier id'>repo_parent_dir</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{File.dirname(__FILE__)}/../../&quot;</span><span class='rparen token'>)</span>      
  <span class='rubyid_remove_dir identifier id'>remove_dir</span> <span class='dstring node'>&quot;#{repo_parent_dir}/origin-docs&quot;</span>
  <span class='rubyid_empty_directory identifier id'>empty_directory</span> <span class='dstring node'>&quot;#{repo_parent_dir}/origin-docs&quot;</span>
  
  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='string val'>&quot;/tmp/yard-js&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;git clone git://github.com/lsegal/yard-js /tmp/yard-js&quot;</span>
    <span class='rubyid_inside identifier id'>inside</span><span class='lparen token'>(</span><span class='string val'>&quot;/tmp/yard-js&quot;</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;bundle install&quot;</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_inside identifier id'>inside</span><span class='lparen token'>(</span><span class='rubyid_repo_parent_dir identifier id'>repo_parent_dir</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span>
    <span class='rubyid_doc_files identifier id'>doc_files</span> <span class='assign token'>=</span> <span class='rubyid_Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;#{repo_parent_dir}/origin-server/documentation/*.md&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;,&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_inside identifier id'>inside</span><span class='lparen token'>(</span><span class='string val'>&quot;origin-server/documentation&quot;</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='rubyid_run identifier id'>run</span> <span class='dstring node'>&quot;yardoc --markup=markdown --output-dir '#{repo_parent_dir}/origin-docs' --files #{doc_files}&quot;</span> <span class='rbrace token'>}</span>
    
    <span class='rubyid_doc_files identifier id'>doc_files</span> <span class='assign token'>=</span> <span class='rubyid_Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;#{repo_parent_dir}/origin-server/controller/*.md&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;,&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_run identifier id'>run</span> <span class='dstring node'>%{yardoc --output-dir '#{repo_parent_dir}/origin-docs/broker' --files #{doc_files} --main origin-server/controller/README.md --private --protected --exclude test \
      #{Dir[&quot;origin-server/broker/**/*.rb&quot;].join(' ')} \
      #{Dir[&quot;origin-server/controller/**/*.rb&quot;].join(' ')}}</span>
      
    <span class='rubyid_run identifier id'>run</span> <span class='dstring node'>%{yardoc --output-dir '#{repo_parent_dir}/origin-docs/rest_api' --main origin-server/controller/README.rest_api.md --api REST \
      #{Dir[&quot;origin-server/controller/**/*.rb&quot;].join(' ')}}</span>
    <span class='rubyid_run identifier id'>run</span> <span class='dstring node'>&quot;yardoc --output-dir '#{repo_parent_dir}/origin-docs/broker_models' --main origin-server/controller/README.models.md --private --protected --api model #{Dir[&quot;origin-server/controller/**/*.rb&quot;].join(' ')}&quot;</span>
    
    <span class='rubyid_doc_files identifier id'>doc_files</span> <span class='assign token'>=</span> <span class='rubyid_Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;#{repo_parent_dir}/origin-server/node/*.md&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;,&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_run identifier id'>run</span> <span class='dstring node'>&quot;yardoc --output-dir '#{repo_parent_dir}/origin-docs/node' --main origin-server/node/README.md --private --protected --files #{doc_files} --exclude test #{Dir[&quot;origin-server/node/**/*.rb&quot;].join(' ')}&quot;</span>
    
    <span class='rubyid_run identifier id'>run</span> <span class='dstring node'>&quot;yardoc --output-dir '#{repo_parent_dir}/origin-docs/common' --main origin-server/common/README.md --private --protected --exclude test #{Dir[&quot;origin-server/common/**/*.rb&quot;].join(' ')}&quot;</span>
    <span class='rubyid_run identifier id'>run</span> <span class='dstring node'>&quot;yardoc --output-dir '#{repo_parent_dir}/origin-docs/build-tools' --main origin-dev-tools/README.md --private --protected --exclude test #{Dir[&quot;origin-dev-tools/build/*&quot;].join(' ')}&quot;</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="install_required_packages-instance_method">
  
    - (<tt>Object</tt>) <strong>install_required_packages</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-dev-tools/build/devenv', line 127</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_install_required_packages identifier id'>install_required_packages</span>
  <span class='rubyid_base_os identifier id'>base_os</span> <span class='assign token'>=</span> <span class='rubyid_guess_os identifier id'>guess_os</span>
  <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Install packages required for build&quot;</span>
  
  <span class='rubyid_if if kw'>if</span> <span class='xstring val'>`rpm -q activemq`</span><span class='dot token'>.</span><span class='rubyid_match identifier id'>match</span><span class='lparen token'>(</span><span class='regexp val'>/is not installed/</span><span class='rparen token'>)</span>
    <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;yum erase -y activemq&quot;</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_base_os identifier id'>base_os</span> <span class='eq op'>==</span> <span class='string val'>&quot;fedora&quot;</span>
      <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;yum install -y https://mirror.openshift.com/pub/origin-server/fedora-18/x86_64/activemq-5.6.0-4.fc18.x86_64.rpm&quot;</span>
    <span class='rubyid_elsif elsif kw'>elsif</span><span class='lparen token'>(</span><span class='rubyid_base_os identifier id'>base_os</span> <span class='eq op'>==</span> <span class='string val'>&quot;rhel&quot;</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_base_os identifier id'>base_os</span> <span class='eq op'>==</span> <span class='string val'>&quot;centos&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;yum install -y https://mirror.openshift.com/pub/origin-server/rhel-6/x86_64/activemq-5.6.0-1.el6_3.x86_64.rpm&quot;</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_base_os identifier id'>base_os</span> <span class='eq op'>==</span> <span class='string val'>&quot;fedora&quot;</span>
    <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;yum -y update --enablerepo updates-testing ruby ruby-irb ruby-libs ruby-devel&quot;</span>
    <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>&quot;gem install rspec -v '1.1.12'&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo&quot;</span>
  <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;rpm --import http://pkg.jenkins-ci.org/redhat/jenkins-ci.org.key&quot;</span>      
  <span class='rubyid_run identifier id'>run</span> <span class='string val'>&quot;yum install -y tito make tig mlocate bash-completion activemq-client&quot;</span>

  <span class='rubyid_old_install_required_packages identifier id'>old_install_required_packages</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="local_build-instance_method">
  
    - (<tt>Object</tt>) <strong>local_build</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-dev-tools/build/devenv', line 159</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_local_build identifier id'>local_build</span>
  <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span> <span class='integer val'>? </span><span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_DEBUG constant id'>DEBUG</span> <span class='colon op'>:</span> <span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_ERROR constant id'>ERROR</span>
  <span class='rubyid_def_constants identifier id'>def_constants</span><span class='lparen token'>(</span><span class='rubyid_guess_os identifier id'>guess_os</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_base_os identifier id'>base_os</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_incremental identifier id'>incremental</span>
    <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_retry_failure_with_tag identifier id'>retry_failure_with_tag</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
    <span class='rubyid_update identifier id'>update</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_f identifier id'>rm_f</span> <span class='string val'>&quot;/etc/yum.repos.d/openshift-origin.repo&quot;</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span> <span class='string val'>&quot;/tmp/tito&quot;</span>
    
    <span class='rubyid_packages identifier id'>packages</span> <span class='assign token'>=</span> <span class='rubyid_get_packages identifier id'>get_packages</span><span class='lparen token'>(</span><span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_values identifier id'>values</span>

    <span class='rubyid_if if kw'>if</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_clean_packages? fid id'>clean_packages?</span>
      <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>&quot;yum clean all&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
      <span class='rubyid_package_names identifier id'>package_names</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;\&quot;#{packages.join(&quot;\&quot; \&quot;&quot;)}\&quot;&quot;</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Removing stale packages...&quot;</span>
      <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='dstring node'>&quot;yum erase -y #{package_names}&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
    
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_update_packages? fid id'>update_packages?</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Updating all packages on the system...&quot;</span>
      <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>&quot;yum update -y --exclude activemq&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Done&quot;</span>
    <span class='rubyid_end end kw'>end</span>

    <span class='rubyid_find_and_build_specs identifier id'>find_and_build_specs</span>

    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span> <span class='string val'>&quot;/root/origin-rpms&quot;</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span> <span class='string val'>&quot;/data/origin-srpms&quot;</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkdir_p identifier id'>mkdir_p</span> <span class='string val'>&quot;/root/origin-rpms&quot;</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkdir_p identifier id'>mkdir_p</span> <span class='string val'>&quot;/data/origin-srpms&quot;</span>        
    <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>&quot;/etc/yum.repos.d/openshift-origin.repo&quot;</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_out identifier id'>out</span><span class='bitor op'>|</span>
      <span class='rubyid_out identifier id'>out</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>%{
[openshift-origin]
name    = openshift-origin
baseurl = file:///root/origin-rpms
gpgcheck= 0
enabled = 1
retries = 0
      }</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>&quot;cp /tmp/tito/x86_64/*.rpm /root/origin-rpms/; cp /tmp/tito/noarch/*.rpm /root/origin-rpms/; createrepo /root/origin-rpms/&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='dstring node'>&quot;cp /tmp/tito/*.src.rpm /data/origin-srpms/; chown -R #{SSH_USER}:#{SSH_USER} /data/origin-srpms&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>&quot;yum clean all&quot;</span><span class='rparen token'>)</span>
    
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_install? fid id'>install?</span>
      <span class='rubyid_packages_to_install identifier id'>packages_to_install</span> <span class='assign token'>=</span> <span class='rubyid_packages identifier id'>packages</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_p identifier id'>p</span><span class='bitor op'>|</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_IGNORE_PACKAGES constant id'>IGNORE_PACKAGES</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_p identifier id'>p</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
      <span class='rubyid_package_list identifier id'>package_list</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;\&quot;#{packages_to_install.join(&quot;\&quot; \&quot;&quot;)}\&quot;&quot;</span>
      <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='dstring node'>&quot;yum install -y #{package_list}&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
      
      <span class='comment val'>#mark all packages as sync'd</span>
      <span class='rubyid_get_sync_dirs identifier id'>get_sync_dirs</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="release_build-instance_method">
  
    - (<tt>Object</tt>) <strong>release_build</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-dev-tools/build/devenv', line 219</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_release_build identifier id'>release_build</span>
  <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span> <span class='integer val'>? </span><span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_DEBUG constant id'>DEBUG</span> <span class='colon op'>:</span> <span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_ERROR constant id'>ERROR</span>
  <span class='rubyid_def_constants identifier id'>def_constants</span><span class='lparen token'>(</span><span class='rubyid_guess_os identifier id'>guess_os</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_base_os identifier id'>base_os</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

  <span class='rubyid_branch identifier id'>branch</span> <span class='assign token'>=</span> <span class='rubyid_get_branch identifier id'>get_branch</span>
  <span class='rubyid_orig_branches identifier id'>orig_branches</span> <span class='assign token'>=</span> <span class='rubyid_checkout_branch identifier id'>checkout_branch</span><span class='lparen token'>(</span><span class='rubyid_branch identifier id'>branch</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span><span class='rparen token'>)</span>

  <span class='comment val'>#Fail if there are any uncomitted changes</span>
  <span class='rubyid_SIBLING_REPOS constant id'>SIBLING_REPOS</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_repo_name identifier id'>repo_name</span><span class='comma token'>,</span> <span class='rubyid_repo_dirs identifier id'>repo_dirs</span><span class='bitor op'>|</span> 
    <span class='rubyid_repo_dirs identifier id'>repo_dirs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='bitor op'>|</span> 
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exists? fid id'>exists?</span><span class='lparen token'>(</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='rparen token'>)</span> 
        <span class='rubyid_inside identifier id'>inside</span><span class='lparen token'>(</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> 
          <span class='rubyid_raise identifier id'>raise</span> <span class='dstring node'>&quot;You have uncommited changes in #{repo_dir}, cannot bump versions&quot;</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>'git diff --quiet'</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
 
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_f identifier id'>rm_f</span> <span class='string val'>&quot;/etc/yum.repos.d/openshift-origin.repo&quot;</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span> <span class='string val'>&quot;/tmp/tito&quot;</span>

  <span class='rubyid_failed_builds identifier id'>failed_builds</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_build_dirs identifier id'>build_dirs</span> <span class='assign token'>=</span> <span class='rubyid_get_packages identifier id'>get_packages</span><span class='lparen token'>(</span><span class='rubyid_false false kw'>false</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_build_dirs identifier id'>build_dirs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_package_name identifier id'>package_name</span><span class='comma token'>,</span> <span class='rubyid_build_info identifier id'>build_info</span><span class='bitor op'>|</span>
    <span class='rubyid_next next kw'>next</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_IGNORE_PACKAGES constant id'>IGNORE_PACKAGES</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span> <span class='rubyid_package_name identifier id'>package_name</span>
    <span class='rubyid_print identifier id'>print</span> <span class='rubyid_package_name identifier id'>package_name</span><span class='comma token'>,</span> <span class='rubyid_build_info identifier id'>build_info</span><span class='dot token'>.</span><span class='rubyid_pretty_inspect identifier id'>pretty_inspect</span><span class='comma token'>,</span> <span class='string val'>&quot;\n&quot;</span>
    <span class='rubyid_build_dir identifier id'>build_dir</span> <span class='assign token'>=</span> <span class='rubyid_build_info identifier id'>build_info</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='rubyid_working_dir identifier id'>working_dir</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='dstring node'>&quot;../#{build_dir}&quot;</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='rubyid___FILE__ __file__ kw'>__FILE__</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rubyid_inside identifier id'>inside</span><span class='lparen token'>(</span><span class='rubyid_working_dir identifier id'>working_dir</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Building #{build_dir}&quot;</span>
      <span class='comment val'>#unless run(&quot;tito build --builder mock --builder-arg mock=fedora-18-x86_64 --rpm&quot;, :verbose =&gt; options.verbose?)</span>
      <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>&quot;tito build --rpm&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:verbose</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span><span class='rparen token'>)</span>
        <span class='rubyid_failed_builds identifier id'>failed_builds</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_build_dir identifier id'>build_dir</span> 
        <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Build failed&quot;</span>
        <span class='rubyid_exit identifier id'>exit</span> <span class='integer val'>1</span>
      <span class='rubyid_else else kw'>else</span>
        <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Done&quot;</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span> <span class='string val'>&quot;/root/origin-rpms&quot;</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span> <span class='string val'>&quot;/data/origin-srpms&quot;</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkdir_p identifier id'>mkdir_p</span> <span class='string val'>&quot;/root/origin-rpms&quot;</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkdir_p identifier id'>mkdir_p</span> <span class='string val'>&quot;/data/origin-srpms&quot;</span>
  <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>&quot;/etc/yum.repos.d/openshift-origin.repo&quot;</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_out identifier id'>out</span><span class='bitor op'>|</span>
      <span class='rubyid_out identifier id'>out</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>%{
[openshift-origin]
name    = openshift-origin
baseurl = file:///root/origin-rpms
gpgcheck= 0
enabled = 1
retries = 0
      }</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>&quot;cp /tmp/tito/x86_64/*.rpm /root/origin-rpms/; cp /tmp/tito/noarch/*.rpm /root/origin-rpms/; createrepo /root/origin-rpms/&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='dstring node'>&quot;cp /tmp/tito/*.src.rpm /data/origin-srpms/; chown -R #{SSH_USER}:#{SSH_USER} /data/origin-srpms&quot;</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>&quot;yum clean all&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tag_for_release-instance_method">
  
    - (<tt>Object</tt>) <strong>tag_for_release</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-dev-tools/build/devenv', line 282</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_tag_for_release identifier id'>tag_for_release</span>
  <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span> <span class='integer val'>? </span><span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_DEBUG constant id'>DEBUG</span> <span class='colon op'>:</span> <span class='rubyid_@@log ivar id'>@@log</span><span class='dot token'>.</span><span class='rubyid_level identifier id'>level</span> <span class='assign token'>=</span> <span class='rubyid_Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='rubyid_ERROR constant id'>ERROR</span>
  <span class='rubyid_base_os identifier id'>base_os</span> <span class='assign token'>=</span> <span class='rubyid_guess_os identifier id'>guess_os</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_base_os identifier id'>base_os</span><span class='rparen token'>)</span>
  <span class='rubyid_def_constants identifier id'>def_constants</span><span class='lparen token'>(</span><span class='rubyid_base_os identifier id'>base_os</span><span class='rparen token'>)</span>

  <span class='rubyid_branch identifier id'>branch</span> <span class='assign token'>=</span> <span class='rubyid_get_branch identifier id'>get_branch</span>
  <span class='rubyid_orig_branches identifier id'>orig_branches</span> <span class='assign token'>=</span> <span class='rubyid_checkout_branch identifier id'>checkout_branch</span><span class='lparen token'>(</span><span class='rubyid_branch identifier id'>branch</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span><span class='rparen token'>)</span>

  <span class='comment val'>#Fail if there are any uncomitted changes</span>
  <span class='rubyid_SIBLING_REPOS constant id'>SIBLING_REPOS</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_repo_name identifier id'>repo_name</span><span class='comma token'>,</span> <span class='rubyid_repo_dirs identifier id'>repo_dirs</span><span class='bitor op'>|</span> 
    <span class='rubyid_repo_dirs identifier id'>repo_dirs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='bitor op'>|</span> 
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exists? fid id'>exists?</span><span class='lparen token'>(</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='rparen token'>)</span> 
        <span class='rubyid_inside identifier id'>inside</span><span class='lparen token'>(</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> 
          <span class='rubyid_raise identifier id'>raise</span> <span class='dstring node'>&quot;You have uncommited changes in #{repo_dir}, cannot bump versions&quot;</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>'git diff --quiet'</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_build_dirs identifier id'>build_dirs</span> <span class='assign token'>=</span> <span class='rubyid_get_build_dirs identifier id'>get_build_dirs</span>
  <span class='rubyid_tag_failures identifier id'>tag_failures</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_build_dirs identifier id'>build_dirs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_build_info identifier id'>build_info</span><span class='bitor op'>|</span>
    <span class='rubyid_build_dir identifier id'>build_dir</span> <span class='assign token'>=</span> <span class='rubyid_build_info identifier id'>build_info</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
    <span class='rubyid_working_dir identifier id'>working_dir</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='dstring node'>&quot;../#{build_dir}&quot;</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='rubyid___FILE__ __file__ kw'>__FILE__</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rubyid_inside identifier id'>inside</span><span class='lparen token'>(</span><span class='rubyid_working_dir identifier id'>working_dir</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span>
      <span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Tagging #{build_dir}&quot;</span>
  
      <span class='comment val'># packages without versioning steps</span>
      <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='string val'>'tito tag --accept-auto-changelog'</span><span class='rparen token'>)</span>
        <span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Failed to tag #{build_dir}&quot;</span>
        <span class='rubyid_tag_failures identifier id'>tag_failures</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_build_dir identifier id'>build_dir</span>
      <span class='rubyid_end end kw'>end</span>
  
      <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Done&quot;</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_tag_failures identifier id'>tag_failures</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_build_dir identifier id'>build_dir</span><span class='bitor op'>|</span>
    <span class='rubyid_build_dirs identifier id'>build_dirs</span><span class='dot token'>.</span><span class='rubyid_delete_if identifier id'>delete_if</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span> <span class='rubyid_build_info identifier id'>build_info</span> <span class='bitor op'>|</span> <span class='rubyid_build_info identifier id'>build_info</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='rubyid_build_dir identifier id'>build_dir</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_push_failures identifier id'>push_failures</span> <span class='assign token'>=</span> <span class='string val'>''</span>
  <span class='rubyid_SIBLING_REPOS constant id'>SIBLING_REPOS</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_repo_name identifier id'>repo_name</span><span class='comma token'>,</span> <span class='rubyid_repo_dirs identifier id'>repo_dirs</span><span class='bitor op'>|</span>
    <span class='rubyid_repo_dirs identifier id'>repo_dirs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='bitor op'>|</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exists? fid id'>exists?</span><span class='lparen token'>(</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='rparen token'>)</span>
        <span class='rubyid_inside identifier id'>inside</span><span class='lparen token'>(</span><span class='rubyid_repo_dir identifier id'>repo_dir</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span>
          <span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Pushing #{repo_dir}&quot;</span>
          <span class='rubyid_branch identifier id'>branch</span> <span class='assign token'>=</span> <span class='rubyid_get_branch identifier id'>get_branch</span>
          <span class='rubyid_push_cmd identifier id'>push_cmd</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;git fetch --tags &amp;&amp; git pull &amp;&amp; git push origin #{branch} &amp;&amp; git push --tags&quot;</span>
          <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_run identifier id'>run</span><span class='lparen token'>(</span><span class='rubyid_push_cmd identifier id'>push_cmd</span><span class='comma token'>,</span> <span class='symbol val'>:verbose</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_options identifier id'>options</span><span class='dot token'>.</span><span class='rubyid_verbose? fid id'>verbose?</span><span class='rparen token'>)</span>
            <span class='rubyid_push_failures identifier id'>push_failures</span> <span class='opasgn op'>+=</span> <span class='dstring node'>&quot;pushd #{repo_dir} &gt; /dev/null; #{push_cmd}; popd &gt; /dev/null;\n&quot;</span>
          <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_break break kw'>break</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Apr 26 21:01:35 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-1.8.7).
</div>

  </body>
</html>