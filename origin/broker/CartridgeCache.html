<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: CartridgeCache
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (C)</a> &raquo;
    
    
    <span class="title">CartridgeCache</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: CartridgeCache
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">CartridgeCache</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="CacheHelper.html" title="CacheHelper (module)">CacheHelper</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Cache of cartridge manifest metadata. Used to reduce the number of calls 
to the Node to retrieve cartridge information.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cartridge_names-class_method" title="cartridge_names (class method)">+ (Object) <strong>cartridge_names</strong>(cart_type = nil, app = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an Array of cartridge names.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cartridges-class_method" title="cartridges (class method)">+ (Object) <strong>cartridges</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an Array of Cartridge objects.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#download_from_url-class_method" title="download_from_url (class method)">+ (Object) <strong>download_from_url</strong>(url) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fetch_community_carts-class_method" title="fetch_community_carts (class method)">+ (Object) <strong>fetch_community_carts</strong>(urls) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_all_cartridges-class_method" title="find_all_cartridges (class method)">+ (Object) <strong>find_all_cartridges</strong>(requested_feature) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_cartridge-class_method" title="find_cartridge (class method)">+ (Object) <strong>find_cartridge</strong>(requested_feature, app = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the first cartridge that provides the specified feature.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_cartridge_by_category-class_method" title="find_cartridge_by_category (class method)">+ (Object) <strong>find_cartridge_by_category</strong>(cat, app = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#foreach_cart_version-class_method" title="foreach_cart_version (class method)">+ (Object) <strong>foreach_cart_version</strong>(manifest_str, software_version = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_yaml-class_method" title="validate_yaml (class method)">+ (Object) <strong>validate_yaml</strong>(url, str) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="CacheHelper.html" title="CacheHelper (module)">CacheHelper</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="CacheHelper.html#get_cached-class_method" title="CacheHelper.get_cached (method)">get_cached</a></span></p>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cartridge_names-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>cartridge_names</strong>(cart_type = nil, app = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an Array of cartridge names.</p>

<h2 id="label-Parameters%3A">Parameters:<span><a href="#label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h2>
<dl class="rdoc-list note-list"><dt>cart_type
<dd>
<p>Specify to return only names of cartridges which have specified cartridge
categories</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29
30
31
32
33
34
35
36
37
38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 28</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_names'>cartridge_names</span><span class='lparen'>(</span><span class='id identifier rubyid_cart_type'>cart_type</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_cart_type'>cart_type</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_cartnames'>cartnames</span> <span class='op'>=</span> <span class='const'>CacheHelper</span><span class='period'>.</span><span class='id identifier rubyid_get_cached'>get_cached</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cart_names_all</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:expires_in</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_cartridges'>cartridges</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_cart'>cart</span><span class='op'>|</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_app'>app</span>
      <span class='id identifier rubyid_cartnames'>cartnames</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_downloaded_cartridges'>downloaded_cartridges</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
      <span class='id identifier rubyid_cartnames'>cartnames</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_cartnames'>cartnames</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_cart_type'>cart_type</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>web_framework</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_cart_type'>cart_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>standalone</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_find_cartridge_by_category'>find_cartridge_by_category</span><span class='lparen'>(</span><span class='id identifier rubyid_cart_type'>cart_type</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_cart'>cart</span><span class='op'>|</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cartridges-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>cartridges</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an Array of Cartridge objects</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 7</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cartridges'>cartridges</span>
  <span class='const'>CacheHelper</span><span class='period'>.</span><span class='id identifier rubyid_get_cached'>get_cached</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>all_cartridges</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:expires_in</span> <span class='op'>=&gt;</span> <span class='int'>21600</span><span class='period'>.</span><span class='id identifier rubyid_seconds'>seconds</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_carts'>carts</span> <span class='op'>=</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>ApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_find_one'>find_one</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get_available_cartridges'>get_available_cartridges</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>if</span> <span class='id identifier rubyid_carts'>carts</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_carts'>carts</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='heredoc_beg'>&lt;&lt;-&quot;ERROR&quot;</span>
<span class='tstring_content'>  In </span><span class='embexpr_beg'>#{</span><span class='kw'>__FILE__</span><span class='embexpr_end'>}</span><span class='tstring_content'> cartridges method:
    Error while querying cartridge list. This may be because no node hosts responded.
    Please ensure you have installed node hosts and they are responding to &quot;mco ping&quot;.
    Exception was: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>
</span><span class='heredoc_end'>  ERROR
</span>  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="download_from_url-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>download_from_url</strong>(url) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 136</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_download_from_url'>download_from_url</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_max_dl_time'>max_dl_time</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_downloaded_cartridges'>downloaded_cartridges</span><span class='lbracket'>[</span><span class='symbol'>:max_download_time</span><span class='rbracket'>]</span> <span class='kw'>rescue</span> <span class='int'>10</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>10</span>
  <span class='id identifier rubyid_max_file_size'>max_file_size</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_downloaded_cartridges'>downloaded_cartridges</span><span class='lbracket'>[</span><span class='symbol'>:max_cart_size</span><span class='rbracket'>]</span> <span class='kw'>rescue</span> <span class='int'>20480</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>20480</span>
  <span class='id identifier rubyid_max_redirs'>max_redirs</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_downloaded_cartridges'>downloaded_cartridges</span><span class='lbracket'>[</span><span class='symbol'>:max_download_redirects</span><span class='rbracket'>]</span> <span class='kw'>rescue</span> <span class='int'>2</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>2</span>
  <span class='id identifier rubyid_rate_limit'>rate_limit</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_downloaded_cartridges'>downloaded_cartridges</span><span class='lbracket'>[</span><span class='symbol'>:max_download_rate</span><span class='rbracket'>]</span> <span class='kw'>rescue</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>100k</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>100k</span><span class='tstring_end'>&quot;</span></span> 
  <span class='id identifier rubyid_manifest'>manifest</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  
  <span class='id identifier rubyid_uri_obj'>uri_obj</span> <span class='op'>=</span> <span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_uri_obj'>uri_obj</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>URI</span><span class='op'>::</span><span class='const'>HTTP</span> <span class='kw'>or</span> <span class='id identifier rubyid_uri_obj'>uri_obj</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span> <span class='const'>URI</span><span class='op'>::</span><span class='const'>FTP</span>
    <span class='id identifier rubyid_rout'>rout</span><span class='comma'>,</span><span class='id identifier rubyid_wout'>wout</span> <span class='op'>=</span> <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_pipe'>pipe</span>
    <span class='id identifier rubyid_rerr'>rerr</span><span class='comma'>,</span><span class='id identifier rubyid_werr'>werr</span> <span class='op'>=</span> <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_pipe'>pipe</span>
    <span class='id identifier rubyid_pid'>pid</span> <span class='op'>=</span> <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_spawn'>spawn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>curl</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-H</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>X-OpenShift-Cartridge-Download:1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--max-time</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_max_dl_time'>max_dl_time</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--limit-rate</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_rate_limit'>rate_limit</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--connect-timeout</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--location</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--max-redirs</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_max_redirs'>max_redirs</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--max-filesize</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_max_file_size'>max_file_size</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-k</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='symbol'>:out</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_wout'>wout</span><span class='comma'>,</span> <span class='symbol'>:err</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_werr'>werr</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
      <span class='const'>Timeout</span><span class='op'>::</span><span class='id identifier rubyid_timeout'>timeout</span><span class='lparen'>(</span><span class='id identifier rubyid_max_dl_time'>max_dl_time</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
        <span class='id identifier rubyid_p'>p</span><span class='comma'>,</span><span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_waitpid2'>waitpid2</span><span class='lparen'>(</span><span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_wout'>wout</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
        <span class='id identifier rubyid_werr'>werr</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_exitstatus'>exitstatus</span><span class='op'>==</span><span class='int'>0</span>
          <span class='id identifier rubyid_manifest'>manifest</span> <span class='op'>=</span> <span class='id identifier rubyid_rout'>rout</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_rout'>rout</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
        <span class='id identifier rubyid_rerr'>rerr</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
      <span class='rbrace'>}</span>
    <span class='kw'>rescue</span> <span class='const'>Timeout</span><span class='op'>::</span><span class='const'>Error</span>
      <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_kill'>kill</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SIGKILL</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_pid'>pid</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># manifest = `curl --max-time #{max_dl_time} --limit-rate #{rate_limit} --connect-timeout 2 --location --max-redirs #{max_redirs} --max-filesize #{max_file_size} -k #{url}`
</span>  <span class='kw'>end</span>
  <span class='id identifier rubyid_manifest'>manifest</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fetch_community_carts-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>fetch_community_carts</strong>(urls) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 194</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch_community_carts'>fetch_community_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_urls'>urls</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cmap'>cmap</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_cmap'>cmap</span> <span class='kw'>if</span> <span class='id identifier rubyid_urls'>urls</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_urls'>urls</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_url'>url</span><span class='op'>|</span>
     <span class='id identifier rubyid_manifest_str'>manifest_str</span> <span class='op'>=</span> <span class='id identifier rubyid_download_from_url'>download_from_url</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span>
     <span class='id identifier rubyid_chash'>chash</span> <span class='op'>=</span> <span class='id identifier rubyid_validate_yaml'>validate_yaml</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_manifest_str'>manifest_str</span><span class='rparen'>)</span>
     
     <span class='comment'># check if Cartridge-Vendor is reserved
</span>     <span class='id identifier rubyid_manifest'>manifest</span> <span class='op'>=</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Runtime</span><span class='op'>::</span><span class='const'>Manifest</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest_str'>manifest_str</span><span class='rparen'>)</span>
     <span class='kw'>begin</span>
       <span class='id identifier rubyid_manifest'>manifest</span><span class='period'>.</span><span class='id identifier rubyid_check_reserved_vendor_name'>check_reserved_vendor_name</span>
     <span class='kw'>rescue</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>InvalidElementError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_iee'>iee</span>
       <span class='comment'># cloaking it as a UserException until Manifest starts raising subclasses of OOException 
</span>       <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_iee'>iee</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='int'>109</span><span class='rparen'>)</span>
     <span class='kw'>end</span>
     
     <span class='comment'># TODO: check versions and create multiple of them
</span>     <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_foreach_cart_version'>foreach_cart_version</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest_str'>manifest_str</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_chash'>chash</span><span class='comma'>,</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='id identifier rubyid_version'>version</span><span class='comma'>,</span><span class='id identifier rubyid_vendored_name'>vendored_name</span><span class='op'>|</span>
       <span class='comment'># do a trial parsing of the chash(v1 manifest) so that we do not store a manifest that will not get through elaborate later on
</span>       <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Cartridge</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_from_descriptor'>from_descriptor</span><span class='lparen'>(</span><span class='id identifier rubyid_chash'>chash</span><span class='rparen'>)</span>

       <span class='comment'># all good, no exception above
</span>       <span class='id identifier rubyid_cmap'>cmap</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>versioned_name</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_vendored_name'>vendored_name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>url</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>original_manifest</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_manifest_str'>manifest_str</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_version'>version</span><span class='rbrace'>}</span>
       <span class='comment'># no versioning support on downloaded cartridges yet.. use the default one
</span>       <span class='kw'>break</span>
     <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_cmap'>cmap</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_all_cartridges-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>find_all_cartridges</strong>(requested_feature) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 86</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_cartridges'>find_all_cartridges</span><span class='lparen'>(</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rparen'>)</span>
  
  <span class='id identifier rubyid_carts'>carts</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cartridges'>cartridges</span>







  <span class='id identifier rubyid_cartname_hash'>cartname_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_cartname_version_hash'>cartname_version_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_vendor_cartname_hash'>vendor_cartname_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_vendor_cartname_version_hash'>vendor_cartname_version_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  
  <span class='id identifier rubyid_carts'>carts</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
    <span class='id identifier rubyid_cartname'>cartname</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span>
    <span class='id identifier rubyid_cartname_hash'>cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_cartname'>cartname</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_cartname_hash'>cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_cartname'>cartname</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_cartname_hash'>cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_cartname'>cartname</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>

    <span class='id identifier rubyid_cartname_version'>cartname_version</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>
    <span class='id identifier rubyid_cartname_version_hash'>cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_cartname_version'>cartname_version</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_cartname_version_hash'>cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_cartname_version'>cartname_version</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_cartname_version_hash'>cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_cartname_version'>cartname_version</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>

    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_vendor_cartname'>vendor_cartname</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span>
    <span class='id identifier rubyid_vendor_cartname_hash'>vendor_cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_vendor_cartname'>vendor_cartname</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_vendor_cartname_hash'>vendor_cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_vendor_cartname'>vendor_cartname</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_vendor_cartname_hash'>vendor_cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_vendor_cartname'>vendor_cartname</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>

    <span class='id identifier rubyid_vendor_cartname_version'>vendor_cartname_version</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_original_name'>original_name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>
    <span class='id identifier rubyid_vendor_cartname_version_hash'>vendor_cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_vendor_cartname_version'>vendor_cartname_version</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_vendor_cartname_version_hash'>vendor_cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_vendor_cartname_version'>vendor_cartname_version</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_vendor_cartname_version_hash'>vendor_cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_vendor_cartname_version'>vendor_cartname_version</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_c'>c</span>
  <span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_cartname_hash'>cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_cartname_hash'>cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_cartname_version_hash'>cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_cartname_version_hash'>cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_vendor_cartname_hash'>vendor_cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_vendor_cartname_hash'>vendor_cartname_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_vendor_cartname_version_hash'>vendor_cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_vendor_cartname_version_hash'>vendor_cartname_version_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rbracket'>]</span>
  
  <span class='id identifier rubyid_matching_carts'>matching_carts</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  
  <span class='id identifier rubyid_carts'>carts</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cart'>cart</span><span class='op'>|</span>
    <span class='id identifier rubyid_matching_carts'>matching_carts</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cart'>cart</span> <span class='kw'>if</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_features'>features</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rparen'>)</span> 
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_matching_carts'>matching_carts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_cartridge-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>find_cartridge</strong>(requested_feature, app = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This method matches both features provided by the cartridge as well as the
cartridge name.</p>
</div>
  </div>


<p>Returns the first cartridge that provides the specified feature.</p>

<h2 id="label-Parameters%3A">Parameters:<span><a href="#label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h2>
<dl class="rdoc-list note-list"><dt>feature
<dd>
<p>Name of feature to look for.</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="OpenShift/UserException.html" title="OpenShift::UserException (class)">OpenShift::UserException</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 59</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_cartridge'>find_cartridge</span><span class='lparen'>(</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_downloaded_cartridges'>downloaded_cartridges</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cart'>cart</span><span class='op'>|</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_cart'>cart</span> <span class='kw'>if</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_features'>features</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_cart'>cart</span> <span class='kw'>if</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='id identifier rubyid_requested_feature'>requested_feature</span>
  <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_app'>app</span>
  
  <span class='id identifier rubyid_matching_carts'>matching_carts</span> <span class='op'>=</span> <span class='const'>CacheHelper</span><span class='period'>.</span><span class='id identifier rubyid_get_cached'>get_cached</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>carts_by_feature_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:expires_in</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_all_cartridges'>find_all_cartridges</span><span class='lparen'>(</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_matching_carts'>matching_carts</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_matching_carts'>matching_carts</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_matching_carts'>matching_carts</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span>
  
  <span class='comment'>#if any is by redhat return that one
</span>  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_matching_carts'>matching_carts</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>redhat</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_cart'>cart</span> <span class='kw'>if</span> <span class='id identifier rubyid_cart'>cart</span>
  
  <span class='comment'>#if there are more than one match and none by redhat raise an exception
</span>  <span class='id identifier rubyid_choices'>choices</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_matching_carts'>matching_carts</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cart'>cart</span><span class='op'>|</span>
    <span class='id identifier rubyid_choices'>choices</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>More that one cartridge was found matching </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_requested_feature'>requested_feature</span><span class='embexpr_end'>}</span><span class='tstring_content'>.  Please select one of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_choices'>choices</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_cartridge_by_category-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>find_cartridge_by_category</strong>(cat, app = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44
45
46
47
48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 42</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_cartridge_by_category'>find_cartridge_by_category</span><span class='lparen'>(</span><span class='id identifier rubyid_cat'>cat</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_global_carts'>global_carts</span> <span class='op'>=</span> <span class='const'>CacheHelper</span><span class='period'>.</span><span class='id identifier rubyid_get_cached'>get_cached</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cartridges_by_cat_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cat'>cat</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:expires_in</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='id identifier rubyid_cartridges'>cartridges</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_cart'>cart</span><span class='op'>|</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_categories'>categories</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cat'>cat</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_app'>app</span>
    <span class='id identifier rubyid_app_local_community_carts'>app_local_community_carts</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_downloaded_cartridges'>downloaded_cartridges</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_cart'>cart</span><span class='op'>|</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_categories'>categories</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cat'>cat</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_global_carts'>global_carts</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_app_local_community_carts'>app_local_community_carts</span>
    <span class='id identifier rubyid_global_carts'>global_carts</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_global_carts'>global_carts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="foreach_cart_version-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>foreach_cart_version</strong>(manifest_str, software_version = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


168
169
170
171
172
173
174
175
176
177
178
179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 168</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_foreach_cart_version'>foreach_cart_version</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest_str'>manifest_str</span><span class='comma'>,</span> <span class='id identifier rubyid_software_version'>software_version</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cartridge'>cartridge</span> <span class='op'>=</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Runtime</span><span class='op'>::</span><span class='const'>Manifest</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest_str'>manifest_str</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cartridge'>cartridge</span><span class='period'>.</span><span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_version'>version</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_software_version'>software_version</span> <span class='kw'>and</span> <span class='id identifier rubyid_version'>version</span><span class='op'>!=</span><span class='id identifier rubyid_software_version'>software_version</span>
    <span class='id identifier rubyid_cooked'>cooked</span> <span class='op'>=</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Runtime</span><span class='op'>::</span><span class='const'>Manifest</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_manifest_str'>manifest_str</span><span class='comma'>,</span> <span class='id identifier rubyid_version'>version</span><span class='rparen'>)</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Loading </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='embexpr_end'>}</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_v1_manifest'>v1_manifest</span>            <span class='op'>=</span> <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_manifest'>manifest</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='comment'># Appending the version to the cartridge name is being done in the common cartridge model 
</span>    <span class='comment'>#v1_manifest[&#39;Name&#39;]    = &quot;#{cooked.name}-#{cooked.version}&quot;
</span>    <span class='id identifier rubyid_v1_manifest'>v1_manifest</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Version</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>
    <span class='id identifier rubyid_vendored_name'>vendored_name</span> <span class='op'>=</span>  <span class='id identifier rubyid_v1_manifest'>v1_manifest</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cartridge-Vendor</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_v1_manifest'>v1_manifest</span><span class='comma'>,</span><span class='id identifier rubyid_cooked'>cooked</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='id identifier rubyid_version'>version</span><span class='comma'>,</span><span class='id identifier rubyid_vendored_name'>vendored_name</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_yaml-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>validate_yaml</strong>(url, str) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="OpenShift/UserException.html" title="OpenShift::UserException (class)">OpenShift::UserException</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185
186
187
188
189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/helpers/cartridge_cache.rb', line 183</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_validate_yaml'>validate_yaml</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid cartridge, error downloading from url &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; </span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>109</span><span class='rparen'>)</span>  <span class='kw'>if</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='op'>==</span><span class='int'>0</span>
  <span class='comment'># raise OpenShift::UserException.new(&quot;Invalid manifest file from url &#39;#{url}&#39; - no structural directives allowed.&quot;) if str.include?(&quot;---&quot;)
</span>  <span class='kw'>begin</span>
    <span class='id identifier rubyid_chash'>chash</span> <span class='op'>=</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Runtime</span><span class='op'>::</span><span class='const'>Manifest</span><span class='period'>.</span><span class='id identifier rubyid_manifest_from_yaml'>manifest_from_yaml</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span> 
  <span class='kw'>rescue</span> <span class='const'>Exception</span><span class='op'>=&gt;</span><span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid manifest file from url &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_chash'>chash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Mon Jul 22 22:42:02 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>