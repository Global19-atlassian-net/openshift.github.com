<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: OpenShift::CartridgeRepository
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../OpenShift.html" title="OpenShift (module)">OpenShift</a></span></span>
     &raquo; 
    <span class="title">CartridgeRepository</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: OpenShift::CartridgeRepository
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">OpenShift::CartridgeRepository</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Enumerable, <span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span>, Singleton</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Singleton to provide management of cartridges installed on the system
</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="CARTRIDGE_REPO_DIR-constant" class="">CARTRIDGE_REPO_DIR =
          <div class="docstring">
  <div class="discussion">
    <p>
FIXME: move to node.conf
</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='string val'>'/var/lib/openshift/.cartridge_repository'</span>
</pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="NodeLogger.html#PROFILES-constant" title="OpenShift::NodeLogger::PROFILES (constant)">NodeLogger::PROFILES</a></span></p>


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#path-instance_method" title="#path (instance method)">- (Object) <strong>path</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Filesystem path to where cartridges are installed.
</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#extract-class_method" title="extract (class method)">+ (Object) <strong>extract</strong>(method, source, target) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#filesystem_copy-class_method" title="filesystem_copy (class method)">+ (Object) <strong>filesystem_copy</strong>(entries, target, black_list) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#instantiate_cartridge-class_method" title="instantiate_cartridge (class method)">+ (Object) <strong>instantiate_cartridge</strong>(cartridge, target, failure_remove = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#overlay_cartridge-class_method" title="overlay_cartridge (class method)">+ (Object) <strong>overlay_cartridge</strong>(cartridge, target) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#uri_copy-class_method" title="uri_copy (class method)">+ (Object) <strong>uri_copy</strong>(uri, temporary, md5 = nil) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#valid_cartridge_home-class_method" title="valid_cartridge_home (class method)">+ (Object) <strong>valid_cartridge_home</strong>(cartridge, path) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear-instance_method" title="#clear (instance method)">- (Object) <strong>clear</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#each-instance_method" title="#each (instance method)">- (Object) <strong>each</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#erase-instance_method" title="#erase (instance method)">- (Object) <strong>erase</strong>(cartridge_name, version, cartridge_version) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exist%3F-instance_method" title="#exist? (instance method)">- (Boolean) <strong>exist?</strong>(cartridge_name, cartridge_version, version) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_manifests-instance_method" title="#find_manifests (instance method)">- (Object) <strong>find_manifests</strong>(directory) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (CartridgeRepository) <strong>initialize</strong> </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:nodoc:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#insert-instance_method" title="#insert (instance method)">- (Object) <strong>insert</strong>(cartridge) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">- (Object) <strong>inspect</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
print out all index entries in a table.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#install-instance_method" title="#install (instance method)">- (Object) <strong>install</strong>(directory) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load-instance_method" title="#load (instance method)">- (Object) <strong>load</strong>(directory = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove-instance_method" title="#remove (instance method)">- (Object) <strong>remove</strong>(cartridge_name, version, cartridge_version) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select-instance_method" title="#select (instance method)">- (Object) <strong>select</strong>(cartridge_name, version = nil, cartridge_version = nil) </a>
    

    
      (also: #[])
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:call-seq:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">- (Object) <strong>to_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
print out all indexed cartridges in a table.
</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="NodeLogger.html#build_logger-class_method" title="OpenShift::NodeLogger.build_logger (method)">build_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger-instance_method" title="OpenShift::NodeLogger#logger (method)">#logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger-class_method" title="OpenShift::NodeLogger.logger (method)">logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger_rebuild-class_method" title="OpenShift::NodeLogger.logger_rebuild (method)">logger_rebuild</a></span>, <span class='object_link'><a href="NodeLogger.html#trace_logger-instance_method" title="OpenShift::NodeLogger#trace_logger (method)">#trace_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#trace_logger-class_method" title="OpenShift::NodeLogger.trace_logger (method)">trace_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#trace_rebuild-class_method" title="OpenShift::NodeLogger.trace_rebuild (method)">trace_rebuild</a></span></p>

  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="OpenShift::CartridgeRepository (class)">CartridgeRepository</a></span></tt>) <strong>initialize</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93
94
95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 91</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span> 
  <span class='rubyid_@path ivar id'>@path</span>      <span class='assign token'>=</span> <span class='rubyid_CARTRIDGE_REPO_DIR constant id'>CARTRIDGE_REPO_DIR</span>

  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkpath identifier id'>mkpath</span><span class='lparen token'>(</span><span class='rubyid_@path ivar id'>@path</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span> <span class='rubyid_@path ivar id'>@path</span>
  <span class='rubyid_clear identifier id'>clear</span>
  <span class='rubyid_load identifier id'>load</span> <span class='rubyid_@path ivar id'>@path</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="path-instance_method">
  
    - (<tt>Object</tt>) <strong>path</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Filesystem path to where cartridges are installed
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 89</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_path identifier id'>path</span>
  <span class='rubyid_@path ivar id'>@path</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="extract-class_method">
  
    + (<tt>Object</tt>) <strong>extract</strong>(method, source, target)  <span class="extras">(private)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 457</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_extract identifier id'>extract</span><span class='lparen token'>(</span><span class='rubyid_method identifier id'>method</span><span class='comma token'>,</span> <span class='rubyid_source identifier id'>source</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span>
  <span class='rubyid_case case kw'>case</span> <span class='rubyid_method identifier id'>method</span>
    <span class='rubyid_when when kw'>when</span> <span class='symbol val'>:zip</span>
      <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;/usr/bin/unzip -d #{target} #{source}&quot;</span><span class='comma token'>,</span>
                     <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='rubyid_when when kw'>when</span> <span class='symbol val'>:tgz</span>
      <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;/bin/tar -C #{target} -zxpf #{source}&quot;</span><span class='comma token'>,</span>
                     <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

    <span class='rubyid_when when kw'>when</span> <span class='symbol val'>:tar</span>
      <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;/bin/tar -C #{target} -xpf #{source}&quot;</span><span class='comma token'>,</span>
                     <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_raise identifier id'>raise</span> <span class='dstring node'>&quot;Packaging method #{method} not yet supported.&quot;</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_files identifier id'>files</span> <span class='assign token'>=</span> <span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_glob identifier id'>glob</span><span class='lparen token'>(</span><span class='rubyid_PathUtils constant id'>PathUtils</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_target identifier id'>target</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='integer val'>1</span> <span class='eq op'>==</span> <span class='rubyid_files identifier id'>files</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span>
    <span class='comment val'># A directory of one file is not legal move everyone up a level (github zip's are this way)</span>
    <span class='rubyid_to_delete identifier id'>to_delete</span> <span class='assign token'>=</span> <span class='rubyid_files identifier id'>files</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span> <span class='plus op'>+</span> <span class='string val'>'.to_delete'</span>
    <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_rename identifier id'>rename</span><span class='lparen token'>(</span><span class='rubyid_files identifier id'>files</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span><span class='comma token'>,</span> <span class='rubyid_to_delete identifier id'>to_delete</span><span class='rparen token'>)</span>

    <span class='rubyid_entries identifier id'>entries</span> <span class='assign token'>=</span> <span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_glob identifier id'>glob</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_to_delete identifier id'>to_delete</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_FNM_DOTMATCH constant id'>FNM_DOTMATCH</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_delete_if identifier id'>delete_if</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_e identifier id'>e</span><span class='bitor op'>|</span>
      <span class='dstring node'>%w(. ..)</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_basename identifier id'>basename</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>

    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_move identifier id'>move</span><span class='lparen token'>(</span><span class='rubyid_entries identifier id'>entries</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='comma token'>,</span> <span class='rubyid_verbose identifier id'>verbose</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span><span class='lparen token'>(</span><span class='rubyid_to_delete identifier id'>to_delete</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="filesystem_copy-class_method">
  
    + (<tt>Object</tt>) <strong>filesystem_copy</strong>(entries, target, black_list)  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


446
447
448
449
450
451
452
453
454
455</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 446</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_filesystem_copy identifier id'>filesystem_copy</span><span class='lparen token'>(</span><span class='rubyid_entries identifier id'>entries</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='comma token'>,</span> <span class='rubyid_black_list identifier id'>black_list</span><span class='rparen token'>)</span>
  <span class='rubyid_entries identifier id'>entries</span><span class='dot token'>.</span><span class='rubyid_delete_if identifier id'>delete_if</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_e identifier id'>e</span><span class='bitor op'>|</span>
    <span class='rubyid_black_list identifier id'>black_list</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_basename identifier id'>basename</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_ArgumentError constant id'>ArgumentError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'CLIENT_ERROR: No cartridge sources found to install.'</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_entries identifier id'>entries</span><span class='dot token'>.</span><span class='rubyid_empty? fid id'>empty?</span>

  <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;/bin/cp -ad #{entries.join(' ')} #{target}&quot;</span><span class='comma token'>,</span>
                 <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="instantiate_cartridge-class_method">
  
    + (<tt>Object</tt>) <strong>instantiate_cartridge</strong>(cartridge, target, failure_remove = true) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instantiate_cartridge(cartridge, path) -&gt; nil
</code></pre>
<p>
Instantiate a cartridge in a gear;
</p>
<pre class="code ruby18"><code class="ruby18">
  If the cartridge manifest_path is :url then source_url is used to obtain cartridge source
  Otherwise the cartridge source is copied from the cartridge_repository

  source_hash is used to ensure the download was successful.

  CartridgeRepository.instantiate_cartridge(perl_cartridge, '/var/lib/.../mock') =&gt; nil
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 342</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_instantiate_cartridge identifier id'>instantiate_cartridge</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='comma token'>,</span> <span class='rubyid_failure_remove identifier id'>failure_remove</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkpath identifier id'>mkpath</span> <span class='rubyid_target identifier id'>target</span>

  <span class='rubyid_if if kw'>if</span> <span class='symbol val'>:url</span> <span class='eq op'>==</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_manifest_path identifier id'>manifest_path</span>
    <span class='rubyid_uri identifier id'>uri</span>       <span class='assign token'>=</span> <span class='rubyid_URI constant id'>URI</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span><span class='rparen token'>)</span>
    <span class='rubyid_temporary identifier id'>temporary</span> <span class='assign token'>=</span> <span class='rubyid_PathUtils constant id'>PathUtils</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_basename identifier id'>basename</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_validate_vendor_name identifier id'>validate_vendor_name</span>
    <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_check_reserved_vendor_name identifier id'>check_reserved_vendor_name</span>
    <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_validate_cartridge_name identifier id'>validate_cartridge_name</span>

    <span class='rubyid_case case kw'>case</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>'git'</span> <span class='eq op'>==</span> <span class='rubyid_uri identifier id'>uri</span><span class='dot token'>.</span><span class='rubyid_scheme identifier id'>scheme</span> <span class='orop op'>||</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span><span class='dot token'>.</span><span class='rubyid_end_with? fid id'>end_with?</span><span class='lparen token'>(</span><span class='string val'>'.git'</span><span class='rparen token'>)</span>
        <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>%Q(set -xe;
                           git clone #{cartridge.source_url} #{cartridge.name};
                           GIT_DIR=./#{cartridge.name}/.git git repack)</span><span class='comma token'>,</span>
                        <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span>               <span class='rubyid_Pathname constant id'>Pathname</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_parent identifier id'>parent</span><span class='dot token'>.</span><span class='rubyid_to_path identifier id'>to_path</span><span class='comma token'>,</span>
                        <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

      <span class='rubyid_when when kw'>when</span> <span class='rubyid_uri identifier id'>uri</span><span class='dot token'>.</span><span class='rubyid_scheme identifier id'>scheme</span> <span class='match op'>=~</span> <span class='regexp val'>/^https*/</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span> <span class='match op'>=~</span> <span class='regexp val'>/\.zip/</span>
        <span class='rubyid_begin begin kw'>begin</span>
          <span class='rubyid_uri_copy identifier id'>uri_copy</span><span class='lparen token'>(</span><span class='rubyid_URI constant id'>URI</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_temporary identifier id'>temporary</span><span class='comma token'>,</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_md5 identifier id'>source_md5</span><span class='rparen token'>)</span>
          <span class='rubyid_extract identifier id'>extract</span><span class='lparen token'>(</span><span class='symbol val'>:zip</span><span class='comma token'>,</span> <span class='rubyid_temporary identifier id'>temporary</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span>
        <span class='rubyid_ensure ensure kw'>ensure</span>
          <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm identifier id'>rm</span><span class='lparen token'>(</span><span class='rubyid_temporary identifier id'>temporary</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

      <span class='rubyid_when when kw'>when</span> <span class='rubyid_uri identifier id'>uri</span><span class='dot token'>.</span><span class='rubyid_scheme identifier id'>scheme</span> <span class='match op'>=~</span> <span class='regexp val'>/^https*/</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span> <span class='match op'>=~</span> <span class='regexp val'>/(\.tar\.gz|\.tgz)$/</span>
        <span class='rubyid_begin begin kw'>begin</span>
          <span class='rubyid_uri_copy identifier id'>uri_copy</span><span class='lparen token'>(</span><span class='rubyid_URI constant id'>URI</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_temporary identifier id'>temporary</span><span class='comma token'>,</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_md5 identifier id'>source_md5</span><span class='rparen token'>)</span>
          <span class='rubyid_extract identifier id'>extract</span><span class='lparen token'>(</span><span class='symbol val'>:tgz</span><span class='comma token'>,</span> <span class='rubyid_temporary identifier id'>temporary</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span>
        <span class='rubyid_ensure ensure kw'>ensure</span>
          <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm identifier id'>rm</span><span class='lparen token'>(</span><span class='rubyid_temporary identifier id'>temporary</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

      <span class='rubyid_when when kw'>when</span> <span class='rubyid_uri identifier id'>uri</span><span class='dot token'>.</span><span class='rubyid_scheme identifier id'>scheme</span> <span class='match op'>=~</span> <span class='regexp val'>/^https*/</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span> <span class='match op'>=~</span> <span class='regexp val'>/\.tar$/</span>
        <span class='rubyid_begin begin kw'>begin</span>
          <span class='rubyid_uri_copy identifier id'>uri_copy</span><span class='lparen token'>(</span><span class='rubyid_URI constant id'>URI</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_url identifier id'>source_url</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_temporary identifier id'>temporary</span><span class='comma token'>,</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_source_md5 identifier id'>source_md5</span><span class='rparen token'>)</span>
          <span class='rubyid_extract identifier id'>extract</span><span class='lparen token'>(</span><span class='symbol val'>:tar</span><span class='comma token'>,</span> <span class='rubyid_temporary identifier id'>temporary</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span>
        <span class='rubyid_ensure ensure kw'>ensure</span>
          <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm identifier id'>rm</span><span class='lparen token'>(</span><span class='rubyid_temporary identifier id'>temporary</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>

      <span class='rubyid_when when kw'>when</span> <span class='string val'>'file'</span> <span class='eq op'>==</span> <span class='rubyid_uri identifier id'>uri</span><span class='dot token'>.</span><span class='rubyid_scheme identifier id'>scheme</span>
        <span class='rubyid_entries identifier id'>entries</span> <span class='assign token'>=</span> <span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_glob identifier id'>glob</span><span class='lparen token'>(</span><span class='rubyid_PathUtils constant id'>PathUtils</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_uri identifier id'>uri</span><span class='dot token'>.</span><span class='rubyid_path identifier id'>path</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_FNM_DOTMATCH constant id'>FNM_DOTMATCH</span><span class='rparen token'>)</span>
        <span class='rubyid_filesystem_copy identifier id'>filesystem_copy</span><span class='lparen token'>(</span><span class='rubyid_entries identifier id'>entries</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='comma token'>,</span> <span class='dstring node'>%w(. ..)</span><span class='rparen token'>)</span>

      <span class='rubyid_else else kw'>else</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_ArgumentError constant id'>ArgumentError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;CLIENT_ERROR: Unsupported URL(#{cartridge.source_url}) for downloading a private cartridge&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_entries identifier id'>entries</span> <span class='assign token'>=</span> <span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_glob identifier id'>glob</span><span class='lparen token'>(</span><span class='rubyid_PathUtils constant id'>PathUtils</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_repository_path identifier id'>repository_path</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_FNM_DOTMATCH constant id'>FNM_DOTMATCH</span><span class='rparen token'>)</span>
    <span class='rubyid_filesystem_copy identifier id'>filesystem_copy</span><span class='lparen token'>(</span><span class='rubyid_entries identifier id'>entries</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='comma token'>,</span> <span class='dstring node'>%w(. .. usr)</span><span class='rparen token'>)</span>

    <span class='rubyid_source_usr identifier id'>source_usr</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_repository_path identifier id'>repository_path</span><span class='comma token'>,</span> <span class='string val'>'usr'</span><span class='rparen token'>)</span>
    <span class='rubyid_target_usr identifier id'>target_usr</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_target identifier id'>target</span><span class='comma token'>,</span> <span class='string val'>'usr'</span><span class='rparen token'>)</span>

    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm identifier id'>rm</span><span class='lparen token'>(</span><span class='rubyid_target_usr identifier id'>target_usr</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_symlink? fid id'>symlink?</span><span class='lparen token'>(</span><span class='rubyid_target_usr identifier id'>target_usr</span><span class='rparen token'>)</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_symlink identifier id'>symlink</span><span class='lparen token'>(</span><span class='rubyid_source_usr identifier id'>source_usr</span><span class='comma token'>,</span> <span class='rubyid_target_usr identifier id'>target_usr</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_source_usr identifier id'>source_usr</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_target_usr identifier id'>target_usr</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_valid_cartridge_home identifier id'>valid_cartridge_home</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span>
<span class='rubyid_rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span> <span class='rubyid_target identifier id'>target</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_failure_remove identifier id'>failure_remove</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_e identifier id'>e</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="overlay_cartridge-class_method">
  
    + (<tt>Object</tt>) <strong>overlay_cartridge</strong>(cartridge, target) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.overlay_cartridge(cartridge, path) -&gt; nil
</code></pre>
<p>
Overlay new code over existing cartridge in a gear;
</p>
<pre class="code ruby18"><code class="ruby18">
  If the cartridge manifest_path is :url then source_url is used to obtain cartridge source
  Otherwise the cartridge source is copied from the cartridge_repository

  source_hash is used to ensure the download was successful.

  CartridgeRepository.overlay_cartridge(perl_cartridge, '/var/lib/.../mock') =&gt; nil
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 328</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_overlay_cartridge identifier id'>overlay_cartridge</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span>
  <span class='rubyid_instantiate_cartridge identifier id'>instantiate_cartridge</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='comma token'>,</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="uri_copy-class_method">
  
    + (<tt>Object</tt>) <strong>uri_copy</strong>(uri, temporary, md5 = nil)  <span class="extras">(private)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 410</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_uri_copy identifier id'>uri_copy</span><span class='lparen token'>(</span><span class='rubyid_uri identifier id'>uri</span><span class='comma token'>,</span> <span class='rubyid_temporary identifier id'>temporary</span><span class='comma token'>,</span> <span class='rubyid_md5 identifier id'>md5</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_content_length identifier id'>content_length</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span><span class='lparen token'>(</span><span class='rubyid_temporary identifier id'>temporary</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_output identifier id'>output</span><span class='bitor op'>|</span>
    <span class='rubyid_uri identifier id'>uri</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span><span class='lparen token'>(</span><span class='rubyid_ssl_verify_mode identifier id'>ssl_verify_mode</span><span class='colon op'>:</span>    <span class='rubyid_OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='rubyid_SSL constant id'>SSL</span><span class='colon2 op'>::</span><span class='rubyid_VERIFY_NONE constant id'>VERIFY_NONE</span><span class='comma token'>,</span>
             <span class='rubyid_content_length_proc identifier id'>content_length_proc</span><span class='colon op'>:</span> <span class='rubyid_lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_l identifier id'>l</span><span class='bitor op'>|</span> <span class='rubyid_content_length identifier id'>content_length</span> <span class='assign token'>=</span> <span class='rubyid_l identifier id'>l</span> <span class='rbrace token'>}</span>
    <span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_input identifier id'>input</span><span class='bitor op'>|</span>
      <span class='rubyid_input identifier id'>input</span><span class='dot token'>.</span><span class='rubyid_meta identifier id'>meta</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_total identifier id'>total</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
        <span class='rubyid_while while kw'>while</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_partial identifier id'>partial</span> <span class='assign token'>=</span> <span class='rubyid_input identifier id'>input</span><span class='dot token'>.</span><span class='rubyid_readpartial identifier id'>readpartial</span><span class='lparen token'>(</span><span class='integer val'>4096</span><span class='rparen token'>)</span>
          <span class='rubyid_total identifier id'>total</span>   <span class='opasgn op'>+=</span> <span class='rubyid_output identifier id'>output</span><span class='dot token'>.</span><span class='rubyid_write identifier id'>write</span> <span class='rubyid_partial identifier id'>partial</span>

          <span class='rubyid_if if kw'>if</span> <span class='rubyid_content_length identifier id'>content_length</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_content_length identifier id'>content_length</span> <span class='lt op'>&lt;</span> <span class='rubyid_total identifier id'>total</span>
            <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Net constant id'>Net</span><span class='colon2 op'>::</span><span class='rubyid_HTTPBadResponse constant id'>HTTPBadResponse</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;CLIENT_ERROR: Download of '#{uri}' exceeded Content-Length of #{content_length}. Download aborted.&quot;</span><span class='rparen token'>)</span>
          <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_EOFError constant id'>EOFError</span>
        <span class='comment val'># we are done</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_content_length identifier id'>content_length</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_content_length identifier id'>content_length</span> <span class='neq op'>!=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span><span class='lparen token'>(</span><span class='rubyid_temporary identifier id'>temporary</span><span class='rparen token'>)</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Net constant id'>Net</span><span class='colon2 op'>::</span><span class='rubyid_HTTPBadResponse constant id'>HTTPBadResponse</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span>
              <span class='dstring node'>&quot;CLIENT_ERROR: Download of '#{uri}' failed, expected Content-Length of #{content_length} received #{File.size(temporary)}&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_md5 identifier id'>md5</span>
    <span class='rubyid_digest identifier id'>digest</span> <span class='assign token'>=</span> <span class='rubyid_Digest constant id'>Digest</span><span class='colon2 op'>::</span><span class='rubyid_MD5 constant id'>MD5</span><span class='dot token'>.</span><span class='rubyid_file identifier id'>file</span><span class='lparen token'>(</span><span class='rubyid_temporary identifier id'>temporary</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_hexdigest identifier id'>hexdigest</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_digest identifier id'>digest</span> <span class='neq op'>!=</span> <span class='rubyid_md5 identifier id'>md5</span>
      <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_IOError constant id'>IOError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;CLIENT_ERROR: Failed to download cartridge, checksum failed: #{md5} expected, #{digest} actual&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="valid_cartridge_home-class_method">
  
    + (<tt>Object</tt>) <strong>valid_cartridge_home</strong>(cartridge, path)  <span class="extras">(private)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 489</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_valid_cartridge_home identifier id'>valid_cartridge_home</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span> <span class='rubyid_path identifier id'>path</span><span class='rparen token'>)</span>
  <span class='rubyid_errors identifier id'>errors</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='lbrack token'>[</span>
      <span class='lbrack token'>[</span><span class='rubyid_File constant id'>File</span><span class='comma token'>,</span> <span class='symbol val'>:directory?</span><span class='comma token'>,</span> <span class='dstring node'>%w(metadata)</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
      <span class='lbrack token'>[</span><span class='rubyid_File constant id'>File</span><span class='comma token'>,</span> <span class='symbol val'>:directory?</span><span class='comma token'>,</span> <span class='dstring node'>%w(bin)</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
      <span class='lbrack token'>[</span><span class='rubyid_File constant id'>File</span><span class='comma token'>,</span> <span class='symbol val'>:file?</span><span class='comma token'>,</span> <span class='dstring node'>%w(metadata manifest.yml)</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
      <span class='comment val'># [File, :executable?, %w(bin control)],</span>
  <span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_clazz identifier id'>clazz</span><span class='comma token'>,</span> <span class='rubyid_method identifier id'>method</span><span class='comma token'>,</span> <span class='rubyid_target identifier id'>target</span><span class='bitor op'>|</span>
    <span class='rubyid_relative identifier id'>relative</span> <span class='assign token'>=</span> <span class='rubyid_PathUtils constant id'>PathUtils</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_target identifier id'>target</span><span class='rparen token'>)</span>
    <span class='rubyid_absolute identifier id'>absolute</span> <span class='assign token'>=</span> <span class='rubyid_PathUtils constant id'>PathUtils</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_path identifier id'>path</span><span class='comma token'>,</span> <span class='rubyid_relative identifier id'>relative</span><span class='rparen token'>)</span>

    <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_clazz identifier id'>clazz</span><span class='dot token'>.</span><span class='rubyid_method identifier id'>method</span><span class='lparen token'>(</span><span class='rubyid_method identifier id'>method</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='lparen token'>(</span><span class='rubyid_absolute identifier id'>absolute</span><span class='rparen token'>)</span>
      <span class='rubyid_errors identifier id'>errors</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{relative} is not #{method}&quot;</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_errors identifier id'>errors</span><span class='dot token'>.</span><span class='rubyid_empty? fid id'>empty?</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_MalformedCartridgeError constant id'>MalformedCartridgeError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span>
              <span class='dstring node'>&quot;CLIENT_ERROR: Malformed cartridge (#{cartridge.name}, #{cartridge.version}, #{cartridge.cartridge_version})&quot;</span><span class='comma token'>,</span>
              <span class='rubyid_errors identifier id'>errors</span>
          <span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="clear-instance_method">
  
    - (<tt>Object</tt>) <strong>clear</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.clear -&gt; nil
</code></pre>
<p>
Clear all entries from the memory index. Nothing is removed from the disk.
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.clear #=&gt; nil
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 105</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_clear identifier id'>clear</span>
  <span class='rubyid_@index ivar id'>@index</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_h identifier id'>h</span><span class='comma token'>,</span> <span class='rubyid_k identifier id'>k</span><span class='bitor op'>|</span> <span class='rubyid_h identifier id'>h</span><span class='lbrack token'>[</span><span class='rubyid_k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_Hash constant id'>Hash</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='rubyid_h identifier id'>h</span><span class='dot token'>.</span><span class='rubyid_default_proc identifier id'>default_proc</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="each-instance_method">
  
    - (<tt>Object</tt>) <strong>each</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.each -&gt; Cartridge
</code></pre>
<p>
Process each unique cartridge
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.each {|c| puts c.name}
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


284
285
286
287
288
289
290
291
292
293
294
295
296
297
298</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 284</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_each identifier id'>each</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_to_enum identifier id'>to_enum</span><span class='lparen token'>(</span><span class='symbol val'>:each</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_block_given? fid id'>block_given?</span>

  <span class='rubyid_cartridges identifier id'>cartridges</span> <span class='assign token'>=</span> <span class='rubyid_Set constant id'>Set</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
  <span class='rubyid_@index ivar id'>@index</span><span class='dot token'>.</span><span class='rubyid_each_pair identifier id'>each_pair</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid__ identifier id'>_</span><span class='comma token'>,</span> <span class='rubyid_sw_hash identifier id'>sw_hash</span><span class='bitor op'>|</span>
    <span class='rubyid_sw_hash identifier id'>sw_hash</span><span class='dot token'>.</span><span class='rubyid_each_pair identifier id'>each_pair</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid__ identifier id'>_</span><span class='comma token'>,</span> <span class='rubyid_cart_hash identifier id'>cart_hash</span><span class='bitor op'>|</span>
      <span class='rubyid_cart_hash identifier id'>cart_hash</span><span class='dot token'>.</span><span class='rubyid_each_pair identifier id'>each_pair</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid__ identifier id'>_</span><span class='comma token'>,</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
        <span class='rubyid_cartridges identifier id'>cartridges</span><span class='dot token'>.</span><span class='rubyid_add identifier id'>add</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_cartridges identifier id'>cartridges</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_yield yield kw'>yield</span> <span class='rubyid_c identifier id'>c</span> <span class='rbrace token'>}</span>
  <span class='rubyid_self self kw'>self</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="erase-instance_method">
  
    - (<tt>Object</tt>) <strong>erase</strong>(cartridge_name, version, cartridge_version) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.erase(cartridge_name, version, cartridge_version) -&gt; Cartridge
</code></pre>
<p>
Erase given version of a cartridge from the cartridge repository and remove
from index. This cannot be undone.
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.erase('php', '3.5', '1.0') #=&gt; Cartridge
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 197</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_erase identifier id'>erase</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='comma token'>,</span> <span class='rubyid_version identifier id'>version</span><span class='comma token'>,</span> <span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='rparen token'>)</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='comma token'>,</span> <span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='comma token'>,</span> <span class='rubyid_version identifier id'>version</span><span class='rparen token'>)</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_KeyError constant id'>KeyError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;key not found: (#{cartridge_name}, #{version}, #{cartridge_version})&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_entry identifier id'>entry</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_$OpenShift_CartridgeRepository_SEMAPHORE gvar id'>$OpenShift_CartridgeRepository_SEMAPHORE</span><span class='dot token'>.</span><span class='rubyid_synchronize identifier id'>synchronize</span> <span class='rubyid_do do kw'>do</span>
    <span class='comment val'># find a &quot;template&quot; entry</span>
    <span class='rubyid_entry identifier id'>entry</span> <span class='assign token'>=</span> <span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='comma token'>,</span> <span class='rubyid_version identifier id'>version</span><span class='comma token'>,</span> <span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='rparen token'>)</span>

    <span class='comment val'># Now go back and find all occurrences of the &quot;template&quot;</span>
    <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each_key identifier id'>each_key</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_k2 identifier id'>k2</span><span class='bitor op'>|</span>
      <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_k2 identifier id'>k2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each_pair identifier id'>each_pair</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_k3 identifier id'>k3</span><span class='comma token'>,</span> <span class='rubyid_v3 identifier id'>v3</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_v3 identifier id'>v3</span><span class='dot token'>.</span><span class='rubyid_eql? fid id'>eql?</span><span class='lparen token'>(</span><span class='rubyid_entry identifier id'>entry</span><span class='rparen token'>)</span>
          <span class='rubyid_remove identifier id'>remove</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='comma token'>,</span> <span class='rubyid_k2 identifier id'>k2</span><span class='comma token'>,</span> <span class='rubyid_k3 identifier id'>k3</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>

    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_r identifier id'>rm_r</span><span class='lparen token'>(</span><span class='rubyid_entry identifier id'>entry</span><span class='dot token'>.</span><span class='rubyid_repository_path identifier id'>repository_path</span><span class='rparen token'>)</span>
    <span class='rubyid_parent identifier id'>parent</span> <span class='assign token'>=</span> <span class='rubyid_Pathname constant id'>Pathname</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_entry identifier id'>entry</span><span class='dot token'>.</span><span class='rubyid_repository_path identifier id'>repository_path</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_parent identifier id'>parent</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_r identifier id'>rm_r</span><span class='lparen token'>(</span><span class='rubyid_parent identifier id'>parent</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='integer val'>0</span> <span class='eq op'>==</span> <span class='rubyid_parent identifier id'>parent</span><span class='dot token'>.</span><span class='rubyid_children identifier id'>children</span><span class='dot token'>.</span><span class='rubyid_count identifier id'>count</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_entry identifier id'>entry</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exist?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>exist?</strong>(cartridge_name, cartridge_version, version) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.exists?(cartridge_name, cartridge_version, version)  -&gt; true or false
</code></pre>
<p>
Is there an entry in the repository for this tuple?
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.erase('cobol', '2002', '1.0') #=&gt; false
</code></pre>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


230
231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 230</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='comma token'>,</span> <span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='comma token'>,</span> <span class='rubyid_version identifier id'>version</span><span class='rparen token'>)</span>
  <span class='rubyid_@index ivar id'>@index</span><span class='dot token'>.</span><span class='rubyid_key? fid id'>key?</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span>
      <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_key? fid id'>key?</span><span class='lparen token'>(</span><span class='rubyid_version identifier id'>version</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span>
      <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_version identifier id'>version</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_key? fid id'>key?</span><span class='lparen token'>(</span><span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_manifests-instance_method">
  
    - (<tt>Object</tt>) <strong>find_manifests</strong>(directory) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.find_manifests(directory)
</code></pre>
<p>
Search the cartridge repository <tt>directory</tt> sub-directories for
cartridge manifest files
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.find_manifests(directory)
</code></pre>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


242
243
244
245
246
247
248</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 242</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_find_manifests identifier id'>find_manifests</span><span class='lparen token'>(</span><span class='rubyid_directory identifier id'>directory</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc: :yield: pathname</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_ArgumentError constant id'>ArgumentError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Illegal path to cartridge repository: '#{directory}'&quot;</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_directory? fid id'>directory?</span><span class='lparen token'>(</span><span class='rubyid_directory identifier id'>directory</span><span class='rparen token'>)</span>

  <span class='comment val'># wildcards: cartridges and cartridge versions</span>
  <span class='rubyid_glob identifier id'>glob</span> <span class='assign token'>=</span> <span class='rubyid_PathUtils constant id'>PathUtils</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_directory identifier id'>directory</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='comma token'>,</span> <span class='string val'>'metadata'</span><span class='comma token'>,</span> <span class='string val'>'manifest.yml'</span><span class='rparen token'>)</span>
  <span class='rubyid_Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='rubyid_glob identifier id'>glob</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_e identifier id'>e</span><span class='bitor op'>|</span> <span class='rubyid_yield yield kw'>yield</span> <span class='rubyid_e identifier id'>e</span> <span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="insert-instance_method">
  
    - (<tt>Object</tt>) <strong>insert</strong>(cartridge) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.insert(cartridge) -&gt; Cartridge
</code></pre>
<p>
Insert cartridge into index
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.insert(cartridge) -&gt; Cartridge
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


269
270
271
272
273
274
275
276</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 269</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_insert identifier id'>insert</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_versions identifier id'>versions</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_version identifier id'>version</span><span class='bitor op'>|</span>
    <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_version identifier id'>version</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_cartridge identifier id'>cartridge</span>
    <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_version identifier id'>version</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_nil nil kw'>nil</span><span class='rbrack token'>]</span>                         <span class='assign token'>=</span> <span class='rubyid_cartridge identifier id'>cartridge</span>
    <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_nil nil kw'>nil</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_nil nil kw'>nil</span><span class='rbrack token'>]</span>                             <span class='assign token'>=</span> <span class='rubyid_cartridge identifier id'>cartridge</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_cartridge identifier id'>cartridge</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    - (<tt>Object</tt>) <strong>inspect</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
print out all index entries in a table
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


301
302
303
304
305
306
307
308
309</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 301</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_inspect identifier id'>inspect</span>
  <span class='rubyid_@index ivar id'>@index</span><span class='dot token'>.</span><span class='rubyid_inject identifier id'>inject</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;CartridgeRepository:\n&quot;</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_memo identifier id'>memo</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='rubyid_name identifier id'>name</span><span class='comma token'>,</span> <span class='rubyid_sw_hash identifier id'>sw_hash</span><span class='rparen token'>)</span><span class='bitor op'>|</span>
    <span class='rubyid_sw_hash identifier id'>sw_hash</span><span class='dot token'>.</span><span class='rubyid_inject identifier id'>inject</span><span class='lparen token'>(</span><span class='rubyid_memo identifier id'>memo</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_memo identifier id'>memo</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='rubyid_sw_ver identifier id'>sw_ver</span><span class='comma token'>,</span> <span class='rubyid_cart_hash identifier id'>cart_hash</span><span class='rparen token'>)</span><span class='bitor op'>|</span>
      <span class='rubyid_cart_hash identifier id'>cart_hash</span><span class='dot token'>.</span><span class='rubyid_inject identifier id'>inject</span><span class='lparen token'>(</span><span class='rubyid_memo identifier id'>memo</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_memo identifier id'>memo</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='rubyid_cart_ver identifier id'>cart_ver</span><span class='comma token'>,</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='rparen token'>)</span><span class='bitor op'>|</span>
        <span class='rubyid_memo identifier id'>memo</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;(#{name}, #{sw_ver}, #{cart_ver}): &quot;</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_to_s identifier id'>to_s</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;\n&quot;</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'&gt;'</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="install-instance_method">
  
    - (<tt>Object</tt>) <strong>install</strong>(directory) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.install(directory) -&gt; Cartridge
</code></pre>
<p>
Copies a cartridge&#8217;s source into the cartridge repository from a
<tt>directory</tt>. The Cartridge will additionally be indexed and
available from a CartridgeRepository.instance
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.install('/usr/libexec/openshift/v2/cartridges/openshift-origin-php')  #=&gt; Cartridge
</code></pre>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 171</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_install identifier id'>install</span><span class='lparen token'>(</span><span class='rubyid_directory identifier id'>directory</span><span class='rparen token'>)</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_ArgumentError constant id'>ArgumentError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Illegal path to cartridge source: '#{directory}'&quot;</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_directory identifier id'>directory</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_directory? fid id'>directory?</span><span class='lparen token'>(</span><span class='rubyid_directory identifier id'>directory</span><span class='rparen token'>)</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_ArgumentError constant id'>ArgumentError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Source cannot be: '#{@path}'&quot;</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_directory identifier id'>directory</span> <span class='eq op'>==</span> <span class='rubyid_@path ivar id'>@path</span>

  <span class='rubyid_manifest_path identifier id'>manifest_path</span> <span class='assign token'>=</span> <span class='rubyid_PathUtils constant id'>PathUtils</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_directory identifier id'>directory</span><span class='comma token'>,</span> <span class='string val'>'metadata'</span><span class='comma token'>,</span> <span class='string val'>'manifest.yml'</span><span class='rparen token'>)</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_ArgumentError constant id'>ArgumentError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Cartridge manifest.yml missing: '#{manifest_path}'&quot;</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_file? fid id'>file?</span><span class='lparen token'>(</span><span class='rubyid_manifest_path identifier id'>manifest_path</span><span class='rparen token'>)</span>

  <span class='rubyid_entry identifier id'>entry</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_$OpenShift_CartridgeRepository_SEMAPHORE gvar id'>$OpenShift_CartridgeRepository_SEMAPHORE</span><span class='dot token'>.</span><span class='rubyid_synchronize identifier id'>synchronize</span> <span class='rubyid_do do kw'>do</span>
    <span class='rubyid_entry identifier id'>entry</span> <span class='assign token'>=</span> <span class='rubyid_insert identifier id'>insert</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Runtime constant id'>Runtime</span><span class='colon2 op'>::</span><span class='rubyid_Manifest constant id'>Manifest</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_manifest_path identifier id'>manifest_path</span><span class='comma token'>,</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_@path ivar id'>@path</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_r identifier id'>rm_r</span><span class='lparen token'>(</span><span class='rubyid_entry identifier id'>entry</span><span class='dot token'>.</span><span class='rubyid_repository_path identifier id'>repository_path</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_entry identifier id'>entry</span><span class='dot token'>.</span><span class='rubyid_repository_path identifier id'>repository_path</span><span class='rparen token'>)</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkpath identifier id'>mkpath</span><span class='lparen token'>(</span><span class='rubyid_entry identifier id'>entry</span><span class='dot token'>.</span><span class='rubyid_repository_path identifier id'>repository_path</span><span class='rparen token'>)</span>

    <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;shopt -s dotglob; /bin/cp -ad #{directory}/* #{entry.repository_path}&quot;</span><span class='comma token'>,</span>
                   <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_entry identifier id'>entry</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load-instance_method">
  
    - (<tt>Object</tt>) <strong>load</strong>(directory = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.load([directory path]) -&gt; Fixnum
</code></pre>
<p>
Read cartridge manifests from the CARTRIDGE_REPO_DIR or the provided
<tt>directory</tt>.
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.load(&quot;/var/lib/openshift/.cartridge_repository&quot;)  #=&gt; 24
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117
118
119
120
121
122
123
124
125
126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 115</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_load identifier id'>load</span><span class='lparen token'>(</span><span class='rubyid_directory identifier id'>directory</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_$OpenShift_CartridgeRepository_SEMAPHORE gvar id'>$OpenShift_CartridgeRepository_SEMAPHORE</span><span class='dot token'>.</span><span class='rubyid_synchronize identifier id'>synchronize</span> <span class='rubyid_do do kw'>do</span>
    <span class='rubyid_load_via_url identifier id'>load_via_url</span> <span class='assign token'>=</span> <span class='rubyid_directory identifier id'>directory</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_find_manifests identifier id'>find_manifests</span><span class='lparen token'>(</span><span class='rubyid_directory identifier id'>directory</span> <span class='orop op'>||</span> <span class='rubyid_@path ivar id'>@path</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_manifest_path identifier id'>manifest_path</span><span class='bitor op'>|</span>
      <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span> <span class='lbrace token'>{</span> <span class='dstring node'>&quot;Loading cartridge from #{manifest_path}&quot;</span> <span class='rbrace token'>}</span>
      <span class='comment val'># we check the vendor and cartridge names only when loading via URL</span>
      <span class='rubyid_c identifier id'>c</span> <span class='assign token'>=</span> <span class='rubyid_insert identifier id'>insert</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Runtime constant id'>Runtime</span><span class='colon2 op'>::</span><span class='rubyid_Manifest constant id'>Manifest</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_manifest_path identifier id'>manifest_path</span><span class='comma token'>,</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_@path ivar id'>@path</span><span class='comma token'>,</span> <span class='rubyid_load_via_url identifier id'>load_via_url</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span> <span class='lbrace token'>{</span> <span class='dstring node'>&quot;Loaded cartridge (#{c.name}, #{c.version}, #{c.cartridge_version})&quot;</span> <span class='rbrace token'>}</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_count identifier id'>count</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove-instance_method">
  
    - (<tt>Object</tt>) <strong>remove</strong>(cartridge_name, version, cartridge_version) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.remove(cartridge_name, version, cartridge_version) -&gt; Cartridge
</code></pre>
<p>
Remove index entry for this tuple
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.remove('php', '5.3', '1.0') -&gt; Cartridge
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


256
257
258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 256</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_remove identifier id'>remove</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='comma token'>,</span> <span class='rubyid_version identifier id'>version</span><span class='comma token'>,</span> <span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_version identifier id'>version</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='rparen token'>)</span>
  <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='rubyid_version identifier id'>version</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span>  <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_version identifier id'>version</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_empty? fid id'>empty?</span>
  <span class='rubyid_@index ivar id'>@index</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span>  <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_empty? fid id'>empty?</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select-instance_method">
  
    - (<tt>Object</tt>) <strong>select</strong>(cartridge_name, version = nil, cartridge_version = nil) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='[]-instance_method'>[]</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
:call-seq:
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.select(cartridge_name)                             -&gt; Cartridge
  CartridgeRepository.instance.select(cartridge_name, version)                    -&gt; Cartridge
  CartridgeRepository.instance.select(cartridge_name, version, cartridge_version) -&gt; Cartridge
  CartridgeRepository.instance[cartridge_name]                                    -&gt; Cartridge
  CartridgeRepository.instance[cartridge_name, version]                           -&gt; Cartridge
  CartridgeRepository.instance[cartridge_name, version, cartridge_version]        -&gt; Cartridge
</code></pre>
<p>
Select a cartridge from repository
</p>
<p>
Each version parameter you provide narrows the search to the exact revision
of the Cartridge you are requesting. If you do not provide
<em>cartridge_version</em> then the latest is assumed, for <em>version</em>
and <em>cartridge_name</em>. If you do not provide
<em>cartridge_version</em> and <em>version</em>, then the latest
<em>cartridge_name</em> will be returned.
</p>
<p>
Latest is determined from the <em>Version</em> elements provided in the
cartridge&#8217;s manifest, when the cartridge is loaded.
</p>
<p>
Assuming PHP, 3.5 and 0.1 are all the latest each of these calls would
return the same cartridge.
</p>
<pre class="code ruby18"><code class="ruby18">
  CartridgeRepository.instance.select('php', '3.5', '0.1')  #=&gt; Cartridge
  CartridgeRepository.instance.select('php', '3.5')         #=&gt; Cartridge
  CartridgeRepository.instance.select('php')                #=&gt; Cartridge
  CartridgeRepository.instance['php', '3.5', '0.1']         #=&gt; Cartridge
  CartridgeRepository.instance['php', '3.5']                #=&gt; Cartridge
  CartridgeRepository.instance['php']                       #=&gt; Cartridge
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


154
155
156
157
158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 154</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_select identifier id'>select</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='comma token'>,</span> <span class='rubyid_version identifier id'>version</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_cartridge_version identifier id'>cartridge_version</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='comma token'>,</span> <span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='comma token'>,</span> <span class='rubyid_version identifier id'>version</span><span class='rparen token'>)</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_KeyError constant id'>KeyError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;key not found: (#{cartridge_name}, #{version}, #{cartridge_version})&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_@index ivar id'>@index</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_version identifier id'>version</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='rubyid_cartridge_version identifier id'>cartridge_version</span><span class='rbrack token'>]</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    - (<tt>Object</tt>) <strong>to_s</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
print out all indexed cartridges in a table
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


312
313
314
315
316</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/cartridge_repository.rb', line 312</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_to_s identifier id'>to_s</span>
  <span class='rubyid_each_with_object identifier id'>each_with_object</span><span class='lparen token'>(</span><span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='comma token'>,</span> <span class='rubyid_memo identifier id'>memo</span><span class='bitor op'>|</span>
    <span class='rubyid_memo identifier id'>memo</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;(#{c.cartridge_vendor}, #{c.name}, #{c.version}, #{c.cartridge_version})\n&quot;</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sat Jun  1 18:43:39 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-1.8.7).
</div>

  </body>
</html>