<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: OpenShift::ApplicationContainer
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../OpenShift.html" title="OpenShift (module)">OpenShift</a></span></span>
     &raquo; 
    <span class="title">ApplicationContainer</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: OpenShift::ApplicationContainer
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">OpenShift::ApplicationContainer</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">ActiveModel::Observing, <span class='object_link'><a href="ManagedFiles.html" title="OpenShift::ManagedFiles (module)">ManagedFiles</a></span>, <span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span>, <span class='object_link'><a href="Utils/ShellExec.html" title="OpenShift::Utils::ShellExec (module)">Utils::ShellExec</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">origin-server/node/lib/openshift-origin-node/model/application_container.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <h2>Application Container</h2>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="GEAR_TO_GEAR_SSH-constant" class="">GEAR_TO_GEAR_SSH =
          
        </dt>
        <dd><pre class="code"><span class='string val'>&quot;/usr/bin/ssh -q -o 'BatchMode=yes' -o 'StrictHostKeyChecking=no' -i $OPENSHIFT_APP_SSH_KEY &quot;</span>
</pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="ManagedFiles.html" title="OpenShift::ManagedFiles (module)">ManagedFiles</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ManagedFiles.html#FILENAME_BLACKLIST-constant" title="OpenShift::ManagedFiles::FILENAME_BLACKLIST (constant)">ManagedFiles::FILENAME_BLACKLIST</a></span></p>

  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="NodeLogger.html#PROFILES-constant" title="OpenShift::NodeLogger::PROFILES (constant)">NodeLogger::PROFILES</a></span></p>


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#application_uuid-instance_method" title="#application_uuid (instance method)">- (Object) <strong>application_uuid</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute application_uuid.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#cartridge_model-instance_method" title="#cartridge_model (instance method)">- (Object) <strong>cartridge_model</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute cartridge_model.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#container_name-instance_method" title="#container_name (instance method)">- (Object) <strong>container_name</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute container_name.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#state-instance_method" title="#state (instance method)">- (Object) <strong>state</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute state.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#user-instance_method" title="#user (instance method)">- (Object) <strong>user</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute user.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#uuid-instance_method" title="#uuid (instance method)">- (Object) <strong>uuid</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute uuid.
</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all-class_method" title="all (class method)">+ (Object) <strong>all</strong>(logger = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Public: Return an enumerator which provides an ApplicationContainer object
for every OpenShift gear in the system.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#from_uuid-class_method" title="from_uuid (class method)">+ (Object) <strong>from_uuid</strong>(container_uuid, logger = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Public: Return an ApplicationContainer object loaded from the
container_uuid on the system.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_build_model-class_method" title="get_build_model (class method)">+ (Object) <strong>get_build_model</strong>(user, config) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build-instance_method" title="#build (instance method)">- (Object) <strong>build</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Implements the following build process:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#configure-instance_method" title="#configure (instance method)">- (Object) <strong>configure</strong>(cart_name, template_git_url = nil, manifest = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Add cartridge to gear.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connector_execute-instance_method" title="#connector_execute (instance method)">- (Object) <strong>connector_execute</strong>(cart_name, pub_cart_name, connector_type, connector, args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">- (Object) <strong>create</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
create gear.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_public_endpoints-instance_method" title="#create_public_endpoints (instance method)">- (Object) <strong>create_public_endpoints</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Creates public endpoints for the given cart.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deconfigure-instance_method" title="#deconfigure (instance method)">- (Object) <strong>deconfigure</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove cartridge from gear.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_public_endpoints-instance_method" title="#delete_public_endpoints (instance method)">- (Object) <strong>delete_public_endpoints</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Deletes all public endpoints for the given cart.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deploy-instance_method" title="#deploy (instance method)">- (Object) <strong>deploy</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Implements the following deploy process:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deploy_httpd_proxy-instance_method" title="#deploy_httpd_proxy (instance method)">- (Object) <strong>deploy_httpd_proxy</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy-instance_method" title="#destroy (instance method)">- (Object) <strong>destroy</strong>(skip_hooks = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Destroy gear.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extract_restore_archive-instance_method" title="#extract_restore_archive (instance method)">- (Object) <strong>extract_restore_archive</strong>(transforms, restore_git_repo, gear_env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#force_stop-instance_method" title="#force_stop (instance method)">- (Object) <strong>force_stop</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Public: Sets the app state to &quot;stopped&quot; and causes an immediate
forced termination of all gear processes.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gear_level_tidy_git-instance_method" title="#gear_level_tidy_git (instance method)">- (Object) <strong>gear_level_tidy_git</strong>(gear_repo_dir) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gear_level_tidy_tmp-instance_method" title="#gear_level_tidy_tmp (instance method)">- (Object) <strong>gear_level_tidy_tmp</strong>(gear_tmp_dir) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_gear_groups-instance_method" title="#get_gear_groups (instance method)">- (Object) <strong>get_gear_groups</strong>(gear_env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Get the gear groups for the application this gear is part of.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_secondary_gear_groups-instance_method" title="#get_secondary_gear_groups (instance method)">- (Object) <strong>get_secondary_gear_groups</strong>(groups) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Given a list of gear groups, return the secondary gear groups.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_scalable_restore-instance_method" title="#handle_scalable_restore (instance method)">- (Object) <strong>handle_scalable_restore</strong>(gear_groups, gear_env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle_scalable_snapshot-instance_method" title="#handle_scalable_snapshot (instance method)">- (Object) <strong>handle_scalable_snapshot</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (ApplicationContainer) <strong>initialize</strong>(application_uuid, container_uuid, user_uid = nil, app_name = nil, container_name = nil, namespace = nil, quota_blocks = nil, quota_files = nil, logger = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
A new instance of ApplicationContainer.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">- (Object) <strong>name</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#post_configure-instance_method" title="#post_configure (instance method)">- (Object) <strong>post_configure</strong>(cart_name, template_git_url = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#post_deploy-instance_method" title="#post_deploy (instance method)">- (Object) <strong>post_deploy</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Implements the following post-deploy process:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#post_receive-instance_method" title="#post_receive (instance method)">- (Object) <strong>post_receive</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pre_receive-instance_method" title="#pre_receive (instance method)">- (Object) <strong>pre_receive</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepare_for_restore-instance_method" title="#prepare_for_restore (instance method)">- (Object) <strong>prepare_for_restore</strong>(restore_git_repo, gear_env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reload-instance_method" title="#reload (instance method)">- (Object) <strong>reload</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
reload gear as supported by cartridges.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remote_deploy-instance_method" title="#remote_deploy (instance method)">- (Object) <strong>remote_deploy</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_httpd_proxy-instance_method" title="#remove_httpd_proxy (instance method)">- (Object) <strong>remove_httpd_proxy</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#restart-instance_method" title="#restart (instance method)">- (Object) <strong>restart</strong>(cart_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
restart gear as supported by cartridges.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#restart_httpd_proxy-instance_method" title="#restart_httpd_proxy (instance method)">- (Object) <strong>restart_httpd_proxy</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#restore-instance_method" title="#restore (instance method)">- (Object) <strong>restore</strong>(restore_git_repo) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Restores a gear from an archive read from STDIN.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#snapshot-instance_method" title="#snapshot (instance method)">- (Object) <strong>snapshot</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Creates a snapshot of a gear.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-instance_method" title="#start (instance method)">- (Object) <strong>start</strong>(cart_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><h3>Cartridge control methods.</h3>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_gear-instance_method" title="#start_gear (instance method)">- (Object) <strong>start_gear</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Sets the application state to <tt>STARTED</tt> and starts the gear.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#status-instance_method" title="#status (instance method)">- (Object) <strong>status</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop-instance_method" title="#stop (instance method)">- (Object) <strong>stop</strong>(cart_name, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop_gear-instance_method" title="#stop_gear (instance method)">- (Object) <strong>stop_gear</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Sets the application state to <tt>STOPPED</tt> and stops the gear.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop_lock%3F-instance_method" title="#stop_lock? (instance method)">- (Boolean) <strong>stop_lock?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#threaddump-instance_method" title="#threaddump (instance method)">- (Object) <strong>threaddump</strong>(cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tidy-instance_method" title="#tidy (instance method)">- (Object) <strong>tidy</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Public: Cleans up the gear, providing any installed cartridges with the
opportunity to perform their own cleanup operations via the tidy hook.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tidy_action-instance_method" title="#tidy_action (instance method)">- (Object) <strong>tidy_action</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Executes a block, trapping ShellExecutionExceptions and treating them as
warnings.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unsubscribe-instance_method" title="#unsubscribe (instance method)">- (Object) <strong>unsubscribe</strong>(cart_name, pub_cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Unsubscribe from a cart.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_namespace-instance_method" title="#update_namespace (instance method)">- (Object) <strong>update_namespace</strong>(cart_name, old_namespace, new_namespace) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_snapshot_archive-instance_method" title="#write_snapshot_archive (instance method)">- (Object) <strong>write_snapshot_archive</strong>(exclusions) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="ManagedFiles.html" title="OpenShift::ManagedFiles (module)">ManagedFiles</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ManagedFiles.html#lock_files-instance_method" title="OpenShift::ManagedFiles#lock_files (method)">#lock_files</a></span>, <span class='object_link'><a href="ManagedFiles.html#managed_files-instance_method" title="OpenShift::ManagedFiles#managed_files (method)">#managed_files</a></span>, <span class='object_link'><a href="ManagedFiles.html#process_templates-instance_method" title="OpenShift::ManagedFiles#process_templates (method)">#process_templates</a></span>, <span class='object_link'><a href="ManagedFiles.html#restore_transforms-instance_method" title="OpenShift::ManagedFiles#restore_transforms (method)">#restore_transforms</a></span>, <span class='object_link'><a href="ManagedFiles.html#setup_rewritten-instance_method" title="OpenShift::ManagedFiles#setup_rewritten (method)">#setup_rewritten</a></span>, <span class='object_link'><a href="ManagedFiles.html#snapshot_exclusions-instance_method" title="OpenShift::ManagedFiles#snapshot_exclusions (method)">#snapshot_exclusions</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="NodeLogger.html#build_logger-class_method" title="OpenShift::NodeLogger.build_logger (method)">build_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger-instance_method" title="OpenShift::NodeLogger#logger (method)">#logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger-class_method" title="OpenShift::NodeLogger.logger (method)">logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger_rebuild-class_method" title="OpenShift::NodeLogger.logger_rebuild (method)">logger_rebuild</a></span>, <span class='object_link'><a href="NodeLogger.html#trace_logger-instance_method" title="OpenShift::NodeLogger#trace_logger (method)">#trace_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#trace_logger-class_method" title="OpenShift::NodeLogger.trace_logger (method)">trace_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#trace_rebuild-class_method" title="OpenShift::NodeLogger.trace_rebuild (method)">trace_rebuild</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Utils/ShellExec.html" title="OpenShift::Utils::ShellExec (module)">Utils::ShellExec</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Utils/ShellExec.html#kill_process_tree-class_method" title="OpenShift::Utils::ShellExec.kill_process_tree (method)">kill_process_tree</a></span>, <span class='object_link'><a href="Utils/ShellExec.html#run_as-class_method" title="OpenShift::Utils::ShellExec.run_as (method)">run_as</a></span>, <span class='object_link'><a href="Utils/ShellExec.html#shellCmd-class_method" title="OpenShift::Utils::ShellExec.shellCmd (method)">shellCmd</a></span>, <span class='object_link'><a href="Utils/ShellExec.html#shellCmd-instance_method" title="OpenShift::Utils::ShellExec#shellCmd (method)">#shellCmd</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="OpenShift::ApplicationContainer (class)">ApplicationContainer</a></span></tt>) <strong>initialize</strong>(application_uuid, container_uuid, user_uid = nil, app_name = nil, container_name = nil, namespace = nil, quota_blocks = nil, quota_files = nil, logger = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
A new instance of ApplicationContainer
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 48</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_application_uuid identifier id'>application_uuid</span><span class='comma token'>,</span> <span class='rubyid_container_uuid identifier id'>container_uuid</span><span class='comma token'>,</span> <span class='rubyid_user_uid identifier id'>user_uid</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span>
    <span class='rubyid_app_name identifier id'>app_name</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_container_name identifier id'>container_name</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_namespace identifier id'>namespace</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_quota_blocks identifier id'>quota_blocks</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_quota_files identifier id'>quota_files</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_logger identifier id'>logger</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>

  <span class='rubyid_@config ivar id'>@config</span>           <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Config constant id'>Config</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
  <span class='rubyid_@uuid ivar id'>@uuid</span>             <span class='assign token'>=</span> <span class='rubyid_container_uuid identifier id'>container_uuid</span>
  <span class='rubyid_@application_uuid ivar id'>@application_uuid</span> <span class='assign token'>=</span> <span class='rubyid_application_uuid identifier id'>application_uuid</span>
  <span class='rubyid_@container_name ivar id'>@container_name</span>   <span class='assign token'>=</span> <span class='rubyid_container_name identifier id'>container_name</span>
  <span class='rubyid_@user ivar id'>@user</span>             <span class='assign token'>=</span> <span class='rubyid_UnixUser constant id'>UnixUser</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_application_uuid identifier id'>application_uuid</span><span class='comma token'>,</span> <span class='rubyid_container_uuid identifier id'>container_uuid</span><span class='comma token'>,</span> <span class='rubyid_user_uid identifier id'>user_uid</span><span class='comma token'>,</span>
                                   <span class='rubyid_app_name identifier id'>app_name</span><span class='comma token'>,</span> <span class='rubyid_container_name identifier id'>container_name</span><span class='comma token'>,</span> <span class='rubyid_namespace identifier id'>namespace</span><span class='comma token'>,</span> <span class='rubyid_quota_blocks identifier id'>quota_blocks</span><span class='comma token'>,</span> <span class='rubyid_quota_files identifier id'>quota_files</span><span class='rparen token'>)</span>
  <span class='rubyid_@state ivar id'>@state</span>            <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_ApplicationState constant id'>ApplicationState</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_container_uuid identifier id'>container_uuid</span><span class='rparen token'>)</span>
  <span class='rubyid_@build_model ivar id'>@build_model</span>      <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_class identifier id'>class</span><span class='dot token'>.</span><span class='rubyid_get_build_model identifier id'>get_build_model</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='comma token'>,</span> <span class='rubyid_@config ivar id'>@config</span><span class='rparen token'>)</span>

  <span class='comment val'># When v2 is the default cartridge format flip the test...</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_@build_model ivar id'>@build_model</span> <span class='eq op'>==</span> <span class='symbol val'>:v1</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span> <span class='assign token'>=</span> <span class='rubyid_V1CartridgeModel constant id'>V1CartridgeModel</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@config ivar id'>@config</span><span class='comma token'>,</span> <span class='rubyid_@user ivar id'>@user</span><span class='rparen token'>)</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span> <span class='assign token'>=</span> <span class='rubyid_V2CartridgeModel constant id'>V2CartridgeModel</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@config ivar id'>@config</span><span class='comma token'>,</span> <span class='rubyid_@user ivar id'>@user</span><span class='comma token'>,</span> <span class='rubyid_@state ivar id'>@state</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_NodeLogger constant id'>NodeLogger</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Created #{@build_model} model for #{container_uuid}&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="application_uuid-instance_method">
  
    - (<tt>Object</tt>) <strong>application_uuid</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute application_uuid
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 46</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_application_uuid identifier id'>application_uuid</span>
  <span class='rubyid_@application_uuid ivar id'>@application_uuid</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="cartridge_model-instance_method">
  
    - (<tt>Object</tt>) <strong>cartridge_model</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute cartridge_model
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 46</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_cartridge_model identifier id'>cartridge_model</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="container_name-instance_method">
  
    - (<tt>Object</tt>) <strong>container_name</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute container_name
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 46</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_container_name identifier id'>container_name</span>
  <span class='rubyid_@container_name ivar id'>@container_name</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="state-instance_method">
  
    - (<tt>Object</tt>) <strong>state</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute state
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 46</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_state identifier id'>state</span>
  <span class='rubyid_@state ivar id'>@state</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="user-instance_method">
  
    - (<tt>Object</tt>) <strong>user</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute user
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 46</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_user identifier id'>user</span>
  <span class='rubyid_@user ivar id'>@user</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="uuid-instance_method">
  
    - (<tt>Object</tt>) <strong>uuid</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute uuid
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 46</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_uuid identifier id'>uuid</span>
  <span class='rubyid_@uuid ivar id'>@uuid</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="all-class_method">
  
    + (<tt>Object</tt>) <strong>all</strong>(logger = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Public: Return an enumerator which provides an ApplicationContainer object
for every OpenShift gear in the system.
</p>
<p>
Caveat: the quota information will not be populated.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 905</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_all identifier id'>all</span><span class='lparen token'>(</span><span class='rubyid_logger identifier id'>logger</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_Enumerator constant id'>Enumerator</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_yielder identifier id'>yielder</span><span class='bitor op'>|</span>
    <span class='rubyid_UnixUser constant id'>UnixUser</span><span class='dot token'>.</span><span class='rubyid_all identifier id'>all</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_u identifier id'>u</span><span class='bitor op'>|</span>
      <span class='rubyid_a identifier id'>a</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_a identifier id'>a</span><span class='assign token'>=</span><span class='rubyid_ApplicationContainer constant id'>ApplicationContainer</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_application_uuid identifier id'>application_uuid</span><span class='comma token'>,</span> <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_container_uuid identifier id'>container_uuid</span><span class='comma token'>,</span> <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span>
                                   <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_app_name identifier id'>app_name</span><span class='comma token'>,</span> <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_container_name identifier id'>container_name</span><span class='comma token'>,</span> <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_namespace identifier id'>namespace</span><span class='comma token'>,</span>
                                   <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_logger identifier id'>logger</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_logger identifier id'>logger</span>
          <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Failed to instantiate ApplicationContainer for #{u.application_uuid}: #{e}&quot;</span><span class='rparen token'>)</span>
          <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Backtrace: #{e.backtrace}&quot;</span><span class='rparen token'>)</span>
        <span class='rubyid_else else kw'>else</span>
          <span class='rubyid_NodeLogger constant id'>NodeLogger</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Failed to instantiate ApplicationContainer for #{u.application_uuid}: #{e}&quot;</span><span class='rparen token'>)</span>
          <span class='rubyid_NodeLogger constant id'>NodeLogger</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Backtrace: #{e.backtrace}&quot;</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_else else kw'>else</span>
        <span class='rubyid_yielder identifier id'>yielder</span><span class='dot token'>.</span><span class='rubyid_yield identifier id'>yield</span><span class='lparen token'>(</span><span class='rubyid_a identifier id'>a</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="from_uuid-class_method">
  
    + (<tt>Object</tt>) <strong>from_uuid</strong>(container_uuid, logger = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Public: Return an ApplicationContainer object loaded from the
container_uuid on the system
</p>
<p>
Caveat: the quota information will not be populated.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


892
893
894
895
896
897</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 892</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_from_uuid identifier id'>from_uuid</span><span class='lparen token'>(</span><span class='rubyid_container_uuid identifier id'>container_uuid</span><span class='comma token'>,</span> <span class='rubyid_logger identifier id'>logger</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_u identifier id'>u</span> <span class='assign token'>=</span> <span class='rubyid_UnixUser constant id'>UnixUser</span><span class='dot token'>.</span><span class='rubyid_from_uuid identifier id'>from_uuid</span><span class='lparen token'>(</span><span class='rubyid_container_uuid identifier id'>container_uuid</span><span class='rparen token'>)</span>
  <span class='rubyid_ApplicationContainer constant id'>ApplicationContainer</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_application_uuid identifier id'>application_uuid</span><span class='comma token'>,</span> <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_container_uuid identifier id'>container_uuid</span><span class='comma token'>,</span> <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span>
                           <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_app_name identifier id'>app_name</span><span class='comma token'>,</span> <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_container_name identifier id'>container_name</span><span class='comma token'>,</span> <span class='rubyid_u identifier id'>u</span><span class='dot token'>.</span><span class='rubyid_namespace identifier id'>namespace</span><span class='comma token'>,</span>
                           <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_logger identifier id'>logger</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_build_model-class_method">
  
    + (<tt>Object</tt>) <strong>get_build_model</strong>(user, config) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71
72
73
74
75
76
77
78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 69</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_get_build_model identifier id'>get_build_model</span><span class='lparen token'>(</span><span class='rubyid_user identifier id'>user</span><span class='comma token'>,</span> <span class='rubyid_config identifier id'>config</span><span class='rparen token'>)</span>
  <span class='comment val'># TODO: When v2 is the default cartridge format change this default...</span>
  <span class='rubyid_build_model identifier id'>build_model</span> <span class='assign token'>=</span> <span class='symbol val'>:v1</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_user identifier id'>user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_user identifier id'>user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>
    <span class='rubyid_build_model identifier id'>build_model</span> <span class='assign token'>=</span> <span class='symbol val'>:v2</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Sdk constant id'>Sdk</span><span class='dot token'>.</span><span class='rubyid_new_sdk_app? fid id'>new_sdk_app?</span><span class='lparen token'>(</span><span class='rubyid_user identifier id'>user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_build_model identifier id'>build_model</span> <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Sdk constant id'>Sdk</span><span class='dot token'>.</span><span class='rubyid_node_default_model identifier id'>node_default_model</span><span class='lparen token'>(</span><span class='rubyid_config identifier id'>config</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_build_model identifier id'>build_model</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="build-instance_method">
  
    - (<tt>Object</tt>) <strong>build</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Implements the following build process:
</p>
<pre class="code ruby18"><code class="ruby18">
  1. Set the application state to +BUILDING+
  2. Run the cartridge +process-version+ control action
  3. Run the cartridge +pre-build+ control action
  4. Run the +pre-build+ user action hook
  5. Run the cartridge +build+ control action
  6. Run the +build+ user action hook
</code></pre>
<p>
Returns the combined output of all actions as a <tt>String</tt>.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 482</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_build identifier id'>build</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@state ivar id'>@state</span><span class='dot token'>.</span><span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_State constant id'>State</span><span class='colon2 op'>::</span><span class='rubyid_BUILDING constant id'>BUILDING</span>

  <span class='rubyid_buffer identifier id'>buffer</span> <span class='assign token'>=</span> <span class='string val'>''</span>

  <span class='rubyid_buffer identifier id'>buffer</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'process-version'</span><span class='comma token'>,</span>
                                        <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                                        <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span>  <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                        <span class='rubyid_post_action_hooks_enabled identifier id'>post_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                        <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>                       <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                        <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>                       <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_buffer identifier id'>buffer</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'pre-build'</span><span class='comma token'>,</span>
                                        <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                                        <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                        <span class='rubyid_prefix_action_hooks identifier id'>prefix_action_hooks</span><span class='colon op'>:</span>      <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                        <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                        <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_buffer identifier id'>buffer</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'build'</span><span class='comma token'>,</span>
                                        <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                                        <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                        <span class='rubyid_prefix_action_hooks identifier id'>prefix_action_hooks</span><span class='colon op'>:</span>      <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                        <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                        <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_buffer identifier id'>buffer</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="configure-instance_method">
  
    - (<tt>Object</tt>) <strong>configure</strong>(cart_name, template_git_url = nil, manifest = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Add cartridge to gear. This method establishes the cartridge model to use,
but does not mark the application. Marking the application is the
responsibility of the cart model.
</p>
<p>
This method does not enforce constraints on whether the cartridge being
added is compatible with other installed cartridges. That is the
responsibility of the broker.
</p>
<p>
context: root -&gt; gear user -&gt; root
</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cart_name</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>
cartridge name
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>template_git_url</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
URL for template application source/bare repository
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>manifest</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
Broker provided manifest
</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 98</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_configure identifier id'>configure</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_template_git_url identifier id'>template_git_url</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span>  <span class='rubyid_manifest identifier id'>manifest</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_configure identifier id'>configure</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_template_git_url identifier id'>template_git_url</span><span class='comma token'>,</span> <span class='rubyid_manifest identifier id'>manifest</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connector_execute-instance_method">
  
    - (<tt>Object</tt>) <strong>connector_execute</strong>(cart_name, pub_cart_name, connector_type, connector, args) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


374
375
376</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 374</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_connector_execute identifier id'>connector_execute</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_pub_cart_name identifier id'>pub_cart_name</span><span class='comma token'>,</span> <span class='rubyid_connector_type identifier id'>connector_type</span><span class='comma token'>,</span> <span class='rubyid_connector identifier id'>connector</span><span class='comma token'>,</span> <span class='rubyid_args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_connector_execute identifier id'>connector_execute</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_pub_cart_name identifier id'>pub_cart_name</span><span class='comma token'>,</span> <span class='rubyid_connector_type identifier id'>connector_type</span><span class='comma token'>,</span> <span class='rubyid_connector identifier id'>connector</span><span class='comma token'>,</span> <span class='rubyid_args identifier id'>args</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create-instance_method">
  
    - (<tt>Object</tt>) <strong>create</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
create gear
</p>
<ul>
<li>model/unix_user.rb

</li>
</ul>
<p>
context: root
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161
162
163
164
165
166
167
168</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 159</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_create identifier id'>create</span>
  <span class='rubyid_notify_observers identifier id'>notify_observers</span><span class='lparen token'>(</span><span class='symbol val'>:before_container_create</span><span class='rparen token'>)</span>

  <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_create identifier id'>create</span>
  <span class='rubyid_if if kw'>if</span> <span class='symbol val'>:v2</span> <span class='eq op'>==</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Sdk constant id'>Sdk</span><span class='dot token'>.</span><span class='rubyid_node_default_model identifier id'>node_default_model</span><span class='lparen token'>(</span><span class='rubyid_@config ivar id'>@config</span><span class='rparen token'>)</span>
    <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Sdk constant id'>Sdk</span><span class='dot token'>.</span><span class='rubyid_mark_new_sdk_app identifier id'>mark_new_sdk_app</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_notify_observers identifier id'>notify_observers</span><span class='lparen token'>(</span><span class='symbol val'>:after_container_create</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_public_endpoints-instance_method">
  
    - (<tt>Object</tt>) <strong>create_public_endpoints</strong>(cart_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Creates public endpoints for the given cart. Public proxy mappings are
created via the FrontendProxyServer, and the resulting mapped ports are
written to environment variables with names based on the cart manifest
endpoint entries.
</p>
<p>
Returns nil on success, or raises an exception if any errors occur: all
errors here are considered fatal.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 202</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_create_public_endpoints identifier id'>create_public_endpoints</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_env identifier id'>env</span>  <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Environ constant id'>Environ</span><span class='colon2 op'>::</span><span class='rubyid_for_gear identifier id'>for_gear</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>
  <span class='rubyid_cart identifier id'>cart</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_get_cartridge identifier id'>get_cartridge</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>

  <span class='rubyid_proxy identifier id'>proxy</span> <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_FrontendProxyServer constant id'>FrontendProxyServer</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>

  <span class='comment val'># TODO: better error handling</span>
  <span class='rubyid_cart identifier id'>cart</span><span class='dot token'>.</span><span class='rubyid_public_endpoints identifier id'>public_endpoints</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_endpoint identifier id'>endpoint</span><span class='bitor op'>|</span>
    <span class='comment val'># Load the private IP from the gear</span>
    <span class='rubyid_private_ip identifier id'>private_ip</span> <span class='assign token'>=</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='rubyid_endpoint identifier id'>endpoint</span><span class='dot token'>.</span><span class='rubyid_private_ip_name identifier id'>private_ip_name</span><span class='rbrack token'>]</span>

    <span class='rubyid_if if kw'>if</span> <span class='rubyid_private_ip identifier id'>private_ip</span> <span class='eq op'>==</span> <span class='rubyid_nil nil kw'>nil</span>
      <span class='rubyid_raise identifier id'>raise</span> <span class='dstring node'>&quot;Missing private IP #{endpoint.private_ip_name} for cart #{cart.name} in gear #{@uuid}, &quot;</span>\
        <span class='dstring node'>&quot;required to create public endpoint #{endpoint.public_port_name}&quot;</span>
    <span class='rubyid_end end kw'>end</span>

    <span class='comment val'># Attempt the actual proxy mapping assignment</span>
    <span class='rubyid_public_port identifier id'>public_port</span> <span class='assign token'>=</span> <span class='rubyid_proxy identifier id'>proxy</span><span class='dot token'>.</span><span class='rubyid_add identifier id'>add</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span> <span class='rubyid_private_ip identifier id'>private_ip</span><span class='comma token'>,</span> <span class='rubyid_endpoint identifier id'>endpoint</span><span class='dot token'>.</span><span class='rubyid_private_port identifier id'>private_port</span><span class='rparen token'>)</span>

    <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_add_env_var identifier id'>add_env_var</span><span class='lparen token'>(</span><span class='rubyid_endpoint identifier id'>endpoint</span><span class='dot token'>.</span><span class='rubyid_public_port_name identifier id'>public_port_name</span><span class='comma token'>,</span> <span class='rubyid_public_port identifier id'>public_port</span><span class='rparen token'>)</span>

    <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_info identifier id'>info</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Created public endpoint for cart #{cart.name} in gear #{@uuid}: &quot;</span>\
      <span class='dstring node'>&quot;[#{endpoint.public_port_name}=#{public_port}]&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deconfigure-instance_method">
  
    - (<tt>Object</tt>) <strong>deconfigure</strong>(cart_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Remove cartridge from gear
</p>
<p>
context: root -&gt; gear user -&gt; root
</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cart_name</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>
cartridge name
</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 143</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_deconfigure identifier id'>deconfigure</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_deconfigure identifier id'>deconfigure</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_public_endpoints-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_public_endpoints</strong>(cart_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Deletes all public endpoints for the given cart. Public port mappings are
looked up and deleted using the FrontendProxyServer, and all corresponding
environment variables are deleted from the gear.
</p>
<p>
Returns nil on success. Failed public port delete operations are logged and
skipped.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 234</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_delete_public_endpoints identifier id'>delete_public_endpoints</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_env identifier id'>env</span>  <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Environ constant id'>Environ</span><span class='colon2 op'>::</span><span class='rubyid_for_gear identifier id'>for_gear</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>
  <span class='rubyid_cart identifier id'>cart</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_get_cartridge identifier id'>get_cartridge</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>

  <span class='rubyid_proxy identifier id'>proxy</span> <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_FrontendProxyServer constant id'>FrontendProxyServer</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>

  <span class='rubyid_public_ports identifier id'>public_ports</span>     <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_public_port_vars identifier id'>public_port_vars</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='rubyid_cart identifier id'>cart</span><span class='dot token'>.</span><span class='rubyid_public_endpoints identifier id'>public_endpoints</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_endpoint identifier id'>endpoint</span><span class='bitor op'>|</span>
    <span class='comment val'># Load the private IP from the gear</span>
    <span class='rubyid_private_ip identifier id'>private_ip</span> <span class='assign token'>=</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='rubyid_endpoint identifier id'>endpoint</span><span class='dot token'>.</span><span class='rubyid_private_ip_name identifier id'>private_ip_name</span><span class='rbrack token'>]</span>

    <span class='rubyid_public_port_vars identifier id'>public_port_vars</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_endpoint identifier id'>endpoint</span><span class='dot token'>.</span><span class='rubyid_public_port_name identifier id'>public_port_name</span>

    <span class='rubyid_public_port identifier id'>public_port</span> <span class='assign token'>=</span> <span class='rubyid_proxy identifier id'>proxy</span><span class='dot token'>.</span><span class='rubyid_find_mapped_proxy_port identifier id'>find_mapped_proxy_port</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span> <span class='rubyid_private_ip identifier id'>private_ip</span><span class='comma token'>,</span> <span class='rubyid_endpoint identifier id'>endpoint</span><span class='dot token'>.</span><span class='rubyid_private_port identifier id'>private_port</span><span class='rparen token'>)</span>

    <span class='rubyid_public_ports identifier id'>public_ports</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_public_port identifier id'>public_port</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_public_port identifier id'>public_port</span> <span class='eq op'>==</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_begin begin kw'>begin</span>
    <span class='comment val'># Remove the proxy entries</span>
    <span class='rubyid_rc identifier id'>rc</span> <span class='assign token'>=</span> <span class='rubyid_proxy identifier id'>proxy</span><span class='dot token'>.</span><span class='rubyid_delete_all identifier id'>delete_all</span><span class='lparen token'>(</span><span class='rubyid_public_ports identifier id'>public_ports</span><span class='comma token'>,</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
    <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_info identifier id'>info</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Deleted all public endpoints for cart #{cart.name} in gear #{@uuid}\n&quot;</span>\
      <span class='dstring node'>&quot;Endpoints: #{public_port_vars}\n&quot;</span>\
      <span class='dstring node'>&quot;Public ports: #{public_ports}&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
    <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_warn identifier id'>warn</span><span class='lparen token'>(</span><span class='dstring node'>%Q{Couldn't delete all public endpoints for cart #{cart.name} in gear #{@uuid}: #{e.message}
      Endpoints: #{public_port_vars}
      Public ports: #{public_ports}
                #{e.backtrace}
                }</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Clean up the environment variables</span>
  <span class='rubyid_public_port_vars identifier id'>public_port_vars</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_var identifier id'>var</span><span class='bitor op'>|</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_remove_env_var identifier id'>remove_env_var</span><span class='lparen token'>(</span><span class='rubyid_var identifier id'>var</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deploy-instance_method">
  
    - (<tt>Object</tt>) <strong>deploy</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Implements the following deploy process:
</p>
<pre class="code ruby18"><code class="ruby18">
  1. Set the application state to +DEPLOYING+
  2. Run the web proxy cartridge +deploy+ control action
  3. Run the primary cartridge +deploy+ control action
  4. Run the +deploy+ user action hook
</code></pre>
<p>
Returns the combined output of all actions as a <tt>String</tt>.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 520</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_deploy identifier id'>deploy</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@state ivar id'>@state</span><span class='dot token'>.</span><span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_State constant id'>State</span><span class='colon2 op'>::</span><span class='rubyid_DEPLOYING constant id'>DEPLOYING</span>

  <span class='rubyid_web_proxy_cart identifier id'>web_proxy_cart</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_web_proxy identifier id'>web_proxy</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_web_proxy_cart identifier id'>web_proxy_cart</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'deploy'</span><span class='comma token'>,</span>
                                <span class='rubyid_web_proxy_cart identifier id'>web_proxy_cart</span><span class='comma token'>,</span>
                                <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                <span class='rubyid_prefix_action_hooks identifier id'>prefix_action_hooks</span><span class='colon op'>:</span>      <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'deploy'</span><span class='comma token'>,</span>
                              <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                              <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                              <span class='rubyid_prefix_action_hooks identifier id'>prefix_action_hooks</span><span class='colon op'>:</span>      <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                              <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                              <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deploy_httpd_proxy-instance_method">
  
    - (<tt>Object</tt>) <strong>deploy_httpd_proxy</strong>(cart_name) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


378
379
380</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 378</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_deploy_httpd_proxy identifier id'>deploy_httpd_proxy</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_deploy_httpd_proxy identifier id'>deploy_httpd_proxy</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="destroy-instance_method">
  
    - (<tt>Object</tt>) <strong>destroy</strong>(skip_hooks = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Destroy gear
</p>
<ul>
<li>model/unix_user.rb

</li>
</ul>
<p>
context: root
</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>skip_hooks</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
should destroy call the gear&#8217;s hooks before destroying the gear
</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


175
176
177
178
179
180
181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 175</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_destroy identifier id'>destroy</span><span class='lparen token'>(</span><span class='rubyid_skip_hooks identifier id'>skip_hooks</span><span class='assign token'>=</span><span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_notify_observers identifier id'>notify_observers</span><span class='lparen token'>(</span><span class='symbol val'>:before_container_destroy</span><span class='rparen token'>)</span>

  <span class='comment val'># possible mismatch across cart model versions</span>
  <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_errout identifier id'>errout</span><span class='comma token'>,</span> <span class='rubyid_retcode identifier id'>retcode</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_destroy identifier id'>destroy</span><span class='lparen token'>(</span><span class='rubyid_skip_hooks identifier id'>skip_hooks</span><span class='rparen token'>)</span>

  <span class='rubyid_notify_observers identifier id'>notify_observers</span><span class='lparen token'>(</span><span class='symbol val'>:after_container_destroy</span><span class='rparen token'>)</span>

  <span class='rubyid_return return kw'>return</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_errout identifier id'>errout</span><span class='comma token'>,</span> <span class='rubyid_retcode identifier id'>retcode</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extract_restore_archive-instance_method">
  
    - (<tt>Object</tt>) <strong>extract_restore_archive</strong>(transforms, restore_git_repo, gear_env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 814</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_extract_restore_archive identifier id'>extract_restore_archive</span><span class='lparen token'>(</span><span class='rubyid_transforms identifier id'>transforms</span><span class='comma token'>,</span> <span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span><span class='comma token'>,</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>
  <span class='rubyid_includes identifier id'>includes</span> <span class='assign token'>=</span> <span class='dstring node'>%w(./*/app-root/data)</span>
  <span class='rubyid_excludes identifier id'>excludes</span> <span class='assign token'>=</span> <span class='dstring node'>%w(./*/app-root/runtime/data)</span>
  <span class='rubyid_transforms identifier id'>transforms</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'s|${OPENSHIFT_GEAR_NAME}/data|app-root/data|'</span>
  <span class='rubyid_transforms identifier id'>transforms</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'s|git/.*\.git|git/${OPENSHIFT_GEAR_NAME}.git|'</span>

  <span class='comment val'># TODO: use all installed cartridges, not just ones in current instance directory</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_each_cartridge identifier id'>each_cartridge</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
    <span class='rubyid_excludes identifier id'>excludes</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;./*/#{cartridge.directory}/data&quot;</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span>
    <span class='rubyid_excludes identifier id'>excludes</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'./*/git/*.git/hooks'</span>
    <span class='rubyid_includes identifier id'>includes</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'./*/git'</span>
    <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Restoring ~/git/#{name}.git and ~/app-root/data&quot;</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Restoring ~/app-root/data&quot;</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_includes identifier id'>includes</span> <span class='assign token'>=</span> <span class='rubyid_includes identifier id'>includes</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>' '</span><span class='rparen token'>)</span>
  <span class='rubyid_excludes identifier id'>excludes</span> <span class='assign token'>=</span> <span class='rubyid_excludes identifier id'>excludes</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;--exclude=\&quot;#{x}\&quot;&quot;</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>' '</span><span class='rparen token'>)</span>
  <span class='rubyid_transforms identifier id'>transforms</span> <span class='assign token'>=</span> <span class='rubyid_transforms identifier id'>transforms</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;--transform=\&quot;#{x}\&quot;&quot;</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>' '</span><span class='rparen token'>)</span>

  <span class='rubyid_tar_cmd identifier id'>tar_cmd</span> <span class='assign token'>=</span> <span class='dstring node'>%Q{/bin/tar --strip=2 --overwrite -xmz #{includes} #{transforms} #{excludes} 1&gt;&amp;2}</span>

  <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='rubyid_tar_cmd identifier id'>tar_cmd</span><span class='comma token'>,</span> 
                 <span class='rubyid_env identifier id'>env</span><span class='colon op'>:</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='comma token'>,</span>
                 <span class='rubyid_unsetenv_others identifier id'>unsetenv_others</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
                 <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_$stdout gvar id'>$stdout</span><span class='comma token'>,</span>
                 <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='comma token'>,</span>
                 <span class='rubyid_in in kw'>in</span><span class='colon op'>:</span> <span class='rubyid_$stdin gvar id'>$stdin</span><span class='comma token'>,</span>
                 <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span>
                 <span class='rubyid_uid identifier id'>uid</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span>
                 <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_cd identifier id'>cd</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span> <span class='string val'>'app-root'</span><span class='comma token'>,</span> <span class='string val'>'runtime'</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_ln_s identifier id'>ln_s</span><span class='lparen token'>(</span><span class='string val'>'../data'</span><span class='comma token'>,</span> <span class='string val'>'data'</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="force_stop-instance_method">
  
    - (<tt>Object</tt>) <strong>force_stop</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Public: Sets the app state to &quot;stopped&quot; and causes an immediate
forced termination of all gear processes.
</p>
<p>
TODO: exception handling
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 190</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_force_stop identifier id'>force_stop</span>
  <span class='rubyid_@state ivar id'>@state</span><span class='dot token'>.</span><span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_State constant id'>State</span><span class='colon2 op'>::</span><span class='rubyid_STOPPED constant id'>STOPPED</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_create_stop_lock identifier id'>create_stop_lock</span>
  <span class='rubyid_UnixUser constant id'>UnixUser</span><span class='dot token'>.</span><span class='rubyid_kill_procs identifier id'>kill_procs</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gear_level_tidy_git-instance_method">
  
    - (<tt>Object</tt>) <strong>gear_level_tidy_git</strong>(gear_repo_dir) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


342
343
344
345
346
347
348
349
350
351
352
353
354</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 342</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_level_tidy_git identifier id'>gear_level_tidy_git</span><span class='lparen token'>(</span><span class='rubyid_gear_repo_dir identifier id'>gear_repo_dir</span><span class='rparen token'>)</span>
  <span class='comment val'># Git pruning</span>
  <span class='rubyid_tidy_action identifier id'>tidy_action</span> <span class='rubyid_do do kw'>do</span>
    <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='string val'>&quot;git prune&quot;</span><span class='comma token'>,</span> <span class='rubyid_uid identifier id'>uid</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span> <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span> <span class='rubyid_gear_repo_dir identifier id'>gear_repo_dir</span><span class='comma token'>,</span> <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Pruned git directory at #{gear_repo_dir}&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Git GC</span>
  <span class='rubyid_tidy_action identifier id'>tidy_action</span> <span class='rubyid_do do kw'>do</span>
    <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='string val'>&quot;git gc --aggressive&quot;</span><span class='comma token'>,</span> <span class='rubyid_uid identifier id'>uid</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span> <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span> <span class='rubyid_gear_repo_dir identifier id'>gear_repo_dir</span><span class='comma token'>,</span> <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Executed git gc for repo #{gear_repo_dir}&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gear_level_tidy_tmp-instance_method">
  
    - (<tt>Object</tt>) <strong>gear_level_tidy_tmp</strong>(gear_tmp_dir) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


334
335
336
337
338
339
340</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 334</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_level_tidy_tmp identifier id'>gear_level_tidy_tmp</span><span class='lparen token'>(</span><span class='rubyid_gear_tmp_dir identifier id'>gear_tmp_dir</span><span class='rparen token'>)</span>
  <span class='comment val'># Temp dir cleanup</span>
  <span class='rubyid_tidy_action identifier id'>tidy_action</span> <span class='rubyid_do do kw'>do</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span><span class='lparen token'>(</span><span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_glob identifier id'>glob</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_gear_tmp_dir identifier id'>gear_tmp_dir</span><span class='comma token'>,</span> <span class='string val'>&quot;*&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Cleaned gear temp dir at #{gear_tmp_dir}&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_gear_groups-instance_method">
  
    - (<tt>Object</tt>) <strong>get_gear_groups</strong>(gear_env) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Get the gear groups for the application this gear is part of.
</p>
<p>
Returns the parsed JSON for the response.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 662</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_gear_groups identifier id'>get_gear_groups</span><span class='lparen token'>(</span><span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>
  <span class='rubyid_broker_addr identifier id'>broker_addr</span> <span class='assign token'>=</span> <span class='rubyid_@config ivar id'>@config</span><span class='dot token'>.</span><span class='rubyid_get identifier id'>get</span><span class='lparen token'>(</span><span class='string val'>'BROKER_HOST'</span><span class='rparen token'>)</span>
  <span class='rubyid_domain identifier id'>domain</span> <span class='assign token'>=</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='lbrack token'>[</span><span class='string val'>'OPENSHIFT_NAMESPACE'</span><span class='rbrack token'>]</span>
  <span class='rubyid_app_name identifier id'>app_name</span> <span class='assign token'>=</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='lbrack token'>[</span><span class='string val'>'OPENSHIFT_APP_NAME'</span><span class='rbrack token'>]</span>
  <span class='rubyid_url identifier id'>url</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;https://#{broker_addr}/broker/rest/domains/#{domain}/applications/#{app_name}/gear_groups.json&quot;</span>

  <span class='rubyid_params identifier id'>params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span>
    <span class='string val'>'broker_auth_key'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_read identifier id'>read</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@config ivar id'>@config</span><span class='dot token'>.</span><span class='rubyid_get identifier id'>get</span><span class='lparen token'>(</span><span class='string val'>'GEAR_BASE_DIR'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_name identifier id'>name</span><span class='comma token'>,</span> <span class='string val'>'.auth'</span><span class='comma token'>,</span> <span class='string val'>'token'</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_chomp identifier id'>chomp</span><span class='comma token'>,</span>
    <span class='string val'>'broker_auth_iv'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_read identifier id'>read</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@config ivar id'>@config</span><span class='dot token'>.</span><span class='rubyid_get identifier id'>get</span><span class='lparen token'>(</span><span class='string val'>'GEAR_BASE_DIR'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='rubyid_name identifier id'>name</span><span class='comma token'>,</span> <span class='string val'>'.auth'</span><span class='comma token'>,</span> <span class='string val'>'iv'</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_chomp identifier id'>chomp</span>
  <span class='rbrace token'>}</span>
  
  <span class='rubyid_request identifier id'>request</span> <span class='assign token'>=</span> <span class='rubyid_RestClient constant id'>RestClient</span><span class='colon2 op'>::</span><span class='rubyid_Request constant id'>Request</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:get</span><span class='comma token'>,</span> 
                                    <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_url identifier id'>url</span><span class='comma token'>,</span> 
                                    <span class='symbol val'>:timeout</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>120</span><span class='comma token'>,</span>
                                    <span class='symbol val'>:headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:accept</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'application/json;version=1.0'</span><span class='comma token'>,</span> <span class='symbol val'>:user_agent</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'OpenShift'</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
                                    <span class='symbol val'>:payload</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_params identifier id'>params</span><span class='rparen token'>)</span>
  
  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_response identifier id'>response</span> <span class='assign token'>=</span> <span class='rubyid_request identifier id'>request</span><span class='dot token'>.</span><span class='rubyid_execute identifier id'>execute</span><span class='lparen token'>(</span><span class='rparen token'>)</span>

    <span class='rubyid_if if kw'>if</span> <span class='integer val'>300</span> <span class='leq op'>&lt;=</span> <span class='rubyid_response identifier id'>response</span><span class='dot token'>.</span><span class='rubyid_code identifier id'>code</span> 
      <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_response identifier id'>response</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> 
    <span class='rubyid_raise identifier id'>raise</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_gear_groups identifier id'>gear_groups</span> <span class='assign token'>=</span> <span class='rubyid_JSON constant id'>JSON</span><span class='dot token'>.</span><span class='rubyid_parse identifier id'>parse</span><span class='lparen token'>(</span><span class='rubyid_response identifier id'>response</span><span class='rparen token'>)</span>
  <span class='rubyid_rescue rescue kw'>rescue</span>
    <span class='rubyid_raise identifier id'>raise</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_gear_groups identifier id'>gear_groups</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_secondary_gear_groups-instance_method">
  
    - (<tt>Object</tt>) <strong>get_secondary_gear_groups</strong>(groups) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Given a list of gear groups, return the secondary gear groups
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


700
701
702
703
704
705
706
707
708
709
710
711
712
713
714</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 700</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_secondary_gear_groups identifier id'>get_secondary_gear_groups</span><span class='lparen token'>(</span><span class='rubyid_groups identifier id'>groups</span><span class='rparen token'>)</span>
  <span class='rubyid_secondary_groups identifier id'>secondary_groups</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

  <span class='rubyid_groups identifier id'>groups</span><span class='lbrack token'>[</span><span class='string val'>'data'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group identifier id'>group</span><span class='bitor op'>|</span>
    <span class='rubyid_group identifier id'>group</span><span class='lbrack token'>[</span><span class='string val'>'cartridges'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
      <span class='rubyid_cartridge identifier id'>cartridge</span><span class='lbrack token'>[</span><span class='string val'>'tags'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_tag identifier id'>tag</span> <span class='eq op'>==</span> <span class='string val'>'database'</span>
          <span class='rubyid_secondary_groups identifier id'>secondary_groups</span><span class='lbrack token'>[</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='lbrack token'>[</span><span class='string val'>'name'</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_group identifier id'>group</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_secondary_groups identifier id'>secondary_groups</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle_scalable_restore-instance_method">
  
    - (<tt>Object</tt>) <strong>handle_scalable_restore</strong>(gear_groups, gear_env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 854</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_handle_scalable_restore identifier id'>handle_scalable_restore</span><span class='lparen token'>(</span><span class='rubyid_gear_groups identifier id'>gear_groups</span><span class='comma token'>,</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>
  <span class='rubyid_secondary_groups identifier id'>secondary_groups</span> <span class='assign token'>=</span> <span class='rubyid_get_secondary_gear_groups identifier id'>get_secondary_gear_groups</span><span class='lparen token'>(</span><span class='rubyid_gear_groups identifier id'>gear_groups</span><span class='rparen token'>)</span>

  <span class='rubyid_secondary_groups identifier id'>secondary_groups</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_group identifier id'>group</span><span class='bitor op'>|</span>
    <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Restoring snapshot for #{type} gear&quot;</span>

    <span class='rubyid_ssh_coords identifier id'>ssh_coords</span> <span class='assign token'>=</span> <span class='rubyid_group identifier id'>group</span><span class='lbrack token'>[</span><span class='string val'>'gears'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'ssh_url'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^ssh:\/\//</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
    <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;cat #{type}.tar.gz | #{GEAR_TO_GEAR_SSH} #{ssh_coords} 'restore'&quot;</span><span class='comma token'>,</span>
                    <span class='rubyid_env identifier id'>env</span><span class='colon op'>:</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='comma token'>,</span>
                    <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='lbrack token'>[</span><span class='string val'>'OPENSHIFT_DATA_DIR'</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                    <span class='rubyid_uid identifier id'>uid</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span>
                    <span class='rubyid_gid identifier id'>gid</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_gid identifier id'>gid</span><span class='comma token'>,</span>
                    <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='comma token'>,</span>
                    <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle_scalable_snapshot-instance_method">
  
    - (<tt>Object</tt>) <strong>handle_scalable_snapshot</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 639</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_handle_scalable_snapshot identifier id'>handle_scalable_snapshot</span>
  <span class='rubyid_gear_env identifier id'>gear_env</span> <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Environ constant id'>Environ</span><span class='dot token'>.</span><span class='rubyid_for_gear identifier id'>for_gear</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>

  <span class='rubyid_gear_groups identifier id'>gear_groups</span> <span class='assign token'>=</span> <span class='rubyid_get_gear_groups identifier id'>get_gear_groups</span><span class='lparen token'>(</span><span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>

  <span class='rubyid_get_secondary_gear_groups identifier id'>get_secondary_gear_groups</span><span class='lparen token'>(</span><span class='rubyid_gear_groups identifier id'>gear_groups</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_group identifier id'>group</span><span class='bitor op'>|</span>
    <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Saving snapshot for secondary #{type} gear&quot;</span>

    <span class='rubyid_ssh_coords identifier id'>ssh_coords</span> <span class='assign token'>=</span> <span class='rubyid_group identifier id'>group</span><span class='lbrack token'>[</span><span class='string val'>'gears'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'ssh_url'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^ssh:\/\//</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
    <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{GEAR_TO_GEAR_SSH} #{ssh_coords} 'snapshot' &gt; #{type}.tar.gz&quot;</span><span class='comma token'>,</span>
                    <span class='rubyid_env identifier id'>env</span><span class='colon op'>:</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='comma token'>,</span>
                    <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='lbrack token'>[</span><span class='string val'>'OPENSHIFT_DATA_DIR'</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                    <span class='rubyid_uid identifier id'>uid</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span>
                    <span class='rubyid_gid identifier id'>gid</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_gid identifier id'>gid</span><span class='comma token'>,</span>
                    <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='comma token'>,</span>
                    <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    - (<tt>Object</tt>) <strong>name</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 82</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_name identifier id'>name</span>
  <span class='rubyid_@uuid ivar id'>@uuid</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="post_configure-instance_method">
  
    - (<tt>Object</tt>) <strong>post_configure</strong>(cart_name, template_git_url = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 102</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_post_configure identifier id'>post_configure</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_template_git_url identifier id'>template_git_url</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_output identifier id'>output</span> <span class='assign token'>=</span> <span class='string val'>''</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_@build_model ivar id'>@build_model</span> <span class='eq op'>==</span> <span class='symbol val'>:v1</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_template_git_url identifier id'>template_git_url</span>
      <span class='rubyid_cartridge identifier id'>cartridge</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_get_cartridge identifier id'>get_cartridge</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
      <span class='rubyid_output identifier id'>output</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_resolve_application_dependencies identifier id'>resolve_application_dependencies</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_buildable? fid id'>buildable?</span>        
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_else else kw'>else</span>
  
    <span class='rubyid_cartridge identifier id'>cartridge</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_get_cartridge identifier id'>get_cartridge</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>

    <span class='comment val'># Only perform an initial build if the manifest explicitly specifies a need,</span>
    <span class='comment val'># or if a template Git URL is provided and the cart is capable of builds or deploys.</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_install_build_required identifier id'>install_build_required</span> <span class='orop op'>||</span> <span class='lparen token'>(</span><span class='rubyid_template_git_url identifier id'>template_git_url</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_cartridge identifier id'>cartridge</span><span class='dot token'>.</span><span class='rubyid_buildable? fid id'>buildable?</span><span class='rparen token'>)</span>
      <span class='rubyid_gear_script_log identifier id'>gear_script_log</span> <span class='assign token'>=</span> <span class='string val'>'/tmp/initial-build.log'</span>
      <span class='rubyid_env identifier id'>env</span>             <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Environ constant id'>Environ</span><span class='dot token'>.</span><span class='rubyid_for_gear identifier id'>for_gear</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>
  
      <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_info identifier id'>info</span> <span class='dstring node'>&quot;Executing initial gear prereceive for #{@uuid}&quot;</span>
      <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;gear prereceive &gt;&gt;#{gear_script_log} 2&gt;&amp;1&quot;</span><span class='comma token'>,</span>
                     <span class='rubyid_env identifier id'>env</span><span class='colon op'>:</span>                 <span class='rubyid_env identifier id'>env</span><span class='comma token'>,</span>
                     <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span>               <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span>
                     <span class='rubyid_uid identifier id'>uid</span><span class='colon op'>:</span>                 <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span>
                     <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

      <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_info identifier id'>info</span> <span class='dstring node'>&quot;Executing initial gear postreceive for #{@uuid}&quot;</span>
      <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;gear postreceive &gt;&gt;#{gear_script_log} 2&gt;&amp;1&quot;</span><span class='comma token'>,</span>
                     <span class='rubyid_env identifier id'>env</span><span class='colon op'>:</span>                 <span class='rubyid_env identifier id'>env</span><span class='comma token'>,</span>
                     <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span>               <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span>
                     <span class='rubyid_uid identifier id'>uid</span><span class='colon op'>:</span>                 <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span>
                     <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>

    <span class='rubyid_output identifier id'>output</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_post_configure identifier id'>post_configure</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_output identifier id'>output</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="post_deploy-instance_method">
  
    - (<tt>Object</tt>) <strong>post_deploy</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Implements the following post-deploy process:
</p>
<pre class="code ruby18"><code class="ruby18">
  1. Run the cartridge +post-deploy+ action
  2. Run the +post-deploy+ user action hook
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


547
548
549
550
551
552
553
554</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 547</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_post_deploy identifier id'>post_deploy</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'post-deploy'</span><span class='comma token'>,</span>
                              <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                              <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                              <span class='rubyid_prefix_action_hooks identifier id'>prefix_action_hooks</span><span class='colon op'>:</span>      <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                              <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                              <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>                      <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="post_receive-instance_method">
  
    - (<tt>Object</tt>) <strong>post_receive</strong>(options = {}) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


412
413
414
415
416
417
418
419
420
421
422
423
424
425</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 412</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_post_receive identifier id'>post_receive</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_builder_cartridge identifier id'>builder_cartridge</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_builder_cartridge identifier id'>builder_cartridge</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_builder_cartridge identifier id'>builder_cartridge</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'post-receive'</span><span class='comma token'>,</span>
                                <span class='rubyid_builder_cartridge identifier id'>builder_cartridge</span><span class='comma token'>,</span>
                                <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_DefaultBuilder constant id'>DefaultBuilder</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_post_receive identifier id'>post_receive</span><span class='lparen token'>(</span><span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>        <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                          <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>        <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                          <span class='rubyid_hot_deploy identifier id'>hot_deploy</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:hot_deploy</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pre_receive-instance_method">
  
    - (<tt>Object</tt>) <strong>pre_receive</strong>(options = {}) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 390</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_pre_receive identifier id'>pre_receive</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_builder_cartridge identifier id'>builder_cartridge</span> <span class='assign token'>=</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_builder_cartridge identifier id'>builder_cartridge</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_builder_cartridge identifier id'>builder_cartridge</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'pre-receive'</span><span class='comma token'>,</span>
                                <span class='rubyid_builder_cartridge identifier id'>builder_cartridge</span><span class='comma token'>,</span>
                                <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_DefaultBuilder constant id'>DefaultBuilder</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_self self kw'>self</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_pre_receive identifier id'>pre_receive</span><span class='lparen token'>(</span><span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>        <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                         <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>        <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                         <span class='rubyid_hot_deploy identifier id'>hot_deploy</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:hot_deploy</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'pre-receive'</span><span class='comma token'>,</span>
                                <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                                <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>                       <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>                       <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span>  <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                <span class='rubyid_post_action_hooks_enabled identifier id'>post_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepare_for_restore-instance_method">
  
    - (<tt>Object</tt>) <strong>prepare_for_restore</strong>(restore_git_repo, gear_env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


801
802
803
804
805
806
807
808
809
810
811
812</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 801</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_prepare_for_restore identifier id'>prepare_for_restore</span><span class='lparen token'>(</span><span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span><span class='comma token'>,</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span>
    <span class='rubyid_app_name identifier id'>app_name</span> <span class='assign token'>=</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='lbrack token'>[</span><span class='string val'>'OPENSHIFT_APP_NAME'</span><span class='rbrack token'>]</span>
    <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;Removing old git repo: ~/git/#{app_name}.git/&quot;</span>
    <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span><span class='lparen token'>(</span><span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_glob identifier id'>glob</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span> <span class='string val'>'git'</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{app_name}.git&quot;</span><span class='comma token'>,</span> <span class='string val'>'[^h]*'</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;Removing old data dir: ~/app-root/data/*&quot;</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span><span class='lparen token'>(</span><span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_glob identifier id'>glob</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span> <span class='string val'>'app-root'</span><span class='comma token'>,</span> <span class='string val'>'data'</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm_rf identifier id'>rm_rf</span><span class='lparen token'>(</span><span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_glob identifier id'>glob</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span> <span class='string val'>'app-root'</span><span class='comma token'>,</span> <span class='string val'>'data'</span><span class='comma token'>,</span> <span class='string val'>'.[^.]*'</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_safe_unlink identifier id'>safe_unlink</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span> <span class='string val'>'app-root'</span><span class='comma token'>,</span> <span class='string val'>'runtime'</span><span class='comma token'>,</span> <span class='string val'>'data'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reload-instance_method">
  
    - (<tt>Object</tt>) <strong>reload</strong>(cart_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
reload gear as supported by cartridges
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


581
582
583
584
585
586
587</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 581</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_reload identifier id'>reload</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_State constant id'>State</span><span class='colon2 op'>::</span><span class='rubyid_STARTED constant id'>STARTED</span> <span class='eq op'>==</span> <span class='rubyid_state identifier id'>state</span><span class='dot token'>.</span><span class='rubyid_value identifier id'>value</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'reload'</span><span class='comma token'>,</span> <span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_return return kw'>return</span> <span class='string val'>&quot;Application or component not running. Cannot reload.&quot;</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remote_deploy-instance_method">
  
    - (<tt>Object</tt>) <strong>remote_deploy</strong>(options = {}) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 427</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_remote_deploy identifier id'>remote_deploy</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'process-version'</span><span class='comma token'>,</span>
                              <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                              <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span>  <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                              <span class='rubyid_post_action_hooks_enabled identifier id'>post_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                              <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>                       <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                              <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>                       <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_start_gear identifier id'>start_gear</span><span class='lparen token'>(</span><span class='rubyid_secondary_only identifier id'>secondary_only</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
             <span class='rubyid_user_initiated identifier id'>user_initiated</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
             <span class='rubyid_hot_deploy identifier id'>hot_deploy</span><span class='colon op'>:</span>     <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:hot_deploy</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
             <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
             <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_deploy identifier id'>deploy</span><span class='lparen token'>(</span><span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
         <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_start_gear identifier id'>start_gear</span><span class='lparen token'>(</span><span class='rubyid_primary_only identifier id'>primary_only</span><span class='colon op'>:</span>   <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
             <span class='rubyid_user_initiated identifier id'>user_initiated</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
             <span class='rubyid_hot_deploy identifier id'>hot_deploy</span><span class='colon op'>:</span>     <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:hot_deploy</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
             <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
             <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_post_deploy identifier id'>post_deploy</span><span class='lparen token'>(</span><span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
              <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:init</span><span class='rbrack token'>]</span>
    <span class='rubyid_primary_cart_env_dir identifier id'>primary_cart_env_dir</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='comma token'>,</span> <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='dot token'>.</span><span class='rubyid_directory identifier id'>directory</span><span class='comma token'>,</span> <span class='string val'>'env'</span><span class='rparen token'>)</span>
    <span class='rubyid_primary_cart_env identifier id'>primary_cart_env</span>     <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Environ constant id'>Environ</span><span class='dot token'>.</span><span class='rubyid_load identifier id'>load</span><span class='lparen token'>(</span><span class='rubyid_primary_cart_env_dir identifier id'>primary_cart_env_dir</span><span class='rparen token'>)</span>
    <span class='rubyid_ident identifier id'>ident</span>                <span class='assign token'>=</span> <span class='rubyid_primary_cart_env identifier id'>primary_cart_env</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span><span class='dot token'>.</span><span class='rubyid_grep identifier id'>grep</span><span class='lparen token'>(</span><span class='regexp val'>/^OPENSHIFT_.*_IDENT/</span><span class='rparen token'>)</span>
    <span class='rubyid__ identifier id'>_</span><span class='comma token'>,</span> <span class='rubyid__ identifier id'>_</span><span class='comma token'>,</span> <span class='rubyid_version identifier id'>version</span><span class='comma token'>,</span> <span class='rubyid__ identifier id'>_</span>     <span class='assign token'>=</span> <span class='rubyid_Runtime constant id'>Runtime</span><span class='colon2 op'>::</span><span class='rubyid_Manifest constant id'>Manifest</span><span class='dot token'>.</span><span class='rubyid_parse_ident identifier id'>parse_ident</span><span class='lparen token'>(</span><span class='rubyid_primary_cart_env identifier id'>primary_cart_env</span><span class='lbrack token'>[</span><span class='rubyid_ident identifier id'>ident</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_post_setup identifier id'>post_setup</span><span class='lparen token'>(</span><span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                                <span class='rubyid_version identifier id'>version</span><span class='comma token'>,</span>
                                <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_post_install identifier id'>post_install</span><span class='lparen token'>(</span><span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_primary_cartridge identifier id'>primary_cartridge</span><span class='comma token'>,</span>
                                  <span class='rubyid_version identifier id'>version</span><span class='comma token'>,</span>
                                  <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                  <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_httpd_proxy-instance_method">
  
    - (<tt>Object</tt>) <strong>remove_httpd_proxy</strong>(cart_name) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


382
383
384</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 382</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_remove_httpd_proxy identifier id'>remove_httpd_proxy</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_remove_httpd_proxy identifier id'>remove_httpd_proxy</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="restart-instance_method">
  
    - (<tt>Object</tt>) <strong>restart</strong>(cart_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
restart gear as supported by cartridges
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


573
574
575
576
577
578</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 573</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_restart identifier id'>restart</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_start_cartridge identifier id'>start_cartridge</span><span class='lparen token'>(</span><span class='string val'>'restart'</span><span class='comma token'>,</span> <span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span>
                                   <span class='rubyid_user_initiated identifier id'>user_initiated</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
                                   <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                   <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="restart_httpd_proxy-instance_method">
  
    - (<tt>Object</tt>) <strong>restart_httpd_proxy</strong>(cart_name) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


386
387
388</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 386</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_restart_httpd_proxy identifier id'>restart_httpd_proxy</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_restart_httpd_proxy identifier id'>restart_httpd_proxy</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="restore-instance_method">
  
    - (<tt>Object</tt>) <strong>restore</strong>(restore_git_repo) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Restores a gear from an archive read from STDIN.
</p>
<p>
The operation invoked by this method write output to the client on STDERR.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 749</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_restore identifier id'>restore</span><span class='lparen token'>(</span><span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span><span class='rparen token'>)</span>
  <span class='rubyid_gear_env identifier id'>gear_env</span> <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Environ constant id'>Environ</span><span class='dot token'>.</span><span class='rubyid_for_gear identifier id'>for_gear</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>

  <span class='rubyid_scalable_restore identifier id'>scalable_restore</span> <span class='assign token'>=</span> <span class='notop op'>!</span><span class='notop op'>!</span><span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_web_proxy identifier id'>web_proxy</span> 
  <span class='rubyid_gear_groups identifier id'>gear_groups</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_scalable_restore identifier id'>scalable_restore</span>
    <span class='rubyid_gear_groups identifier id'>gear_groups</span> <span class='assign token'>=</span> <span class='rubyid_get_gear_groups identifier id'>get_gear_groups</span><span class='lparen token'>(</span><span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span>
    <span class='rubyid_pre_receive identifier id'>pre_receive</span><span class='lparen token'>(</span><span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='comma token'>,</span> <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_$stdout gvar id'>$stdout</span><span class='rparen token'>)</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_stop_gear identifier id'>stop_gear</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_each_cartridge identifier id'>each_cartridge</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'pre-restore'</span><span class='comma token'>,</span> 
                                <span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span>
                                <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                <span class='rubyid_post_action_hooks_enabled identifier id'>post_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_prepare_for_restore identifier id'>prepare_for_restore</span><span class='lparen token'>(</span><span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span><span class='comma token'>,</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>

  <span class='rubyid_transforms identifier id'>transforms</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_each_cartridge identifier id'>each_cartridge</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
    <span class='rubyid_transforms identifier id'>transforms</span> <span class='opasgn op'>|=</span> <span class='rubyid_restore_transforms identifier id'>restore_transforms</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_extract_restore_archive identifier id'>extract_restore_archive</span><span class='lparen token'>(</span><span class='rubyid_transforms identifier id'>transforms</span><span class='comma token'>,</span> <span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span><span class='comma token'>,</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_scalable_restore identifier id'>scalable_restore</span>
    <span class='rubyid_handle_scalable_restore identifier id'>handle_scalable_restore</span><span class='lparen token'>(</span><span class='rubyid_gear_groups identifier id'>gear_groups</span><span class='comma token'>,</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_each_cartridge identifier id'>each_cartridge</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'post-restore'</span><span class='comma token'>,</span>
                                 <span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span>
                                 <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                 <span class='rubyid_post_action_hooks_enabled identifier id'>post_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                 <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_restore_git_repo identifier id'>restore_git_repo</span>
    <span class='rubyid_post_receive identifier id'>post_receive</span><span class='lparen token'>(</span><span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='comma token'>,</span> <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_$stdout gvar id'>$stdout</span><span class='rparen token'>)</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_start_gear identifier id'>start_gear</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="snapshot-instance_method">
  
    - (<tt>Object</tt>) <strong>snapshot</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Creates a snapshot of a gear.
</p>
<p>
Writes an archive (in tar.gz format) to the calling process&#8217; STDOUT.
The operations invoked by this method write user-facing output to the
client on STDERR.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 595</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_snapshot identifier id'>snapshot</span>
  <span class='rubyid_stop_gear identifier id'>stop_gear</span>

  <span class='rubyid_scalable_snapshot identifier id'>scalable_snapshot</span> <span class='assign token'>=</span> <span class='notop op'>!</span><span class='notop op'>!</span><span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_web_proxy identifier id'>web_proxy</span> 

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_scalable_snapshot identifier id'>scalable_snapshot</span>
    <span class='rubyid_begin begin kw'>begin</span>
      <span class='rubyid_handle_scalable_snapshot identifier id'>handle_scalable_snapshot</span>
    <span class='rubyid_rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
      <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;We were unable to snapshot this application due to communication issues with the OpenShift broker.  Please try again later.&quot;</span>
      <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;#{e.message}&quot;</span>
      <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='dstring node'>&quot;#{e.backtrace}&quot;</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_false false kw'>false</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_each_cartridge identifier id'>each_cartridge</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'pre-snapshot'</span><span class='comma token'>,</span> 
                                <span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span>
                                <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='comma token'>,</span>
                                <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                <span class='rubyid_post_action_hooks_enabled identifier id'>post_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                <span class='rubyid_prefix_action_hooks identifier id'>prefix_action_hooks</span><span class='colon op'>:</span>      <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_exclusions identifier id'>exclusions</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_each_cartridge identifier id'>each_cartridge</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
    <span class='rubyid_exclusions identifier id'>exclusions</span> <span class='opasgn op'>|=</span> <span class='rubyid_snapshot_exclusions identifier id'>snapshot_exclusions</span><span class='lparen token'>(</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_write_snapshot_archive identifier id'>write_snapshot_archive</span><span class='lparen token'>(</span><span class='rubyid_exclusions identifier id'>exclusions</span><span class='rparen token'>)</span>

  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_each_cartridge identifier id'>each_cartridge</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_cartridge identifier id'>cartridge</span><span class='bitor op'>|</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'post-snapshot'</span><span class='comma token'>,</span> 
                                <span class='rubyid_cartridge identifier id'>cartridge</span><span class='comma token'>,</span> 
                                <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span> <span class='rubyid_$stderr gvar id'>$stderr</span><span class='comma token'>,</span>
                                <span class='rubyid_pre_action_hooks_enabled identifier id'>pre_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='comma token'>,</span>
                                <span class='rubyid_post_action_hooks_enabled identifier id'>post_action_hooks_enabled</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>      

  <span class='rubyid_start_gear identifier id'>start_gear</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start-instance_method">
  
    - (<tt>Object</tt>) <strong>start</strong>(cart_name, options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <h3>Cartridge control methods</h3>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


558
559
560
561
562
563</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 558</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_start identifier id'>start</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_start_cartridge identifier id'>start_cartridge</span><span class='lparen token'>(</span><span class='string val'>'start'</span><span class='comma token'>,</span> <span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span>
                                   <span class='rubyid_user_initiated identifier id'>user_initiated</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
                                   <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                   <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start_gear-instance_method">
  
    - (<tt>Object</tt>) <strong>start_gear</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Sets the application state to <tt>STARTED</tt> and starts the gear. Gear
state implementation is model specific, but <tt>options</tt> is provided to
the implementation.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


330
331
332</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 330</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_start_gear identifier id'>start_gear</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_start_gear identifier id'>start_gear</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="status-instance_method">
  
    - (<tt>Object</tt>) <strong>status</strong>(cart_name) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


871
872
873</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 871</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_status identifier id'>status</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>&quot;status&quot;</span><span class='comma token'>,</span> <span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop-instance_method">
  
    - (<tt>Object</tt>) <strong>stop</strong>(cart_name, options = {}) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


565
566
567
568
569
570</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 565</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_stop identifier id'>stop</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_stop_cartridge identifier id'>stop_cartridge</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span>
                                  <span class='rubyid_user_initiated identifier id'>user_initiated</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
                                  <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:out</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                  <span class='rubyid_err identifier id'>err</span><span class='colon op'>:</span>            <span class='rubyid_options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:err</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop_gear-instance_method">
  
    - (<tt>Object</tt>) <strong>stop_gear</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Sets the application state to <tt>STOPPED</tt> and stops the gear. Gear
stop implementation is model specific, but <tt>options</tt> is provided to
the implementation.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


323
324
325</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 323</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_stop_gear identifier id'>stop_gear</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_stop_gear identifier id'>stop_gear</span><span class='lparen token'>(</span><span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop_lock?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>stop_lock?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


883
884
885</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 883</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_stop_lock? fid id'>stop_lock?</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_stop_lock? fid id'>stop_lock?</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="threaddump-instance_method">
  
    - (<tt>Object</tt>) <strong>threaddump</strong>(cart_name) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


875
876
877
878
879
880
881</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 875</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_threaddump identifier id'>threaddump</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_unless unless kw'>unless</span> <span class='rubyid_State constant id'>State</span><span class='colon2 op'>::</span><span class='rubyid_STARTED constant id'>STARTED</span> <span class='eq op'>==</span> <span class='rubyid_state identifier id'>state</span><span class='dot token'>.</span><span class='rubyid_value identifier id'>value</span>
    <span class='rubyid_return return kw'>return</span> <span class='dstring node'>&quot;CLIENT_ERROR: Application is #{state.value}, must be #{State::STARTED} to allow a thread dump&quot;</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_do_control identifier id'>do_control</span><span class='lparen token'>(</span><span class='string val'>'threaddump'</span><span class='comma token'>,</span> <span class='rubyid_cart_name identifier id'>cart_name</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tidy-instance_method">
  
    - (<tt>Object</tt>) <strong>tidy</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Public: Cleans up the gear, providing any installed cartridges with the
opportunity to perform their own cleanup operations via the tidy hook.
</p>
<p>
The generic gear-level cleanup flow is:
</p>
<ul>
<li>Stop the gear

</li>
<li>Gear temp dir cleanup

</li>
<li>Cartridge tidy hook executions

</li>
<li>Git cleanup

</li>
<li>Start the gear

</li>
</ul>
<p>
Raises an Exception if an internal error occurs, and ignores failed
cartridge tidy hook executions.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 285</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_tidy identifier id'>tidy</span>
  <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Starting tidy on gear #{@uuid}&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_env identifier id'>env</span>      <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Environ constant id'>Environ</span><span class='colon2 op'>::</span><span class='rubyid_for_gear identifier id'>for_gear</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>
  <span class='rubyid_gear_dir identifier id'>gear_dir</span> <span class='assign token'>=</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>'OPENSHIFT_HOMEDIR'</span><span class='rbrack token'>]</span>
  <span class='rubyid_app_name identifier id'>app_name</span> <span class='assign token'>=</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>'OPENSHIFT_APP_NAME'</span><span class='rbrack token'>]</span>

  <span class='rubyid_raise identifier id'>raise</span> <span class='string val'>'Missing required env var OPENSHIFT_HOMEDIR'</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_gear_dir identifier id'>gear_dir</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='string val'>'Missing required env var OPENSHIFT_APP_NAME'</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_app_name identifier id'>app_name</span>

  <span class='rubyid_gear_repo_dir identifier id'>gear_repo_dir</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_gear_dir identifier id'>gear_dir</span><span class='comma token'>,</span> <span class='string val'>'git'</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{app_name}.git&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_gear_tmp_dir identifier id'>gear_tmp_dir</span>  <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_gear_dir identifier id'>gear_dir</span><span class='comma token'>,</span> <span class='string val'>'.tmp'</span><span class='rparen token'>)</span>

  <span class='rubyid_stop_gear identifier id'>stop_gear</span><span class='lparen token'>(</span><span class='rubyid_user_initiated identifier id'>user_initiated</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>

  <span class='comment val'># Perform the gear- and cart- level tidy actions.  At this point, the gear has</span>
  <span class='comment val'># been stopped; we'll attempt to start the gear no matter what tidy operations fail.</span>
  <span class='rubyid_begin begin kw'>begin</span>
    <span class='comment val'># clear out the tmp dir</span>
    <span class='rubyid_gear_level_tidy_tmp identifier id'>gear_level_tidy_tmp</span><span class='lparen token'>(</span><span class='rubyid_gear_tmp_dir identifier id'>gear_tmp_dir</span><span class='rparen token'>)</span>

    <span class='comment val'># Delegate to cartridge model to perform cart-level tidy operations for all installed carts.</span>
    <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_tidy identifier id'>tidy</span>

    <span class='comment val'># git gc - do this last to maximize room  for git to write changes</span>
    <span class='rubyid_gear_level_tidy_git identifier id'>gear_level_tidy_git</span><span class='lparen token'>(</span><span class='rubyid_gear_repo_dir identifier id'>gear_repo_dir</span><span class='rparen token'>)</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
    <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_warn identifier id'>warn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;An unknown exception occured during tidy for gear #{@uuid}: #{e.message}\n#{e.backtrace}&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_ensure ensure kw'>ensure</span>
    <span class='rubyid_start_gear identifier id'>start_gear</span><span class='lparen token'>(</span><span class='rubyid_user_initiated identifier id'>user_initiated</span><span class='colon op'>:</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Completed tidy for gear #{@uuid}&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tidy_action-instance_method">
  
    - (<tt>Object</tt>) <strong>tidy_action</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Executes a block, trapping ShellExecutionExceptions and treating them as
warnings. Any other exceptions are unexpected and will bubble out.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


358
359
360
361
362
363
364
365
366
367
368</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 358</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_tidy_action identifier id'>tidy_action</span>
  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_yield yield kw'>yield</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_ShellExecutionException constant id'>ShellExecutionException</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
    <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_warn identifier id'>warn</span><span class='lparen token'>(</span><span class='dstring node'>%Q{
      Tidy operation failed on gear #{@uuid}: #{e.message}
      --- stdout ---\n#{e.stdout}
      --- stderr ---\n#{e.stderr}
                }</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unsubscribe-instance_method">
  
    - (<tt>Object</tt>) <strong>unsubscribe</strong>(cart_name, pub_cart_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Unsubscribe from a cart
</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cart_name</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>
unsubscribing cartridge name
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cart_name</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>
publishing cartridge name
</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 151</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_unsubscribe identifier id'>unsubscribe</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_pub_cart_name identifier id'>pub_cart_name</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_unsubscribe identifier id'>unsubscribe</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_pub_cart_name identifier id'>pub_cart_name</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_namespace-instance_method">
  
    - (<tt>Object</tt>) <strong>update_namespace</strong>(cart_name, old_namespace, new_namespace) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


370
371
372</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 370</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_update_namespace identifier id'>update_namespace</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_old_namespace identifier id'>old_namespace</span><span class='comma token'>,</span> <span class='rubyid_new_namespace identifier id'>new_namespace</span><span class='rparen token'>)</span>
  <span class='rubyid_@cartridge_model ivar id'>@cartridge_model</span><span class='dot token'>.</span><span class='rubyid_update_namespace identifier id'>update_namespace</span><span class='lparen token'>(</span><span class='rubyid_cart_name identifier id'>cart_name</span><span class='comma token'>,</span> <span class='rubyid_old_namespace identifier id'>old_namespace</span><span class='comma token'>,</span> <span class='rubyid_new_namespace identifier id'>new_namespace</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write_snapshot_archive-instance_method">
  
    - (<tt>Object</tt>) <strong>write_snapshot_archive</strong>(exclusions) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/application_container.rb', line 716</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_write_snapshot_archive identifier id'>write_snapshot_archive</span><span class='lparen token'>(</span><span class='rubyid_exclusions identifier id'>exclusions</span><span class='rparen token'>)</span>
  <span class='rubyid_gear_env identifier id'>gear_env</span> <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_Environ constant id'>Environ</span><span class='dot token'>.</span><span class='rubyid_for_gear identifier id'>for_gear</span><span class='lparen token'>(</span><span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_homedir identifier id'>homedir</span><span class='rparen token'>)</span>

  <span class='rubyid_exclusions identifier id'>exclusions</span> <span class='assign token'>=</span> <span class='rubyid_exclusions identifier id'>exclusions</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_x identifier id'>x</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;--exclude=./$OPENSHIFT_GEAR_UUID/#{x}&quot;</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>' '</span><span class='rparen token'>)</span>

  <span class='rubyid_tar_cmd identifier id'>tar_cmd</span> <span class='assign token'>=</span> <span class='dstring node'>%Q{
/bin/tar --ignore-failed-read -czf - \
--exclude=./$OPENSHIFT_GEAR_UUID/.tmp \
--exclude=./$OPENSHIFT_GEAR_UUID/.ssh \
--exclude=./$OPENSHIFT_GEAR_UUID/.sandbox \
--exclude=./$OPENSHIFT_GEAR_UUID/*/conf.d/openshift.conf \
--exclude=./$OPENSHIFT_GEAR_UUID/*/run/httpd.pid \
--exclude=./$OPENSHIFT_GEAR_UUID/haproxy-\*/run/stats \
--exclude=./$OPENSHIFT_GEAR_UUID/app-root/runtime/.state \
--exclude=./$OPENSHIFT_DATA_DIR/.bash_history \
#{exclusions} ./$OPENSHIFT_GEAR_UUID
}</span>

  <span class='rubyid_$stderr gvar id'>$stderr</span><span class='dot token'>.</span><span class='rubyid_puts identifier id'>puts</span> <span class='string val'>'Creating and sending tar.gz'</span>

  <span class='rubyid_Utils constant id'>Utils</span><span class='dot token'>.</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='rubyid_tar_cmd identifier id'>tar_cmd</span><span class='comma token'>,</span>
                 <span class='rubyid_env identifier id'>env</span><span class='colon op'>:</span> <span class='rubyid_gear_env identifier id'>gear_env</span><span class='comma token'>,</span>
                 <span class='rubyid_unsetenv_others identifier id'>unsetenv_others</span><span class='colon op'>:</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span>
                 <span class='rubyid_out identifier id'>out</span><span class='colon op'>:</span> <span class='rubyid_$stdout gvar id'>$stdout</span><span class='comma token'>,</span>
                 <span class='rubyid_chdir identifier id'>chdir</span><span class='colon op'>:</span> <span class='rubyid_@config ivar id'>@config</span><span class='dot token'>.</span><span class='rubyid_get identifier id'>get</span><span class='lparen token'>(</span><span class='string val'>'GEAR_BASE_DIR'</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                 <span class='rubyid_uid identifier id'>uid</span><span class='colon op'>:</span> <span class='rubyid_@user ivar id'>@user</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span>
                 <span class='rubyid_expected_exitstatus identifier id'>expected_exitstatus</span><span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed May  8 18:42:49 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-1.8.7).
</div>

  </body>
</html>