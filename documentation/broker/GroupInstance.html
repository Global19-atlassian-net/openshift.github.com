<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: GroupInstance
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (G)</a> &raquo;
    
    
    <span class="title">GroupInstance</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: GroupInstance
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">GroupInstance</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Mongoid::Document</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">/home/fedora/origin-server/controller/app/models/group_instance.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Represents a group of gears what scale together and have the same
components installed.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#app_dns-instance_method" title="#app_dns (instance method)">- (Boolean) <strong>app_dns</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Indicates if the group instance hosts the web_proxy component and has the
Application DNS pointed to it.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#application-instance_method" title="#application (instance method)">- (Application) <strong>application</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>That this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> is part of.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#gears-instance_method" title="#gears (instance method)">- (Array[Gear]) <strong>gears</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>List of gears that are part of this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span>.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#max-instance_method" title="#max (instance method)">- (Integer) <strong>max</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Calculated maximum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#min-instance_method" title="#min (instance method)">- (Integer) <strong>min</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Calculated minimum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#user_max-instance_method" title="#user_max (instance method)">- (Integer) <strong>user_max</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>User set maximum number of gears.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#user_min-instance_method" title="#user_min (instance method)">- (Integer) <strong>user_min</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>User set minimum number of gears.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#run_on_gears-class_method" title="run_on_gears (class method)">+ (Object) <strong>run_on_gears</strong>(gears = nil, result_io = nil, fail_fast = true, &amp;block) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Run an operation on a list of gears on this group instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_configuration-class_method" title="update_configuration (class method)">+ (Object) <strong>update_configuration</strong>(add_keys = [], remove_keys = [], add_envs = [], remove_envs = [], gears = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds ssh keys to all gears within the group instance.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addtl_fs_gb-instance_method" title="#addtl_fs_gb (instance method)">- (Object) <strong>addtl_fs_gb</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addtl_fs_gb%3D-instance_method" title="#addtl_fs_gb= (instance method)">- (Object) <strong>addtl_fs_gb=</strong>(value) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_component_instances-instance_method" title="#all_component_instances (instance method)">- (Object) <strong>all_component_instances</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#component_instances-instance_method" title="#component_instances (instance method)">- (Object) <strong>component_instances</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gear_size-instance_method" title="#gear_size (instance method)">- (Object) <strong>gear_size</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gear_size%3D-instance_method" title="#gear_size= (instance method)">- (Object) <strong>gear_size=</strong>(value) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_gears-instance_method" title="#get_gears (instance method)">- (Object) <strong>get_gears</strong>(component_instance = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_group_override-instance_method" title="#get_group_override (instance method)">- (Object) <strong>get_group_override</strong>(key = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (GroupInstance) <strong>initialize</strong>(attrs = nil, options = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initializes the application.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_group_override-instance_method" title="#set_group_override (instance method)">- (Object) <strong>set_group_override</strong>(key, value) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sparse_instances-instance_method" title="#sparse_instances (instance method)">- (Object) <strong>sparse_instances</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_hash-instance_method" title="#to_hash (instance method)">- (Hash) <strong>to_hash</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A simplified hash representing this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> object which is used by
<span class='object_link'><a href="Application.html#compute_diffs-instance_method" title="Application#compute_diffs (method)">Application#compute_diffs</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unset_group_override-instance_method" title="#unset_group_override (instance method)">- (Object) <strong>unset_group_override</strong>(key) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span></tt>) <strong>initialize</strong>(attrs = nil, options = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initializes the application</p>

<h2 id="label-Parameters%3A">Parameters:<span><a href="#label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h2>
<dl class="rdoc-list note-list"><dt>custom_id
<dd>
<p>Specify a Moped::BSON::ObjectId to identify this instance</p>
</dd><dt>app_dns
<dd>
<p>Specified that this group instance hosts the primary application DNS
endpoint. @Note used when this gear is hosting the web_proxy component</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32
33
34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 31</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='lbracket'>[</span><span class='symbol'>:custom_id</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:custom_id</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_custom_id'>custom_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="app_dns-instance_method">
  
    - (<tt>Boolean</tt>) <strong>app_dns</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Indicates if the group instance hosts the web_proxy component and has the
Application DNS pointed to it.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Indicates if the group instance hosts the web_proxy component and has the
Application DNS pointed to it.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='kw'>class</span> <span class='const'>GroupInstance</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Mongoid</span><span class='op'>::</span><span class='const'>Document</span>
  <span class='id identifier rubyid_embedded_in'>embedded_in</span> <span class='symbol'>:application</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_embeds_many'>embeds_many</span> <span class='symbol'>:gears</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:min</span><span class='comma'>,</span> <span class='symbol'>:max</span>
  
  <span class='comment'># Initializes the application
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># custom_id::
</span>  <span class='comment'>#   Specify a Moped::BSON::ObjectId to identify this instance
</span>  <span class='comment'># app_dns::
</span>  <span class='comment'>#   Specified that this group instance hosts the primary application DNS endpoint.
</span>  <span class='comment'>#   @Note used when this gear is hosting the web_proxy component
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='lbracket'>[</span><span class='symbol'>:custom_id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:custom_id</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_custom_id'>custom_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_component_instances'>component_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_sparse_instances'>sparse_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group_instance_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_gears'>get_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_component_instance'>component_instance</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_g'>g</span><span class='op'>|</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='kw'>or</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size'>gear_size</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size='>gear_size=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
      <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb='>addtl_fs_gb=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Adds ssh keys to all gears within the group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># add_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys
</span>  <span class='comment'># remove_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys  
</span>  <span class='comment'># add_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># remove_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   List of gears to apply these changes to
</span>  <span class='comment'>#   @Note Used internally during create/scale-up operations
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update_configuration'>update_configuration</span><span class='lparen'>(</span><span class='id identifier rubyid_add_keys'>add_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_handle'>handle</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_create_parallel_job'>create_parallel_job</span>
    <span class='id identifier rubyid_tag'>tag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_run_parallel_on_gears'>run_parallel_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='comma'>,</span> <span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

      <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_get_parallel_run_results'>get_parallel_run_results</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error applying settings to gear: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='embexpr_end'>}</span><span class='tstring_content'> with status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> and output: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span>
  <span class='kw'>end</span>

  <span class='comment'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='lbrace'>{</span><span class='label'>component_instances:</span> <span class='id identifier rubyid_comps'>comps</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='lbrace'>{</span><span class='label'>current:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='label'>additional_filesystem_gb:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span><span class='comma'>,</span> <span class='label'>gear_size:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>_id:</span> <span class='id identifier rubyid__id'>_id</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_comps'>comps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_comp'>comp</span><span class='op'>|</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group_override'>group_override</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
          <span class='kw'>else</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span>
      <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> 
  <span class='kw'>end</span>
 
  <span class='kw'>def</span> <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
      <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_group_override'>new_group_override</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_protected'>protected</span>
  
  <span class='comment'># Run an operation on a list of gears on this group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   Array of {Gear}s to run the operation on
</span>  <span class='comment'>#
</span>  <span class='comment'># result_io::
</span>  <span class='comment'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># fail_fast::
</span>  <span class='comment'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.
</span>  <span class='comment'>#
</span>  <span class='comment'># block::
</span>  <span class='comment'>#   code block to run on all gears.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Returns:
</span>  <span class='comment'># successful runs::
</span>  <span class='comment'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation
</span>  <span class='comment'># failed_runs::
</span>  <span class='comment'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># == Raises:
</span>  <span class='comment'># {Exception} if a gear operation fails and fail_fast is true
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run_on_gears'>run_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successful_runs'>successful_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_failed_runs'>failed_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_gears'>gears</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span> <span class='kw'>if</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_retval'>retval</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:return</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_retval'>retval</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:successful</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span> <span class='symbol'>:failed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span><span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='rbracket'>]</span>
  <span class='kw'>end</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="application-instance_method">
  
    - (<tt><span class='object_link'><a href="Application.html" title="Application (class)">Application</a></span></tt>) <strong>application</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>That this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> is part of.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Application.html" title="Application (class)">Application</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>that this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> is part of.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='kw'>class</span> <span class='const'>GroupInstance</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Mongoid</span><span class='op'>::</span><span class='const'>Document</span>
  <span class='id identifier rubyid_embedded_in'>embedded_in</span> <span class='symbol'>:application</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_embeds_many'>embeds_many</span> <span class='symbol'>:gears</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:min</span><span class='comma'>,</span> <span class='symbol'>:max</span>
  
  <span class='comment'># Initializes the application
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># custom_id::
</span>  <span class='comment'>#   Specify a Moped::BSON::ObjectId to identify this instance
</span>  <span class='comment'># app_dns::
</span>  <span class='comment'>#   Specified that this group instance hosts the primary application DNS endpoint.
</span>  <span class='comment'>#   @Note used when this gear is hosting the web_proxy component
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='lbracket'>[</span><span class='symbol'>:custom_id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:custom_id</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_custom_id'>custom_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_component_instances'>component_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_sparse_instances'>sparse_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group_instance_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_gears'>get_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_component_instance'>component_instance</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_g'>g</span><span class='op'>|</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='kw'>or</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size'>gear_size</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size='>gear_size=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
      <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb='>addtl_fs_gb=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Adds ssh keys to all gears within the group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># add_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys
</span>  <span class='comment'># remove_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys  
</span>  <span class='comment'># add_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># remove_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   List of gears to apply these changes to
</span>  <span class='comment'>#   @Note Used internally during create/scale-up operations
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update_configuration'>update_configuration</span><span class='lparen'>(</span><span class='id identifier rubyid_add_keys'>add_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_handle'>handle</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_create_parallel_job'>create_parallel_job</span>
    <span class='id identifier rubyid_tag'>tag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_run_parallel_on_gears'>run_parallel_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='comma'>,</span> <span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

      <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_get_parallel_run_results'>get_parallel_run_results</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error applying settings to gear: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='embexpr_end'>}</span><span class='tstring_content'> with status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> and output: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span>
  <span class='kw'>end</span>

  <span class='comment'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='lbrace'>{</span><span class='label'>component_instances:</span> <span class='id identifier rubyid_comps'>comps</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='lbrace'>{</span><span class='label'>current:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='label'>additional_filesystem_gb:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span><span class='comma'>,</span> <span class='label'>gear_size:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>_id:</span> <span class='id identifier rubyid__id'>_id</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_comps'>comps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_comp'>comp</span><span class='op'>|</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group_override'>group_override</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
          <span class='kw'>else</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span>
      <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> 
  <span class='kw'>end</span>
 
  <span class='kw'>def</span> <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
      <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_group_override'>new_group_override</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_protected'>protected</span>
  
  <span class='comment'># Run an operation on a list of gears on this group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   Array of {Gear}s to run the operation on
</span>  <span class='comment'>#
</span>  <span class='comment'># result_io::
</span>  <span class='comment'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># fail_fast::
</span>  <span class='comment'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.
</span>  <span class='comment'>#
</span>  <span class='comment'># block::
</span>  <span class='comment'>#   code block to run on all gears.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Returns:
</span>  <span class='comment'># successful runs::
</span>  <span class='comment'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation
</span>  <span class='comment'># failed_runs::
</span>  <span class='comment'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># == Raises:
</span>  <span class='comment'># {Exception} if a gear operation fails and fail_fast is true
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run_on_gears'>run_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successful_runs'>successful_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_failed_runs'>failed_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_gears'>gears</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span> <span class='kw'>if</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_retval'>retval</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:return</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_retval'>retval</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:successful</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span> <span class='symbol'>:failed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span><span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='rbracket'>]</span>
  <span class='kw'>end</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="gears-instance_method">
  
    - (<tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span>[<span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>]</tt>) <strong>gears</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>List of gears that are part of this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span></p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Array.html" title="Array (class)">Array</a></span>[<span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>List of gears that are part of this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='kw'>class</span> <span class='const'>GroupInstance</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Mongoid</span><span class='op'>::</span><span class='const'>Document</span>
  <span class='id identifier rubyid_embedded_in'>embedded_in</span> <span class='symbol'>:application</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_embeds_many'>embeds_many</span> <span class='symbol'>:gears</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:min</span><span class='comma'>,</span> <span class='symbol'>:max</span>
  
  <span class='comment'># Initializes the application
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># custom_id::
</span>  <span class='comment'>#   Specify a Moped::BSON::ObjectId to identify this instance
</span>  <span class='comment'># app_dns::
</span>  <span class='comment'>#   Specified that this group instance hosts the primary application DNS endpoint.
</span>  <span class='comment'>#   @Note used when this gear is hosting the web_proxy component
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='lbracket'>[</span><span class='symbol'>:custom_id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:custom_id</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_custom_id'>custom_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_component_instances'>component_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_sparse_instances'>sparse_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group_instance_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_gears'>get_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_component_instance'>component_instance</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_g'>g</span><span class='op'>|</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='kw'>or</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size'>gear_size</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size='>gear_size=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
      <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb='>addtl_fs_gb=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Adds ssh keys to all gears within the group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># add_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys
</span>  <span class='comment'># remove_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys  
</span>  <span class='comment'># add_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># remove_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   List of gears to apply these changes to
</span>  <span class='comment'>#   @Note Used internally during create/scale-up operations
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update_configuration'>update_configuration</span><span class='lparen'>(</span><span class='id identifier rubyid_add_keys'>add_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_handle'>handle</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_create_parallel_job'>create_parallel_job</span>
    <span class='id identifier rubyid_tag'>tag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_run_parallel_on_gears'>run_parallel_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='comma'>,</span> <span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

      <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_get_parallel_run_results'>get_parallel_run_results</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error applying settings to gear: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='embexpr_end'>}</span><span class='tstring_content'> with status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> and output: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span>
  <span class='kw'>end</span>

  <span class='comment'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='lbrace'>{</span><span class='label'>component_instances:</span> <span class='id identifier rubyid_comps'>comps</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='lbrace'>{</span><span class='label'>current:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='label'>additional_filesystem_gb:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span><span class='comma'>,</span> <span class='label'>gear_size:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>_id:</span> <span class='id identifier rubyid__id'>_id</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_comps'>comps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_comp'>comp</span><span class='op'>|</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group_override'>group_override</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
          <span class='kw'>else</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span>
      <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> 
  <span class='kw'>end</span>
 
  <span class='kw'>def</span> <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
      <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_group_override'>new_group_override</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_protected'>protected</span>
  
  <span class='comment'># Run an operation on a list of gears on this group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   Array of {Gear}s to run the operation on
</span>  <span class='comment'>#
</span>  <span class='comment'># result_io::
</span>  <span class='comment'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># fail_fast::
</span>  <span class='comment'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.
</span>  <span class='comment'>#
</span>  <span class='comment'># block::
</span>  <span class='comment'>#   code block to run on all gears.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Returns:
</span>  <span class='comment'># successful runs::
</span>  <span class='comment'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation
</span>  <span class='comment'># failed_runs::
</span>  <span class='comment'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># == Raises:
</span>  <span class='comment'># {Exception} if a gear operation fails and fail_fast is true
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run_on_gears'>run_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successful_runs'>successful_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_failed_runs'>failed_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_gears'>gears</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span> <span class='kw'>if</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_retval'>retval</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:return</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_retval'>retval</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:successful</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span> <span class='symbol'>:failed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span><span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='rbracket'>]</span>
  <span class='kw'>end</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="max=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="max-instance_method">
  
    - (<tt>Integer</tt>) <strong>max</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Calculated maximum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Calculated maximum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='kw'>class</span> <span class='const'>GroupInstance</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Mongoid</span><span class='op'>::</span><span class='const'>Document</span>
  <span class='id identifier rubyid_embedded_in'>embedded_in</span> <span class='symbol'>:application</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_embeds_many'>embeds_many</span> <span class='symbol'>:gears</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:min</span><span class='comma'>,</span> <span class='symbol'>:max</span>
  
  <span class='comment'># Initializes the application
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># custom_id::
</span>  <span class='comment'>#   Specify a Moped::BSON::ObjectId to identify this instance
</span>  <span class='comment'># app_dns::
</span>  <span class='comment'>#   Specified that this group instance hosts the primary application DNS endpoint.
</span>  <span class='comment'>#   @Note used when this gear is hosting the web_proxy component
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='lbracket'>[</span><span class='symbol'>:custom_id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:custom_id</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_custom_id'>custom_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_component_instances'>component_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_sparse_instances'>sparse_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group_instance_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_gears'>get_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_component_instance'>component_instance</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_g'>g</span><span class='op'>|</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='kw'>or</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size'>gear_size</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size='>gear_size=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
      <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb='>addtl_fs_gb=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Adds ssh keys to all gears within the group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># add_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys
</span>  <span class='comment'># remove_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys  
</span>  <span class='comment'># add_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># remove_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   List of gears to apply these changes to
</span>  <span class='comment'>#   @Note Used internally during create/scale-up operations
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update_configuration'>update_configuration</span><span class='lparen'>(</span><span class='id identifier rubyid_add_keys'>add_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_handle'>handle</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_create_parallel_job'>create_parallel_job</span>
    <span class='id identifier rubyid_tag'>tag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_run_parallel_on_gears'>run_parallel_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='comma'>,</span> <span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

      <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_get_parallel_run_results'>get_parallel_run_results</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error applying settings to gear: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='embexpr_end'>}</span><span class='tstring_content'> with status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> and output: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span>
  <span class='kw'>end</span>

  <span class='comment'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='lbrace'>{</span><span class='label'>component_instances:</span> <span class='id identifier rubyid_comps'>comps</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='lbrace'>{</span><span class='label'>current:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='label'>additional_filesystem_gb:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span><span class='comma'>,</span> <span class='label'>gear_size:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>_id:</span> <span class='id identifier rubyid__id'>_id</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_comps'>comps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_comp'>comp</span><span class='op'>|</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group_override'>group_override</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
          <span class='kw'>else</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span>
      <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> 
  <span class='kw'>end</span>
 
  <span class='kw'>def</span> <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
      <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_group_override'>new_group_override</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_protected'>protected</span>
  
  <span class='comment'># Run an operation on a list of gears on this group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   Array of {Gear}s to run the operation on
</span>  <span class='comment'>#
</span>  <span class='comment'># result_io::
</span>  <span class='comment'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># fail_fast::
</span>  <span class='comment'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.
</span>  <span class='comment'>#
</span>  <span class='comment'># block::
</span>  <span class='comment'>#   code block to run on all gears.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Returns:
</span>  <span class='comment'># successful runs::
</span>  <span class='comment'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation
</span>  <span class='comment'># failed_runs::
</span>  <span class='comment'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># == Raises:
</span>  <span class='comment'># {Exception} if a gear operation fails and fail_fast is true
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run_on_gears'>run_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successful_runs'>successful_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_failed_runs'>failed_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_gears'>gears</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span> <span class='kw'>if</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_retval'>retval</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:return</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_retval'>retval</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:successful</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span> <span class='symbol'>:failed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span><span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='rbracket'>]</span>
  <span class='kw'>end</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="min=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="min-instance_method">
  
    - (<tt>Integer</tt>) <strong>min</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Calculated minimum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Calculated minimum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='kw'>class</span> <span class='const'>GroupInstance</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Mongoid</span><span class='op'>::</span><span class='const'>Document</span>
  <span class='id identifier rubyid_embedded_in'>embedded_in</span> <span class='symbol'>:application</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_embeds_many'>embeds_many</span> <span class='symbol'>:gears</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:min</span><span class='comma'>,</span> <span class='symbol'>:max</span>
  
  <span class='comment'># Initializes the application
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># custom_id::
</span>  <span class='comment'>#   Specify a Moped::BSON::ObjectId to identify this instance
</span>  <span class='comment'># app_dns::
</span>  <span class='comment'>#   Specified that this group instance hosts the primary application DNS endpoint.
</span>  <span class='comment'>#   @Note used when this gear is hosting the web_proxy component
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='lbracket'>[</span><span class='symbol'>:custom_id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:custom_id</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_custom_id'>custom_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_component_instances'>component_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_sparse_instances'>sparse_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group_instance_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_gears'>get_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_component_instance'>component_instance</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_g'>g</span><span class='op'>|</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='kw'>or</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size'>gear_size</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size='>gear_size=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
      <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb='>addtl_fs_gb=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Adds ssh keys to all gears within the group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># add_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys
</span>  <span class='comment'># remove_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys  
</span>  <span class='comment'># add_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># remove_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   List of gears to apply these changes to
</span>  <span class='comment'>#   @Note Used internally during create/scale-up operations
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update_configuration'>update_configuration</span><span class='lparen'>(</span><span class='id identifier rubyid_add_keys'>add_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_handle'>handle</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_create_parallel_job'>create_parallel_job</span>
    <span class='id identifier rubyid_tag'>tag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_run_parallel_on_gears'>run_parallel_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='comma'>,</span> <span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

      <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_get_parallel_run_results'>get_parallel_run_results</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error applying settings to gear: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='embexpr_end'>}</span><span class='tstring_content'> with status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> and output: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span>
  <span class='kw'>end</span>

  <span class='comment'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='lbrace'>{</span><span class='label'>component_instances:</span> <span class='id identifier rubyid_comps'>comps</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='lbrace'>{</span><span class='label'>current:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='label'>additional_filesystem_gb:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span><span class='comma'>,</span> <span class='label'>gear_size:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>_id:</span> <span class='id identifier rubyid__id'>_id</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_comps'>comps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_comp'>comp</span><span class='op'>|</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group_override'>group_override</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
          <span class='kw'>else</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span>
      <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> 
  <span class='kw'>end</span>
 
  <span class='kw'>def</span> <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
      <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_group_override'>new_group_override</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_protected'>protected</span>
  
  <span class='comment'># Run an operation on a list of gears on this group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   Array of {Gear}s to run the operation on
</span>  <span class='comment'>#
</span>  <span class='comment'># result_io::
</span>  <span class='comment'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># fail_fast::
</span>  <span class='comment'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.
</span>  <span class='comment'>#
</span>  <span class='comment'># block::
</span>  <span class='comment'>#   code block to run on all gears.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Returns:
</span>  <span class='comment'># successful runs::
</span>  <span class='comment'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation
</span>  <span class='comment'># failed_runs::
</span>  <span class='comment'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># == Raises:
</span>  <span class='comment'># {Exception} if a gear operation fails and fail_fast is true
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run_on_gears'>run_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successful_runs'>successful_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_failed_runs'>failed_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_gears'>gears</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span> <span class='kw'>if</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_retval'>retval</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:return</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_retval'>retval</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:successful</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span> <span class='symbol'>:failed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span><span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='rbracket'>]</span>
  <span class='kw'>end</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="user_max=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="user_max-instance_method">
  
    - (<tt>Integer</tt>) <strong>user_max</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>User set maximum number of gears.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>User set maximum number of gears.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='kw'>class</span> <span class='const'>GroupInstance</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Mongoid</span><span class='op'>::</span><span class='const'>Document</span>
  <span class='id identifier rubyid_embedded_in'>embedded_in</span> <span class='symbol'>:application</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_embeds_many'>embeds_many</span> <span class='symbol'>:gears</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:min</span><span class='comma'>,</span> <span class='symbol'>:max</span>
  
  <span class='comment'># Initializes the application
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># custom_id::
</span>  <span class='comment'>#   Specify a Moped::BSON::ObjectId to identify this instance
</span>  <span class='comment'># app_dns::
</span>  <span class='comment'>#   Specified that this group instance hosts the primary application DNS endpoint.
</span>  <span class='comment'>#   @Note used when this gear is hosting the web_proxy component
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='lbracket'>[</span><span class='symbol'>:custom_id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:custom_id</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_custom_id'>custom_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_component_instances'>component_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_sparse_instances'>sparse_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group_instance_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_gears'>get_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_component_instance'>component_instance</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_g'>g</span><span class='op'>|</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='kw'>or</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size'>gear_size</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size='>gear_size=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
      <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb='>addtl_fs_gb=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Adds ssh keys to all gears within the group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># add_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys
</span>  <span class='comment'># remove_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys  
</span>  <span class='comment'># add_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># remove_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   List of gears to apply these changes to
</span>  <span class='comment'>#   @Note Used internally during create/scale-up operations
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update_configuration'>update_configuration</span><span class='lparen'>(</span><span class='id identifier rubyid_add_keys'>add_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_handle'>handle</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_create_parallel_job'>create_parallel_job</span>
    <span class='id identifier rubyid_tag'>tag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_run_parallel_on_gears'>run_parallel_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='comma'>,</span> <span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

      <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_get_parallel_run_results'>get_parallel_run_results</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error applying settings to gear: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='embexpr_end'>}</span><span class='tstring_content'> with status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> and output: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span>
  <span class='kw'>end</span>

  <span class='comment'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='lbrace'>{</span><span class='label'>component_instances:</span> <span class='id identifier rubyid_comps'>comps</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='lbrace'>{</span><span class='label'>current:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='label'>additional_filesystem_gb:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span><span class='comma'>,</span> <span class='label'>gear_size:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>_id:</span> <span class='id identifier rubyid__id'>_id</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_comps'>comps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_comp'>comp</span><span class='op'>|</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group_override'>group_override</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
          <span class='kw'>else</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span>
      <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> 
  <span class='kw'>end</span>
 
  <span class='kw'>def</span> <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
      <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_group_override'>new_group_override</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_protected'>protected</span>
  
  <span class='comment'># Run an operation on a list of gears on this group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   Array of {Gear}s to run the operation on
</span>  <span class='comment'>#
</span>  <span class='comment'># result_io::
</span>  <span class='comment'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># fail_fast::
</span>  <span class='comment'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.
</span>  <span class='comment'>#
</span>  <span class='comment'># block::
</span>  <span class='comment'>#   code block to run on all gears.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Returns:
</span>  <span class='comment'># successful runs::
</span>  <span class='comment'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation
</span>  <span class='comment'># failed_runs::
</span>  <span class='comment'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># == Raises:
</span>  <span class='comment'># {Exception} if a gear operation fails and fail_fast is true
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run_on_gears'>run_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successful_runs'>successful_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_failed_runs'>failed_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_gears'>gears</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span> <span class='kw'>if</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_retval'>retval</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:return</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_retval'>retval</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:successful</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span> <span class='symbol'>:failed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span><span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='rbracket'>]</span>
  <span class='kw'>end</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="user_min=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="user_min-instance_method">
  
    - (<tt>Integer</tt>) <strong>user_min</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>User set minimum number of gears.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>User set minimum number of gears.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='kw'>class</span> <span class='const'>GroupInstance</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Mongoid</span><span class='op'>::</span><span class='const'>Document</span>
  <span class='id identifier rubyid_embedded_in'>embedded_in</span> <span class='symbol'>:application</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_embeds_many'>embeds_many</span> <span class='symbol'>:gears</span><span class='comma'>,</span> <span class='label'>class_name:</span> <span class='const'>Gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:min</span><span class='comma'>,</span> <span class='symbol'>:max</span>
  
  <span class='comment'># Initializes the application
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># custom_id::
</span>  <span class='comment'>#   Specify a Moped::BSON::ObjectId to identify this instance
</span>  <span class='comment'># app_dns::
</span>  <span class='comment'>#   Specified that this group instance hosts the primary application DNS endpoint.
</span>  <span class='comment'>#   @Note used when this gear is hosting the web_proxy component
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='op'>=</span> <span class='id identifier rubyid_attrs'>attrs</span><span class='lbracket'>[</span><span class='symbol'>:custom_id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_attrs'>attrs</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:custom_id</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_attrs'>attrs</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_id'>custom_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_custom_id'>custom_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_component_instances'>component_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_sparse_instances'>sparse_instances</span>
    <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group_instance_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_gears'>get_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_component_instance'>component_instance</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_g'>g</span><span class='op'>|</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='kw'>or</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size'>gear_size</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_gear_size='>gear_size=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
      <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span>
    <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb='>addtl_fs_gb=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Adds ssh keys to all gears within the group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># add_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys
</span>  <span class='comment'># remove_keys::
</span>  <span class='comment'>#   Array of Hash containing name, type, content of the ssh keys  
</span>  <span class='comment'># add_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># remove_envs::
</span>  <span class='comment'>#   Array of Hash containing key, value of the environment variables
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   List of gears to apply these changes to
</span>  <span class='comment'>#   @Note Used internally during create/scale-up operations
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update_configuration'>update_configuration</span><span class='lparen'>(</span><span class='id identifier rubyid_add_keys'>add_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_handle'>handle</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_create_parallel_job'>create_parallel_job</span>
    <span class='id identifier rubyid_tag'>tag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_run_parallel_on_gears'>run_parallel_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='comma'>,</span> <span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

      <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_get_parallel_run_results'>get_parallel_run_results</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
      <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>!=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error applying settings to gear: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='embexpr_end'>}</span><span class='tstring_content'> with status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> and output: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result_io'>result_io</span>
  <span class='kw'>end</span>

  <span class='comment'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='lbrace'>{</span><span class='label'>component_instances:</span> <span class='id identifier rubyid_comps'>comps</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='lbrace'>{</span><span class='label'>current:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='label'>additional_filesystem_gb:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span><span class='comma'>,</span> <span class='label'>gear_size:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>_id:</span> <span class='id identifier rubyid__id'>_id</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_comps'>comps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_comp'>comp</span><span class='op'>|</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group_override'>group_override</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='rparen'>)</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
          <span class='kw'>else</span>
            <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span>
      <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> 
  <span class='kw'>end</span>
 
  <span class='kw'>def</span> <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
      <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_new_group_override'>new_group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_group_override'>new_group_override</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_group_override'>group_override</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_protected'>protected</span>
  
  <span class='comment'># Run an operation on a list of gears on this group instance.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Parameters:
</span>  <span class='comment'># gears::
</span>  <span class='comment'>#   Array of {Gear}s to run the operation on
</span>  <span class='comment'>#
</span>  <span class='comment'># result_io::
</span>  <span class='comment'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># fail_fast::
</span>  <span class='comment'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.
</span>  <span class='comment'>#
</span>  <span class='comment'># block::
</span>  <span class='comment'>#   code block to run on all gears.
</span>  <span class='comment'>#
</span>  <span class='comment'># == Returns:
</span>  <span class='comment'># successful runs::
</span>  <span class='comment'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation
</span>  <span class='comment'># failed_runs::
</span>  <span class='comment'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation
</span>  <span class='comment'>#
</span>  <span class='comment'># == Raises:
</span>  <span class='comment'># {Exception} if a gear operation fails and fail_fast is true
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run_on_gears'>run_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successful_runs'>successful_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_failed_runs'>failed_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_gears'>gears</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span> <span class='kw'>if</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_retval'>retval</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:return</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_retval'>retval</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
        <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:successful</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span> <span class='symbol'>:failed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span><span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='rbracket'>]</span>
  <span class='kw'>end</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="run_on_gears-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>run_on_gears</strong>(gears = nil, result_io = nil, fail_fast = true, &amp;block)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Run an operation on a list of gears on this group instance.</p>

<h2 id="label-Parameters%3A">Parameters:<span><a href="#label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h2>
<dl class="rdoc-list note-list"><dt>gears
<dd>
<p>Array of <span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>s to run the operation on</p>
</dd><dt>result_io
<dd>
<p><span class='object_link'><a href="ResultIO.html" title="ResultIO (class)">ResultIO</a></span> object to collect stderr/stdout and exitcode from the operation</p>
</dd><dt>fail_fast
<dd>
<p>Boolean to indicate if the operation should fail fast and raise an
exception on the first failing gear.</p>
</dd><dt>block
<dd>
<p>code block to run on all gears.</p>
</dd></dl>

<h2 id="label-Returns%3A">Returns:<span><a href="#label-Returns%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h2>
<dl class="rdoc-list note-list"><dt>successful runs
<dd>
<p>List of gears where the operation was successful. Each entry is a Hash
:gear -&gt; <span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>, :return -&gt; exitcode of the operation</p>
</dd><dt>failed_runs
<dd>
<p>List of gears where the operation was not successful. Each entry is a Hash
:gear -&gt; <span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>, :exception -&gt; exception raised by the operation</p>
</dd></dl>

<h2 id="label-Raises%3A">Raises:<span><a href="#label-Raises%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<p>Exception if a gear operation fails and fail_fast is true</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 182</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run_on_gears'>run_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_successful_runs'>successful_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_failed_runs'>failed_runs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_gears'>gears</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span> <span class='kw'>if</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_retval'>retval</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:return</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_retval'>retval</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
      <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
      <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
      <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:gear</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_fail_fast'>fail_fast</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Exception</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:successful</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span> <span class='symbol'>:failed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='comma'>,</span> <span class='symbol'>:exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span><span class='rbrace'>}</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_successful_runs'>successful_runs</span><span class='comma'>,</span><span class='id identifier rubyid_failed_runs'>failed_runs</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_configuration-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>update_configuration</strong>(add_keys = [], remove_keys = [], add_envs = [], remove_envs = [], gears = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Adds ssh keys to all gears within the group instance.</p>

<h2 id="label-Parameters%3A">Parameters:<span><a href="#label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h2>
<dl class="rdoc-list note-list"><dt>add_keys
<dd>
<p>Array of Hash containing name, type, content of the ssh keys</p>
</dd><dt>remove_keys
<dd>
<p>Array of Hash containing name, type, content of the ssh keys</p>
</dd><dt>add_envs
<dd>
<p>Array of Hash containing key, value of the environment variables</p>
</dd><dt>remove_envs
<dd>
<p>Array of Hash containing key, value of the environment variables</p>
</dd><dt>gears
<dd>
<p>List of gears to apply these changes to @Note Used internally during
create/scale-up operations</p>
</dd></dl>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 92</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_update_configuration'>update_configuration</span><span class='lparen'>(</span><span class='id identifier rubyid_add_keys'>add_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='op'>=</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_gears'>gears</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_handle'>handle</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_create_parallel_job'>create_parallel_job</span>
  <span class='id identifier rubyid_tag'>tag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_run_parallel_on_gears'>run_parallel_on_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_gears'>gears</span><span class='comma'>,</span> <span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>|</span>
    <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_keys'>add_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='op'>|</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_keys'>remove_keys</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>     <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_add_envs'>add_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span>  <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_env'>env</span><span class='op'>|</span>      <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_add_parallel_job'>add_parallel_job</span><span class='lparen'>(</span><span class='id identifier rubyid_exec_handle'>exec_handle</span><span class='comma'>,</span> <span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_remove_envs'>remove_envs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_get_parallel_run_results'>get_parallel_run_results</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span><span class='op'>|</span>
    <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output'>output</span>
    <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>!=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error applying settings to gear: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='embexpr_end'>}</span><span class='tstring_content'> with status: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='embexpr_end'>}</span><span class='tstring_content'> and output: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result_io'>result_io</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="addtl_fs_gb-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>addtl_fs_gb</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span>
  <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addtl_fs_gb=-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>addtl_fs_gb=</strong>(value) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 74</span>

<span class='kw'>def</span> <span class='id identifier rubyid_addtl_fs_gb='>addtl_fs_gb=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>additional_filesystem_gb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all_component_instances-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>all_component_instances</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 46</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
  <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>group_instance_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="component_instances-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>component_instances</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 38</span>

<span class='kw'>def</span> <span class='id identifier rubyid_component_instances'>component_instances</span>
  <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gear_size-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>gear_size</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 58</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gear_size'>gear_size</span>
  <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gear_size=-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>gear_size=</strong>(value) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65
66
67
68</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 62</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gear_size='>gear_size=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_default_gear_size'>default_gear_size</span>
    <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gear_size</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_gears-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>get_gears</strong>(component_instance = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_gears'>get_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_component_instance'>component_instance</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_g'>g</span><span class='op'>|</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_component_instance'>component_instance</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span> <span class='kw'>or</span> <span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_group_override-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>get_group_override</strong>(key = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 120</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_comps'>comps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_comp'>comp</span><span class='op'>|</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_group_override'>group_override</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span>
          <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
        <span class='kw'>else</span>
          <span class='kw'>return</span> <span class='id identifier rubyid_group_override'>group_override</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span>
    <span class='kw'>return</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_group_override-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>set_group_override</strong>(key, value) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141
142
143
144
145
146
147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_group_override'>set_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_key'>key</span>
  <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
    <span class='id identifier rubyid_group_override'>group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_new_group_override'>new_group_override</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_comps'>comps</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_new_group_override'>new_group_override</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_group_overrides'>group_overrides</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_group_override'>new_group_override</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sparse_instances-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>sparse_instances</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 42</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sparse_instances'>sparse_instances</span>
  <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_hash-instance_method">
  
    - (<tt><span class='object_link'><a href="Hash.html" title="Hash (class)">Hash</a></span></tt>) <strong>to_hash</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A simplified hash representing this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> object which is used by
<span class='object_link'><a href="Application.html#compute_diffs-instance_method" title="Application#compute_diffs (method)">Application#compute_diffs</a></span></p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a simplified hash representing this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> object which is used by
<span class='object_link'><a href="Application.html#compute_diffs-instance_method" title="Application#compute_diffs (method)">Application#compute_diffs</a></span></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 115</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_hash'>to_hash</span>
  <span class='id identifier rubyid_comps'>comps</span> <span class='op'>=</span> <span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_to_hash'>to_hash</span> <span class='rbrace'>}</span>
  <span class='lbrace'>{</span><span class='label'>component_instances:</span> <span class='id identifier rubyid_comps'>comps</span><span class='comma'>,</span> <span class='label'>scale:</span> <span class='lbrace'>{</span><span class='label'>current:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='label'>additional_filesystem_gb:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_addtl_fs_gb'>addtl_fs_gb</span><span class='comma'>,</span> <span class='label'>gear_size:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>_id:</span> <span class='id identifier rubyid__id'>_id</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unset_group_override-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>unset_group_override</strong>(key) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


152
153
154
155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/controller/app/models/group_instance.rb', line 152</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unset_group_override'>unset_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_group_override'>group_override</span> <span class='op'>=</span> <span class='id identifier rubyid_get_group_override'>get_group_override</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_group_override'>group_override</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_group_override'>group_override</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed Jul 31 22:04:42 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>