<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: OpenShift::MCollectiveApplicationContainerProxy
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../OpenShift.html" title="OpenShift (module)">OpenShift</a></span></span>
     &raquo; 
    <span class="title">MCollectiveApplicationContainerProxy</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: OpenShift::MCollectiveApplicationContainerProxy
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">ApplicationContainerProxy</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ApplicationContainerProxy</li>
          
            <li class="next">OpenShift::MCollectiveApplicationContainerProxy</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Implements the broker-node communications This class the state of a node
and a set of RPC functions to the node.  It also has a set of just plain
functions which live here because they relate to broker/node
communications.</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="C_CONTROLLER-classvariable" class="">@@C_CONTROLLER =
          <div class="docstring">
  <div class="discussion">
    
<p>the “cartridge” for Node operation messages to “cartridge_do”</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#district-instance_method" title="#district (instance method)">- (Object) <strong>district</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A District ID string.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#id-instance_method" title="#id (instance method)">- (Object) <strong>id</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A Node ID string.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#blacklisted_in_impl%3F-class_method" title="blacklisted_in_impl? (class method)">+ (Boolean) <strong>blacklisted_in_impl?</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;orphan&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#execute_parallel_jobs_impl-class_method" title="execute_parallel_jobs_impl (class method)">+ (Object) <strong>execute_parallel_jobs_impl</strong>(handle) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;implementation&gt;&gt; &lt;&lt;class method&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#find_app-class_method" title="find_app (class method)">+ (Object) <strong>find_app</strong>(app_uuid, app_name) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the server identity of the specified app.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_available_impl-class_method" title="find_available_impl (class method)">+ (Object) <strong>find_available_impl</strong>(node_profile = nil, district_uuid = nil, least_preferred_server_identities = nil, gear_exists_in_district = false, required_uid = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;factory method&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_one_impl-class_method" title="find_one_impl (class method)">+ (Object) <strong>find_one_impl</strong>(node_profile = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;factory method&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#get_all_active_gears_impl-class_method" title="get_all_active_gears_impl (class method)">+ (Object) <strong>get_all_active_gears_impl</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Retrieve all active gears (implementation).</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#get_all_gears_impl-class_method" title="get_all_gears_impl (class method)">+ (Object) <strong>get_all_gears_impl</strong>(opts) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Retrieve all gear IDs from all nodes (implementation).</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#get_all_gears_sshkeys_impl-class_method" title="get_all_gears_sshkeys_impl (class method)">+ (Object) <strong>get_all_gears_sshkeys_impl</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Retrieve all ssh keys for all gears from all nodes (implementation).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_blacklisted_in_impl-class_method" title="get_blacklisted_in_impl (class method)">+ (Object) <strong>get_blacklisted_in_impl</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;orphan&gt;&gt; &lt;&lt;class method&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_details_for_all_impl-class_method" title="get_details_for_all_impl (class method)">+ (Object) <strong>get_details_for_all_impl</strong>(name_list) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get details (in MCollective, facts) about all nodes that respond.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#get_rpc_client-class_method" title="get_rpc_client (class method)">+ (Object) <strong>get_rpc_client</strong>(agent, options) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get mcollective rpc client.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#known_server_identities-class_method" title="known_server_identities (class method)">+ (Object) <strong>known_server_identities</strong>(force_rediscovery = false, rpc_opts = nil) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Execute a cartridge hook command in a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rpc_exec-class_method" title="rpc_exec (class method)">+ (Object) <strong>rpc_exec</strong>(agent, servers = nil, force_rediscovery = false, options = rpc_options) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Execute an RPC call for the specified agent.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rpc_find_available-class_method" title="rpc_find_available (class method)">+ (Object) <strong>rpc_find_available</strong>(node_profile = nil, district_uuid = nil, least_preferred_server_identities = nil, force_rediscovery = false, gear_exists_in_district = false, required_uid = nil) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>???.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rpc_find_one-class_method" title="rpc_find_one (class method)">+ (Object) <strong>rpc_find_one</strong>(node_profile = nil) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a single node matching a given profile.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rpc_get_fact-class_method" title="rpc_get_fact (class method)">+ (Object) <strong>rpc_get_fact</strong>(fact, servers = nil, force_rediscovery = false, additional_filters = nil, custom_rpc_opts = nil) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the fact value from the specified server.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rpc_get_facts_for_all_nodes-class_method" title="rpc_get_facts_for_all_nodes (class method)">+ (Object) <strong>rpc_get_facts_for_all_nodes</strong>(fact_list) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given a list of facts, get those facts for all nodes that respond.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rpc_options-class_method" title="rpc_options (class method)">+ (Object) <strong>rpc_options</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Make a deep copy of the RPC options hash.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rvalue-class_method" title="rvalue (class method)">+ (Object) <strong>rvalue</strong>(response) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the value of the MCollective response for both a single result and a
multiple result structure.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#valid_gear_sizes_impl-class_method" title="valid_gear_sizes_impl (class method)">+ (Object) <strong>valid_gear_sizes_impl</strong>(user) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;class method&gt;&gt;.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_alias-instance_method" title="#add_alias (instance method)">- (Object) <strong>add_alias</strong>(gear, server_alias) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an application alias to a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_authorized_ssh_key-instance_method" title="#add_authorized_ssh_key (instance method)">- (Object) <strong>add_authorized_ssh_key</strong>(gear, ssh_key, key_type = nil, comment = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an ssh key to a gear on the remote node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_broker_auth_key-instance_method" title="#add_broker_auth_key (instance method)">- (Object) <strong>add_broker_auth_key</strong>(gear, iv, token) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a broker auth key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_component-instance_method" title="#add_component (instance method)">- (Object) <strong>add_component</strong>(gear, component, template_git_url = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a component to an existing gear on the node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_env_var-instance_method" title="#add_env_var (instance method)">- (Object) <strong>add_env_var</strong>(gear, key, value) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an environment variable on gear on a remote node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_ssl_cert-instance_method" title="#add_ssl_cert (instance method)">- (Object) <strong>add_ssl_cert</strong>(gear, ssl_cert, priv_key, server_alias, passphrase = &#39;&#39;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an SSL certificate to a gear on the remote node and associate it with a
server name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_base_component_args-instance_method" title="#build_base_component_args (instance method)">- (Object) <strong>build_base_component_args</strong>(component, existing_args = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_base_gear_args-instance_method" title="#build_base_gear_args (instance method)">- (Object) <strong>build_base_gear_args</strong>(gear, quota_blocks = nil, quota_files = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#component_status-instance_method" title="#component_status (instance method)">- (Object) <strong>component_status</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the status a component service.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#conceal_port-instance_method" title="#conceal_port (instance method)">- (Object) <strong>conceal_port</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>hide a TCP port (?).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">- (Object) <strong>create</strong>(gear, quota_blocks = nil, quota_files = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;instance method&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy-instance_method" title="#destroy (instance method)">- (Object) <strong>destroy</strong>(gear, keep_uid = false, uid = nil, skip_hooks = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove a gear from a node Optionally release a reserved UID from the
District.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#do_with_retry-instance_method" title="#do_with_retry (instance method)">- (Object) <strong>do_with_retry</strong>(action, num_tries = 2) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Try some action until it passes or exceeds a maximum number of tries.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#embedded_carts-instance_method" title="#embedded_carts (instance method)">- (Object) <strong>embedded_carts</strong>(app = nil) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initializes the list of cartridges which are “standalone” or framework.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#execute_direct-instance_method" title="#execute_direct (instance method)">- (Object) <strong>execute_direct</strong>(cartridge, action, args, log_debug_output = true) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>INPUTS:</p>
<ul><li>
<p>cartridge: String, a cartridge name</p>
</li><li>
<p>action: String, and action name</p>
</li><li>
<p>args: Hash: command arguments</p>
</li><li>
<p>long_debug_output: Boolean.</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expose_port-instance_method" title="#expose_port (instance method)">- (Object) <strong>expose_port</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#force_stop-instance_method" title="#force_stop (instance method)">- (Object) <strong>force_stop</strong>(gear, cart) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Force gear services to stop.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#framework_carts-instance_method" title="#framework_carts (instance method)">- (Object) <strong>framework_carts</strong>(app = nil) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initializes the list of cartridges which are “standalone” or framework.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#frontend_backup-instance_method" title="#frontend_backup (instance method)">- (Object) <strong>frontend_backup</strong>(gear) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Extracts the frontend httpd server configuration from a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#frontend_restore-instance_method" title="#frontend_restore (instance method)">- (Object) <strong>frontend_restore</strong>(backup) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Transmits the frontend httpd server configuration to a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_active_capacity-instance_method" title="#get_active_capacity (instance method)">- (Object) <strong>get_active_capacity</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the “active capacity” of a node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_add_authorized_ssh_key_job-instance_method" title="#get_add_authorized_ssh_key_job (instance method)">- (Object) <strong>get_add_authorized_ssh_key_job</strong>(gear, ssh_key, key_type = nil, comment = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to add an authorized key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_app_status-instance_method" title="#get_app_status (instance method)">- (Object) <strong>get_app_status</strong>(app) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get the status of an application.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_available_cartridges-instance_method" title="#get_available_cartridges (instance method)">- (Object) <strong>get_available_cartridges</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;class method&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_broker_auth_key_add_job-instance_method" title="#get_broker_auth_key_add_job (instance method)">- (Object) <strong>get_broker_auth_key_add_job</strong>(gear, iv, token) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to add a broker auth key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_broker_auth_key_remove_job-instance_method" title="#get_broker_auth_key_remove_job (instance method)">- (Object) <strong>get_broker_auth_key_remove_job</strong>(gear) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to remove a broker auth key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_capacity-instance_method" title="#get_capacity (instance method)">- (Object) <strong>get_capacity</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the “capacity” of a node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_cart_status-instance_method" title="#get_cart_status (instance method)">- (Object) <strong>get_cart_status</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get the status of a cartridge in a gear?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_conceal_port_job-instance_method" title="#get_conceal_port_job (instance method)">- (Object) <strong>get_conceal_port_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_district_uuid-instance_method" title="#get_district_uuid (instance method)">- (Object) <strong>get_district_uuid</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the district UUID (membership handle) of a
node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_env_var_add_job-instance_method" title="#get_env_var_add_job (instance method)">- (Object) <strong>get_env_var_add_job</strong>(gear, key, value) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get status on an add env var job?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_env_var_remove_job-instance_method" title="#get_env_var_remove_job (instance method)">- (Object) <strong>get_env_var_remove_job</strong>(gear, key) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to remove an environment variable.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_execute_connector_job-instance_method" title="#get_execute_connector_job (instance method)">- (Object) <strong>get_execute_connector_job</strong>(gear, component, connector_name, connection_type, input_args, pub_cart = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to execute a connector hook ??.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_expose_port_job-instance_method" title="#get_expose_port_job (instance method)">- (Object) <strong>get_expose_port_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>expose a TCP port.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_fix_authorized_ssh_keys_job-instance_method" title="#get_fix_authorized_ssh_keys_job (instance method)">- (Object) <strong>get_fix_authorized_ssh_keys_job</strong>(gear, ssh_keys) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to remove existing authorized ssh keys and add the provided
ones to the gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_force_stop_job-instance_method" title="#get_force_stop_job (instance method)">- (Object) <strong>get_force_stop_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_gear_envs-instance_method" title="#get_gear_envs (instance method)">- (Object) <strong>get_gear_envs</strong>(gear_uuid) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a hash of env variables for a given gear uuid.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_ip_address-instance_method" title="#get_ip_address (instance method)">- (Object) <strong>get_ip_address</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the public IP address of a Node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_node_details-instance_method" title="#get_node_details (instance method)">- (Object) <strong>get_node_details</strong>(name_list) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get details about instance&#39;s node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_node_profile-instance_method" title="#get_node_profile (instance method)">- (Object) <strong>get_node_profile</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the “node profile” of a Node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_public_hostname-instance_method" title="#get_public_hostname (instance method)">- (Object) <strong>get_public_hostname</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the public hostname of a Node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_public_ip_address-instance_method" title="#get_public_ip_address (instance method)">- (Object) <strong>get_public_ip_address</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the public IP address of a Node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_quota-instance_method" title="#get_quota (instance method)">- (Object) <strong>get_quota</strong>(gear) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;object method&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_quota_blocks-instance_method" title="#get_quota_blocks (instance method)">- (Object) <strong>get_quota_blocks</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the quota blocks of a Node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_quota_files-instance_method" title="#get_quota_files (instance method)">- (Object) <strong>get_quota_files</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;accessor&gt;&gt; Get the quota files of a Node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_reload_job-instance_method" title="#get_reload_job (instance method)">- (Object) <strong>get_reload_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_remove_authorized_ssh_key_job-instance_method" title="#get_remove_authorized_ssh_key_job (instance method)">- (Object) <strong>get_remove_authorized_ssh_key_job</strong>(gear, ssh_key, comment = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to remove an authorized key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_restart_job-instance_method" title="#get_restart_job (instance method)">- (Object) <strong>get_restart_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_show_gear_quota_job-instance_method" title="#get_show_gear_quota_job (instance method)">- (Object) <strong>get_show_gear_quota_job</strong>(gear) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to check the disk quota on a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_show_port_job-instance_method" title="#get_show_port_job (instance method)">- (Object) <strong>get_show_port_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_show_state_job-instance_method" title="#get_show_state_job (instance method)">- (Object) <strong>get_show_state_job</strong>(gear) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to return the state of a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_start_job-instance_method" title="#get_start_job (instance method)">- (Object) <strong>get_start_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_status_job-instance_method" title="#get_status_job (instance method)">- (Object) <strong>get_status_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to get status of an application.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_stop_job-instance_method" title="#get_stop_job (instance method)">- (Object) <strong>get_stop_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_threaddump_job-instance_method" title="#get_threaddump_job (instance method)">- (Object) <strong>get_threaddump_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_tidy_job-instance_method" title="#get_tidy_job (instance method)">- (Object) <strong>get_tidy_job</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_unsubscribe_job-instance_method" title="#get_unsubscribe_job (instance method)">- (Object) <strong>get_unsubscribe_job</strong>(gear, component, publish_cart_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to unsubscribe.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_update_gear_quota_job-instance_method" title="#get_update_gear_quota_job (instance method)">- (Object) <strong>get_update_gear_quota_job</strong>(gear, storage_in_gb, inodes) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a job to change the disk quotas on a gear.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#has_app%3F-instance_method" title="#has_app? (instance method)">- (Boolean) <strong>has_app?</strong>(app_uuid, app_name) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether this server has the specified app.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#has_app_cartridge%3F-instance_method" title="#has_app_cartridge? (instance method)">- (Boolean) <strong>has_app_cartridge?</strong>(app_uuid, gear_uuid, cart) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether this gear has the specified cartridge.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#has_embedded_app%3F-instance_method" title="#has_embedded_app? (instance method)">- (Boolean) <strong>has_embedded_app?</strong>(app_uuid, embedded_type) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether this server has the specified embedded app.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#has_uid_or_gid%3F-instance_method" title="#has_uid_or_gid? (instance method)">- (Boolean) <strong>has_uid_or_gid?</strong>(uid) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether this server has already reserved the specified uid as a uid
or gid.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (MCollectiveApplicationContainerProxy) <strong>initialize</strong>(id, district = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;constructor&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#log_debug-instance_method" title="#log_debug (instance method)">- (Object) <strong>log_debug</strong>(message) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Wrap the log messages so it doesn&#39;t HAVE to be rails.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#log_error-instance_method" title="#log_error (instance method)">- (Object) <strong>log_error</strong>(message) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Wrap the log messages so it doesn&#39;t HAVE to be rails.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_gear-instance_method" title="#move_gear (instance method)">- (Object) <strong>move_gear</strong>(gear, destination_container, destination_district_uuid, change_district, node_profile) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_gear_destroy_old-instance_method" title="#move_gear_destroy_old (instance method)">- (Object) <strong>move_gear_destroy_old</strong>(gear, source_container, destination_container, district_changed) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove and destroy a old gear after migration.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_gear_post-instance_method" title="#move_gear_post (instance method)">- (Object) <strong>move_gear_post</strong>(gear, destination_container, state_map) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Re-start a gear after migration.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_gear_pre-instance_method" title="#move_gear_pre (instance method)">- (Object) <strong>move_gear_pre</strong>(gear, state_map) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Prepare to move a gear from one node to another.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_gear_secure-instance_method" title="#move_gear_secure (instance method)">- (Object) <strong>move_gear_secure</strong>(gear, destination_container, destination_district_uuid, change_district, node_profile) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Move a gear from one node to another.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#parse_result-instance_method" title="#parse_result (instance method)">- (Object) <strong>parse_result</strong>(mcoll_reply, gear = nil, command = nil) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Cull wanted information out of an MCollective::Reply object INPUTS:</p>
<ul><li>
<p>mcoll_reply: MCollective::RPC::Reply</p>
</li><li>
<p>gear: A Gear object</p>
</li><li>
<p>command: String.</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#post_configure_component-instance_method" title="#post_configure_component (instance method)">- (Object) <strong>post_configure_component</strong>(gear, component, template_git_url = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Post configuration for a cartridge on a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reload-instance_method" title="#reload (instance method)">- (Object) <strong>reload</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>“reload” cart services on a gear.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#reload_component-instance_method" title="#reload_component (instance method)">- (Object) <strong>reload_component</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reload a component service.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_alias-instance_method" title="#remove_alias (instance method)">- (Object) <strong>remove_alias</strong>(gear, server_alias) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>remove an application alias to a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_authorized_ssh_key-instance_method" title="#remove_authorized_ssh_key (instance method)">- (Object) <strong>remove_authorized_ssh_key</strong>(gear, ssh_key, comment = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>remove an ssh key from a gear on a remote node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_broker_auth_key-instance_method" title="#remove_broker_auth_key (instance method)">- (Object) <strong>remove_broker_auth_key</strong>(gear) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove a broker auth key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_component-instance_method" title="#remove_component (instance method)">- (Object) <strong>remove_component</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove a component from a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_env_var-instance_method" title="#remove_env_var (instance method)">- (Object) <strong>remove_env_var</strong>(gear, key) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove an environment variable on gear on a remote node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_ssl_cert-instance_method" title="#remove_ssl_cert (instance method)">- (Object) <strong>remove_ssl_cert</strong>(gear, server_alias) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>remove an SSL certificate to a gear on the remote node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reserve_uid-instance_method" title="#reserve_uid (instance method)">- (Object) <strong>reserve_uid</strong>(district_uuid = nil, preferred_uid = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reserve a UID within a district or service.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resolve_destination-instance_method" title="#resolve_destination (instance method)">- (Object) <strong>resolve_destination</strong>(gear, destination_container, destination_district_uuid, change_district, node_profile) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>destination_container: ??</p>
</li><li>
<p>destination_district_uuid: String</p>
</li><li>
<p>change_district: Boolean</p>
</li><li>
<p>node_profile: String.</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#restart-instance_method" title="#restart (instance method)">- (Object) <strong>restart</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Stop and restart cart services on a gear.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#restart_component-instance_method" title="#restart_component (instance method)">- (Object) <strong>restart_component</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Restart a component service.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rpc_get_fact_direct-instance_method" title="#rpc_get_fact_direct (instance method)">- (Object) <strong>rpc_get_fact_direct</strong>(fact) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given a known fact and node, get a single fact directly.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rpc_get_facts_direct-instance_method" title="#rpc_get_facts_direct (instance method)">- (Object) <strong>rpc_get_facts_direct</strong>(facts) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given a list of facts, get the facts directly for instance&#39;s node.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rsuccess-instance_method" title="#rsuccess (instance method)">- (Object) <strong>rsuccess</strong>(response) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>true if the response indicates success.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rsync_destination_container-instance_method" title="#rsync_destination_container (instance method)">- (Object) <strong>rsync_destination_container</strong>(gear, destination_container, destination_district_uuid, quota_blocks, quota_files) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>copy the file contents of a gear on this node to a new gear on another.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#run_cartridge_command-instance_method" title="#run_cartridge_command (instance method)">- (Object) <strong>run_cartridge_command</strong>(framework, gear, command, arguments, allow_move = true) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Execute a cartridge hook command in a gear.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#run_cartridge_command_ignore_components-instance_method" title="#run_cartridge_command_ignore_components (instance method)">- (Object) <strong>run_cartridge_command_ignore_components</strong>(cart, gear, command, arguments, allow_move = true) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method wraps run_cartridge_command to acknowledge and consistently
support the behavior until cartridges and components are handled as
distinct concepts within the runtime.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_district-instance_method" title="#set_district (instance method)">- (Object) <strong>set_district</strong>(uuid, active) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set the district of a node.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_quota-instance_method" title="#set_quota (instance method)">- (Object) <strong>set_quota</strong>(gear, storage_in_gb, inodes) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>&lt;&lt;object method&gt;&gt;.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show_port-instance_method" title="#show_port (instance method)">- (Object) <strong>show_port</strong>(gear, cart) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get information on a TCP port.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show_state-instance_method" title="#show_state (instance method)">- (Object) <strong>show_state</strong>(gear) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the operating state of a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-instance_method" title="#start (instance method)">- (Object) <strong>start</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Start cartridge services within a gear.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#start_component-instance_method" title="#start_component (instance method)">- (Object) <strong>start_component</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Start a component service.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#status-instance_method" title="#status (instance method)">- (Object) <strong>status</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the status from cart services in an existing Gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop-instance_method" title="#stop (instance method)">- (Object) <strong>stop</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Stop cartridge services within a gear.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#stop_component-instance_method" title="#stop_component (instance method)">- (Object) <strong>stop_component</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Stop a component service.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#system_messages-instance_method" title="#system_messages (instance method)">- (Object) <strong>system_messages</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>“retrieve the system messages”.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#threaddump-instance_method" title="#threaddump (instance method)">- (Object) <strong>threaddump</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>dump the cartridge threads.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tidy-instance_method" title="#tidy (instance method)">- (Object) <strong>tidy</strong>(gear, component) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Clean up unneeded artifacts in a gear.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unreserve_uid-instance_method" title="#unreserve_uid (instance method)">- (Object) <strong>unreserve_uid</strong>(uid, district_uuid = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Release a UID reservation within a District.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="OpenShift::MCollectiveApplicationContainerProxy (class)">MCollectiveApplicationContainerProxy</a></span></tt>) <strong>initialize</strong>(id, district = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;constructor&gt;&gt;</p>

<p>Create an app descriptor/handle for remote controls</p>

<p>INPUTS:</p>
<ul><li>
<p>id: string - a unique app identifier</p>
</li><li>
<p>district: &lt;type&gt; - a classifier for app placement</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_district'>district</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='ivar'>@id</span> <span class='op'>=</span> <span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@district</span> <span class='op'>=</span> <span class='id identifier rubyid_district'>district</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="district=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="district-instance_method">
  
    - (<tt>Object</tt>) <strong>district</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A District ID string</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_district'>district</span>
  <span class='ivar'>@district</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="id=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="id-instance_method">
  
    - (<tt>Object</tt>) <strong>id</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A Node ID string</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 23</span>

<span class='kw'>def</span> <span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="blacklisted_in_impl?-class_method">
  
    + (<tt>Boolean</tt>) <strong>blacklisted_in_impl?</strong>(name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;orphan&gt;&gt;</p>

<p>&lt;&lt;class method&gt;&gt;</p>

<p>INPUTS:</p>
<ul><li>
<p>name: String.  A name to be checked against the blacklist</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Boolean.  True if the name is in the blacklist</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>This is really a function of the broker</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


164
165
166</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 164</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_blacklisted_in_impl?'>blacklisted_in_impl?</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="execute_parallel_jobs_impl-class_method">
  
    + (<tt>Object</tt>) <strong>execute_parallel_jobs_impl</strong>(handle)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;implementation&gt;&gt; &lt;&lt;class method&gt;&gt;</p>

<p>Execute a set of operations on a node in parallel</p>

<p>INPUTS:</p>
<ul><li>
<p>handle: Hash ???</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>???</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses MCollectiveApplicationContainerProxy.sanitize_result</p>
</li><li>
<p>uses MCollectiveApplicationContainerProxy.rpc_options</p>
</li><li>
<p>uses MCollective::RPC::Client</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3299
3300
3301
3302
3303
3304
3305
3306
3307
3308
3309
3310
3311
3312
3313
3314
3315
3316
3317
3318
3319
3320
3321
3322</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3299</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_execute_parallel_jobs_impl'>execute_parallel_jobs_impl</span><span class='lparen'>(</span><span class='id identifier rubyid_handle'>handle</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_handle'>handle</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_handle'>handle</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_start_time'>start_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_options'>rpc_options</span>
      <span class='id identifier rubyid_rpc_client'>rpc_client</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_get_rpc_client'>get_rpc_client</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_mc_args'>mc_args</span> <span class='op'>=</span> <span class='id identifier rubyid_handle'>handle</span><span class='period'>.</span><span class='id identifier rubyid_clone'>clone</span>
      <span class='id identifier rubyid_identities'>identities</span> <span class='op'>=</span> <span class='id identifier rubyid_handle'>handle</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
      <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_custom_request'>custom_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>execute_parallel</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_mc_args'>mc_args</span><span class='comma'>,</span> <span class='id identifier rubyid_identities'>identities</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_identities'>identities</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:statuscode</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>0</span>
          <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:exitcode</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_sender'>sender</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:sender</span><span class='rbracket'>]</span>
          <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Output of parallel execute: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_content'>, exitcode: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_exitcode'>exitcode</span><span class='embexpr_end'>}</span><span class='tstring_content'>, from: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sender'>sender</span><span class='embexpr_end'>}</span><span class='tstring_content'>  (Request ID: </span><span class='embexpr_beg'>#{</span><span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='symbol'>:user_action_log_uuid</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

          <span class='id identifier rubyid_handle'>handle</span><span class='lbracket'>[</span><span class='id identifier rubyid_sender'>sender</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_output'>output</span> <span class='kw'>if</span> <span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='kw'>end</span>
      <span class='rbrace'>}</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_disconnect'>disconnect</span>
    <span class='kw'>end</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: MCollective Response Time (execute_parallel): </span><span class='embexpr_beg'>#{</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='op'>-</span> <span class='id identifier rubyid_start_time'>start_time</span><span class='embexpr_end'>}</span><span class='tstring_content'>s  (Request ID: </span><span class='embexpr_beg'>#{</span><span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='symbol'>:user_action_log_uuid</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_app-class_method">
  
    + (<tt>Object</tt>) <strong>find_app</strong>(app_uuid, app_name)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the server identity of the specified app</p>

<p>INPUTS:</p>
<ul><li>
<p>app_uuid: String</p>
</li><li>
<p>app_name: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>server identity (string?)</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses rpc_exec</p>
</li><li>
<p>loops over all nodes</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2579
2580
2581
2582
2583
2584
2585
2586
2587
2588
2589
2590
2591</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2579</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_app'>find_app</span><span class='lparen'>(</span><span class='id identifier rubyid_app_uuid'>app_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_app_name'>app_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_server_identity'>server_identity</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_has_app'>has_app</span><span class='lparen'>(</span><span class='symbol'>:uuid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_app_uuid'>app_uuid</span><span class='comma'>,</span>
                   <span class='symbol'>:application</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_app_name'>app_name</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_output'>output</span> <span class='op'>==</span> <span class='kw'>true</span>
        <span class='id identifier rubyid_server_identity'>server_identity</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:senderid</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_server_identity'>server_identity</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_available_impl-class_method">
  
    + (<tt>Object</tt>) <strong>find_available_impl</strong>(node_profile = nil, district_uuid = nil, least_preferred_server_identities = nil, gear_exists_in_district = false, required_uid = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;factory method&gt;&gt;</p>

<p>Find a node which fulfills app requirements.  Implements the superclass
find_available() method</p>

<p>INPUTS:</p>
<ul><li>
<p>node_profile: string identifier for a set of node characteristics</p>
</li><li>
<p>district_uuid: identifier for the district</p>
</li><li>
<p>least_preferred_server_identities: list of server identities that are least
preferred. These could be the ones that won&#39;t allow the gear group to
be highly available</p>
</li><li>
<p>gear_exists_in_district: true if the gear belongs to a node in the same
district</p>
</li><li>
<p>required_uid: the uid that is required to be available in the destination
district</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>an MCollectiveApplicationContainerProxy</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>a class method on Node?</p>
</li><li>
<p>Uses Rails.configuration.msg_broker</p>
</li><li>
<p>Uses District</p>
</li><li>
<p>Calls rpc_find_available</p>
</li></ul>

<p>VALIDATIONS:</p>
<ul><li>
<p>If gear_exists_in_district is true, then required_uid cannot be set and has
to be nil</p>
</li><li>
<p>If gear_exists_in_district is true, then district_uuid must be passed and
cannot be nil</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>OpenShift::NodeException</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99
100
101
102
103
104
105
106
107
108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 97</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_available_impl'>find_available_impl</span><span class='lparen'>(</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_least_preferred_server_identities'>least_preferred_server_identities</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span><span class='op'>=</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_required_uid'>required_uid</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_district'>district</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_current_server'>current_server</span><span class='comma'>,</span> <span class='id identifier rubyid_current_capacity'>current_capacity</span><span class='comma'>,</span> <span class='id identifier rubyid_preferred_district'>preferred_district</span> <span class='op'>=</span> <span class='id identifier rubyid_rpc_find_available'>rpc_find_available</span><span class='lparen'>(</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='comma'>,</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_least_preferred_server_identities'>least_preferred_server_identities</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span><span class='comma'>,</span> <span class='id identifier rubyid_required_uid'>required_uid</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_current_server'>current_server</span>
    <span class='id identifier rubyid_current_server'>current_server</span><span class='comma'>,</span> <span class='id identifier rubyid_current_capacity'>current_capacity</span><span class='comma'>,</span> <span class='id identifier rubyid_preferred_district'>preferred_district</span> <span class='op'>=</span> <span class='id identifier rubyid_rpc_find_available'>rpc_find_available</span><span class='lparen'>(</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='comma'>,</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_least_preferred_server_identities'>least_preferred_server_identities</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span><span class='comma'>,</span> <span class='id identifier rubyid_required_uid'>required_uid</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_district'>district</span> <span class='op'>=</span> <span class='id identifier rubyid_preferred_district'>preferred_district</span> <span class='kw'>if</span> <span class='id identifier rubyid_preferred_district'>preferred_district</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No nodes available.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>140</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_current_server'>current_server</span>
  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: find_available_impl: current_server: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_server'>current_server</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_capacity'>current_capacity</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_current_server'>current_server</span><span class='comma'>,</span> <span class='id identifier rubyid_district'>district</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_one_impl-class_method">
  
    + (<tt>Object</tt>) <strong>find_one_impl</strong>(node_profile = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;factory method&gt;&gt;</p>

<p>Find a single node. Implements superclass find_one() method.</p>

<p>INPUTS:</p>
<ul><li>
<p>node_profile: characteristics for node filtering</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>MCollectiveApplicationContainerProxy</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>Uses rpc_find_one() method</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>OpenShift::NodeException</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124
125
126
127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 122</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_one_impl'>find_one_impl</span><span class='lparen'>(</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_current_server'>current_server</span> <span class='op'>=</span> <span class='id identifier rubyid_rpc_find_one'>rpc_find_one</span><span class='lparen'>(</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_current_server'>current_server</span><span class='comma'>,</span> <span class='id identifier rubyid_capacity'>capacity</span><span class='comma'>,</span> <span class='id identifier rubyid_district'>district</span> <span class='op'>=</span> <span class='id identifier rubyid_rpc_find_available'>rpc_find_available</span><span class='lparen'>(</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_current_server'>current_server</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No nodes found.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>140</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_current_server'>current_server</span>
  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: find_one_impl: current_server: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_server'>current_server</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_current_server'>current_server</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_all_active_gears_impl-class_method">
  
    + (<tt>Object</tt>) <strong>get_all_active_gears_impl</strong>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Retrieve all active gears (implementation)</p>

<p>INPUTS:</p>
<ul><li>
<p>none</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Hash: <a href="http://nodekey">active_gears_map</a></p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>should be class method on Node? or Broker?</p>
</li><li>
<p>uses MCollective::RPC::Client rpc_exec</p>
</li><li>
<p>uses MCollective::RPC::Client.missing_method ??</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3240
3241
3242
3243
3244
3245
3246
3247
3248
3249
3250
3251
3252</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3240</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_all_active_gears_impl'>get_all_active_gears_impl</span>
  <span class='id identifier rubyid_active_gears_map'>active_gears_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_get_all_active_gears'>get_all_active_gears</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:statuscode</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_active_gears'>active_gears</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_sender'>sender</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:senderid</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_active_gears_map'>active_gears_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_sender'>sender</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_active_gears'>active_gears</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_active_gears_map'>active_gears_map</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_all_gears_impl-class_method">
  
    + (<tt>Object</tt>) <strong>get_all_gears_impl</strong>(opts)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Retrieve all gear IDs from all nodes (implementation)</p>

<p>INPUTS:</p>
<ul><li>
<p>none</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Hash [gear_map[], <a href="http://">node_map</a></p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>Should be class method on Node? (All nodes?)</p>
</li><li>
<p>Why doesn&#39;t this just override a method from the superclass?</p>
</li><li>
<p>uses rpc_exec</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3207
3208
3209
3210
3211
3212
3213
3214
3215
3216
3217
3218
3219
3220
3221
3222
3223
3224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3207</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_all_gears_impl'>get_all_gears_impl</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_gear_map'>gear_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_sender_map'>sender_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_get_all_gears'>get_all_gears</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:statuscode</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_sub_gear_map'>sub_gear_map</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_sender'>sender</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:senderid</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_sub_gear_map'>sub_gear_map</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
          <span class='id identifier rubyid_gear_map'>gear_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_sender'>sender</span><span class='comma'>,</span><span class='const'>Integer</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_sender_map'>sender_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_sender'>sender</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_sender_map'>sender_map</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span> <span class='id identifier rubyid_sender'>sender</span>
          <span class='id identifier rubyid_sender_map'>sender_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_sender'>sender</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='const'>Integer</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_k'>k</span>
        <span class='rbrace'>}</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_gear_map'>gear_map</span><span class='comma'>,</span> <span class='id identifier rubyid_sender_map'>sender_map</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_all_gears_sshkeys_impl-class_method">
  
    + (<tt>Object</tt>) <strong>get_all_gears_sshkeys_impl</strong>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Retrieve all ssh keys for all gears from all nodes (implementation)</p>

<p>INPUTS:</p>
<ul><li>
<p>none</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Hash [gear_sshey_map[], <a href="http://">node_list</a></p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>Should be class method on Node? (All nodes?)</p>
</li><li>
<p>Why doesn&#39;t this just override a method from the superclass?</p>
</li><li>
<p>uses rpc_exec</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3268
3269
3270
3271
3272
3273
3274
3275
3276
3277
3278
3279
3280</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3268</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_all_gears_sshkeys_impl'>get_all_gears_sshkeys_impl</span>
  <span class='id identifier rubyid_gear_sshkey_map'>gear_sshkey_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_sender_list'>sender_list</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_get_all_gears_sshkeys'>get_all_gears_sshkeys</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:statuscode</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_gear_sshkey_map'>gear_sshkey_map</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_sender_list'>sender_list</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:senderid</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_gear_sshkey_map'>gear_sshkey_map</span><span class='comma'>,</span> <span class='id identifier rubyid_sender_list'>sender_list</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_blacklisted_in_impl-class_method">
  
    + (<tt>Object</tt>) <strong>get_blacklisted_in_impl</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;orphan&gt;&gt; &lt;&lt;class method&gt;&gt;</p>

<p>Return a list of blacklisted namespaces and app names. Implements
superclass get_blacklisted() method.</p>

<p>INPUTS:</p>
<ul><li>
<p>none</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>empty list</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>Is this really a function of the broker</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 147</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_blacklisted_in_impl'>get_blacklisted_in_impl</span>
  <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_details_for_all_impl-class_method">
  
    + (<tt>Object</tt>) <strong>get_details_for_all_impl</strong>(name_list) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get details (in MCollective, facts) about all nodes that respond</p>

<p>RETURN:</p>
<ul><li>
<p>Hash of hashes: node identity =&gt; fact map for each node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls rpc_get_facts_for_all_nodes</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2151
2152
2153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2151</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_details_for_all_impl'>get_details_for_all_impl</span><span class='lparen'>(</span><span class='id identifier rubyid_name_list'>name_list</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_rpc_get_facts_for_all_nodes'>rpc_get_facts_for_all_nodes</span><span class='lparen'>(</span><span class='id identifier rubyid_name_list'>name_list</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_rpc_client-class_method">
  
    + (<tt>Object</tt>) <strong>get_rpc_client</strong>(agent, options)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get mcollective rpc client. For errors, convert generic exception to
NodeException.</p>

<p>INPUTS:</p>
<ul><li>
<p>agent: String (??)</p>
</li><li>
<p>options: Hash</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>MCollective::RPC::Client</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>Uses MCollective::RPC::Client</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3181
3182
3183
3184
3185
3186
3187
3188
3189
3190
3191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3181</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_rpc_client'>get_rpc_client</span><span class='lparen'>(</span><span class='id identifier rubyid_agent'>agent</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_flags'>flags</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:options</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='symbol'>:exit_on_failure</span> <span class='op'>=&gt;</span> <span class='kw'>false</span> <span class='rbrace'>}</span>

    <span class='kw'>begin</span>
      <span class='id identifier rubyid_rpc_client'>rpc_client</span> <span class='op'>=</span> <span class='id identifier rubyid_rpcclient'>rpcclient</span><span class='lparen'>(</span><span class='id identifier rubyid_agent'>agent</span><span class='comma'>,</span> <span class='id identifier rubyid_flags'>flags</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='rparen'>)</span>
<span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_rpc_client'>rpc_client</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="known_server_identities-class_method">
  
    + (<tt>Object</tt>) <strong>known_server_identities</strong>(force_rediscovery = false, rpc_opts = nil)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Execute a cartridge hook command in a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>force_rediscovery: Boolean</p>
</li><li>
<p>rpc_opts: Hash</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Array of known server identities</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>Exception</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2765
2766
2767
2768
2769
2770
2771
2772
2773
2774
2775
2776
2777</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2765</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_known_server_identities'>known_server_identities</span><span class='lparen'>(</span><span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span><span class='op'>=</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_rpc_opts'>rpc_opts</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_server_identities'>server_identities</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_server_identities'>server_identities</span> <span class='op'>=</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_cache'>cache</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>known_server_identities</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_server_identities'>server_identities</span>
    <span class='id identifier rubyid_server_identities'>server_identities</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_rpc_get_fact'>rpc_get_fact</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active_capacity</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_rpc_opts'>rpc_opts</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_capacity'>capacity</span><span class='op'>|</span>
      <span class='comment'>#Rails.logger.debug &quot;Next server: #{server} active capacity: #{capacity}&quot;
</span>      <span class='id identifier rubyid_server_identities'>server_identities</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_server'>server</span>
    <span class='kw'>end</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_cache'>cache</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>known_server_identities</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_server_identities'>server_identities</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='symbol'>:expires_in</span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_hour'>hour</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_server_identities'>server_identities</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_server_identities'>server_identities</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rpc_exec-class_method">
  
    + (<tt>Object</tt>) <strong>rpc_exec</strong>(agent, servers = nil, force_rediscovery = false, options = rpc_options) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Execute an RPC call for the specified agent. If a server is supplied, only
execute for that server.</p>

<p>INPUTS:</p>
<ul><li>
<p>agent: ??</p>
</li><li>
<p>servers: String|Array</p>
</li><li>
<p>force_rediscovery: Boolean</p>
</li><li>
<p>options: Hash</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>connects, makes a request, closes connection.</p>
</li><li>
<p>uses MCollective::RPC::Client</p>
</li><li>
<p>THIS IS THE MEAT!</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>OpenShift::NodeException</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2176
2177
2178
2179
2180
2181
2182
2183
2184
2185
2186
2187
2188
2189
2190
2191
2192
2193
2194
2195
2196
2197
2198
2199
2200
2201
2202
2203
2204
2205
2206
2207
2208
2209
2210
2211
2212
2213</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2176</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='id identifier rubyid_agent'>agent</span><span class='comma'>,</span> <span class='id identifier rubyid_servers'>servers</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span><span class='op'>=</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='id identifier rubyid_rpc_options'>rpc_options</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_servers'>servers</span>
    <span class='id identifier rubyid_servers'>servers</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_servers'>servers</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_servers'>servers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Setup the rpc client
</span>  <span class='id identifier rubyid_rpc_client'>rpc_client</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_get_rpc_client'>get_rpc_client</span><span class='lparen'>(</span><span class='id identifier rubyid_agent'>agent</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_servers'>servers</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: rpc_exec: Filtering rpc_exec to servers </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_servers'>servers</span><span class='period'>.</span><span class='id identifier rubyid_pretty_inspect'>pretty_inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_discover'>discover</span> <span class='symbol'>:nodes</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_servers'>servers</span>
  <span class='kw'>end</span>

  <span class='comment'># Filter to the specified server
</span>  <span class='comment'>#if server
</span>  <span class='comment'>#  Rails.logger.debug(&quot;DEBUG: rpc_exec: Filtering rpc_exec to server #{server}&quot;)
</span>  <span class='comment'>#  rpc_client.identity_filter(server)
</span>  <span class='comment'>#end
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span>
    <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
  <span class='kw'>end</span>
  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: rpc_exec: rpc_client=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='comment'># Execute a block and make sure we disconnect the client
</span>  <span class='kw'>begin</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>yield</span> <span class='id identifier rubyid_rpc_client'>rpc_client</span>
  <span class='kw'>ensure</span>
    <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_disconnect'>disconnect</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (error getting result from node).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_result'>result</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rpc_find_available-class_method">
  
    + (<tt>Object</tt>) <strong>rpc_find_available</strong>(node_profile = nil, district_uuid = nil, least_preferred_server_identities = nil, force_rediscovery = false, gear_exists_in_district = false, required_uid = nil)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>???</p>

<p>INPUTS:</p>
<ul><li>
<p>node_profile: String identifier for a set of node characteristics</p>
</li><li>
<p>district_uuid: String identifier for the district</p>
</li><li>
<p>least_preferred_server_identities: list of server identities that are least
preferred. These could be the ones that won&#39;t allow the gear group to
be highly available</p>
</li><li>
<p>force_rediscovery: Boolean</p>
</li><li>
<p>gear_exists_in_district: Boolean - true if the gear belongs to a node in
the same district</p>
</li><li>
<p>required_uid: String - the uid that is required to be available in the
destination district</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Array: [server, capacity, district]</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>are the return values String?</p>
</li></ul>

<p>VALIDATIONS:</p>
<ul><li>
<p>If gear_exists_in_district is true, then required_uid cannot be set and has
to be nil</p>
</li><li>
<p>If gear_exists_in_district is true, then district_uuid must be passed and
cannot be nil</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2800
2801
2802
2803
2804
2805
2806
2807
2808
2809
2810
2811
2812
2813
2814
2815
2816
2817
2818
2819
2820
2821
2822
2823
2824
2825
2826
2827
2828
2829
2830
2831
2832
2833
2834
2835
2836
2837
2838
2839
2840
2841
2842
2843
2844
2845
2846
2847
2848
2849
2850
2851
2852
2853
2854
2855
2856
2857
2858
2859
2860
2861
2862
2863
2864
2865
2866
2867
2868
2869
2870
2871
2872
2873
2874
2875
2876
2877
2878
2879
2880
2881
2882
2883
2884
2885
2886
2887
2888
2889
2890
2891
2892
2893
2894
2895
2896
2897
2898
2899
2900
2901
2902
2903
2904
2905
2906
2907
2908
2909
2910
2911
2912
2913
2914
2915
2916
2917
2918
2919</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2800</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rpc_find_available'>rpc_find_available</span><span class='lparen'>(</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_least_preferred_server_identities'>least_preferred_server_identities</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span><span class='op'>=</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span><span class='op'>=</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_required_uid'>required_uid</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NONE</span><span class='tstring_end'>&#39;</span></span>

  <span class='comment'># validate to ensure incompatible parameters are not passed
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_required_uid'>required_uid</span> <span class='kw'>or</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Incompatible parameters being passed for finding available node within the same district</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_require_specific_district'>require_specific_district</span> <span class='op'>=</span> <span class='op'>!</span><span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_require_district'>require_district</span> <span class='op'>=</span> <span class='id identifier rubyid_require_specific_district'>require_specific_district</span>
  <span class='id identifier rubyid_prefer_district'>prefer_district</span> <span class='op'>=</span> <span class='id identifier rubyid_require_specific_district'>require_specific_district</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_require_specific_district'>require_specific_district</span>
    <span class='kw'>if</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_msg_broker'>msg_broker</span><span class='lbracket'>[</span><span class='symbol'>:districts</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:enabled</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>||</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NONE</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_prefer_district'>prefer_district</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>if</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_msg_broker'>msg_broker</span><span class='lbracket'>[</span><span class='symbol'>:districts</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:require_for_app_create</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_require_district'>require_district</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_require_district'>require_district</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_required_uid'>required_uid</span>
  <span class='id identifier rubyid_current_server'>current_server</span><span class='comma'>,</span> <span class='id identifier rubyid_current_capacity'>current_capacity</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_server_infos'>server_infos</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='comment'># First find the most available nodes and match
</span>  <span class='comment'># to their districts.  Take out the almost full nodes if possible and return one of
</span>  <span class='comment'># the nodes within a district with a lot of space.
</span>  <span class='id identifier rubyid_additional_filters'>additional_filters</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active_capacity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                         <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>100</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                         <span class='symbol'>:operator</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_require_specific_district'>require_specific_district</span> <span class='op'>||</span> <span class='id identifier rubyid_require_district'>require_district</span>
    <span class='id identifier rubyid_additional_filters'>additional_filters</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>district_active</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                             <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span>
                             <span class='symbol'>:operator</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>==</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_require_specific_district'>require_specific_district</span>
    <span class='id identifier rubyid_additional_filters'>additional_filters</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>district_uuid</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                             <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='comma'>,</span>
                             <span class='symbol'>:operator</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>==</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_require_district'>require_district</span>
    <span class='id identifier rubyid_additional_filters'>additional_filters</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>district_uuid</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                             <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NONE</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                             <span class='symbol'>:operator</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>!=</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_prefer_district'>prefer_district</span>
    <span class='id identifier rubyid_additional_filters'>additional_filters</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>district_uuid</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                             <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NONE</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                             <span class='symbol'>:operator</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>==</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_node_profile'>node_profile</span> <span class='op'>&amp;&amp;</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_msg_broker'>msg_broker</span><span class='lbracket'>[</span><span class='symbol'>:node_profile_enabled</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_additional_filters'>additional_filters</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>node_profile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                             <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_node_profile'>node_profile</span><span class='comma'>,</span>
                             <span class='symbol'>:operator</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>==</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the districts
</span>  <span class='id identifier rubyid_districts'>districts</span> <span class='op'>=</span> <span class='id identifier rubyid_prefer_district'>prefer_district</span> <span class='op'>?</span> <span class='const'>District</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='comment'># candidate for caching
</span>
  <span class='comment'># Get the active % on the nodes
</span>  <span class='id identifier rubyid_rpc_opts'>rpc_opts</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_rpc_get_fact'>rpc_get_fact</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active_capacity</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span><span class='comma'>,</span> <span class='id identifier rubyid_additional_filters'>additional_filters</span><span class='comma'>,</span> <span class='id identifier rubyid_rpc_opts'>rpc_opts</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_capacity'>capacity</span><span class='op'>|</span>
    <span class='id identifier rubyid_found_district'>found_district</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_districts'>districts</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_district'>district</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_district'>district</span><span class='period'>.</span><span class='id identifier rubyid_server_identities_hash'>server_identities_hash</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_server'>server</span><span class='rparen'>)</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_required_uid'>required_uid</span> <span class='kw'>and</span> <span class='op'>!</span><span class='id identifier rubyid_district'>district</span><span class='period'>.</span><span class='id identifier rubyid_available_uids'>available_uids</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_required_uid'>required_uid</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span> <span class='op'>||</span> <span class='id identifier rubyid_district'>district</span><span class='period'>.</span><span class='id identifier rubyid_available_capacity'>available_capacity</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_district'>district</span><span class='period'>.</span><span class='id identifier rubyid_server_identities_hash'>server_identities_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_server'>server</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_server_infos'>server_infos</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_capacity'>capacity</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='comma'>,</span> <span class='id identifier rubyid_district'>district</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_found_district'>found_district</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_found_district'>found_district</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_require_district'>require_district</span> <span class='comment'># Districts aren&#39;t required in this case
</span>      <span class='id identifier rubyid_server_infos'>server_infos</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_capacity'>capacity</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_require_district'>require_district</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No district nodes available.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>140</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='comment'># Remove the least preferred servers from the list, ensuring there is at least one server remaining
</span>    <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_server_info'>server_info</span><span class='op'>|</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_least_preferred_server_identities'>least_preferred_server_identities</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_least_preferred_server_identities'>least_preferred_server_identities</span>

    <span class='comment'># Remove any non districted nodes if you prefer districts
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_prefer_district'>prefer_district</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_require_district'>require_district</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_districts'>districts</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_has_districted_node'>has_districted_node</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_server_info'>server_info</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_has_districted_node'>has_districted_node</span> <span class='op'>=</span> <span class='kw'>true</span>
          <span class='kw'>break</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_server_info'>server_info</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_has_districted_node'>has_districted_node</span>
    <span class='kw'>end</span>

    <span class='comment'># Sort by node available capacity and take the best half
</span>    <span class='id identifier rubyid_server_infos'>server_infos</span> <span class='op'>=</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_server_info'>server_info</span><span class='op'>|</span> <span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_server_infos'>server_infos</span> <span class='op'>=</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>4</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>/</span> <span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='rparen'>)</span> <span class='comment'># consider the top half and no less than min(4, the actual number of available)
</span>
    <span class='comment'># Sort by district available capacity and take the best half
</span>    <span class='id identifier rubyid_server_infos'>server_infos</span> <span class='op'>=</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_server_info'>server_info</span><span class='op'>|</span> <span class='lparen'>(</span><span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_available_capacity'>available_capacity</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_available_capacity'>available_capacity</span> <span class='op'>:</span> <span class='int'>1</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_server_infos'>server_infos</span> <span class='op'>=</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>4</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>/</span> <span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='rparen'>)</span> <span class='comment'># consider the top half and no less than min(4, the actual number of available)
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_current_district'>current_district</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='comment'># Randomly pick one of the best options
</span>    <span class='id identifier rubyid_server_info'>server_info</span> <span class='op'>=</span> <span class='id identifier rubyid_server_infos'>server_infos</span><span class='lbracket'>[</span><span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='id identifier rubyid_server_infos'>server_infos</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_current_server'>current_server</span> <span class='op'>=</span> <span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_current_capacity'>current_capacity</span> <span class='op'>=</span> <span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_current_district'>current_district</span> <span class='op'>=</span> <span class='id identifier rubyid_server_info'>server_info</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Current server: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_server'>current_server</span><span class='embexpr_end'>}</span><span class='tstring_content'> active capacity: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_capacity'>current_capacity</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_current_server'>current_server</span><span class='comma'>,</span> <span class='id identifier rubyid_current_capacity'>current_capacity</span><span class='comma'>,</span> <span class='id identifier rubyid_current_district'>current_district</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rpc_find_one-class_method">
  
    + (<tt>Object</tt>) <strong>rpc_find_one</strong>(node_profile = nil)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a single node matching a given profile</p>

<p>INPUTS:</p>
<ul><li>
<p>node_profile: Object?</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String: server name?</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>Query facters from every node and filter on server side</p>
</li><li>
<p>uses MCollective::RPC::Client</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2937
2938
2939
2940
2941
2942
2943
2944
2945
2946
2947
2948
2949
2950
2951
2952
2953
2954
2955
2956
2957
2958
2959
2960
2961
2962
2963</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2937</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rpc_find_one'>rpc_find_one</span><span class='lparen'>(</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_current_server'>current_server</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_additional_filters'>additional_filters</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_msg_broker'>msg_broker</span><span class='lbracket'>[</span><span class='symbol'>:node_profile_enabled</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_node_profile'>node_profile</span>
      <span class='id identifier rubyid_additional_filters'>additional_filters</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>node_profile</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                               <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_node_profile'>node_profile</span><span class='comma'>,</span>
                               <span class='symbol'>:operator</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>==</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_options'>rpc_options</span>
  <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:filter</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fact</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:filter</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fact</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_additional_filters'>additional_filters</span>
  <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:mcollective_limit_targets</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_rpc_client'>rpc_client</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_get_rpc_client'>get_rpc_client</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rpcutil</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_get_fact'>get_fact</span><span class='lparen'>(</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>public_hostname</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No nodes found.  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>140</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='const'>Integer</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:statuscode</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='id identifier rubyid_current_server'>current_server</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:senderid</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>ensure</span>
    <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_disconnect'>disconnect</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_current_server'>current_server</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rpc_get_fact-class_method">
  
    + (<tt>Object</tt>) <strong>rpc_get_fact</strong>(fact, servers = nil, force_rediscovery = false, additional_filters = nil, custom_rpc_opts = nil)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the fact value from the specified server. Yields to the supplied
block if there is a non-nil value for the fact.</p>

<p>INPUTS:</p>
<ul><li>
<p>fact: String - a fact name</p>
</li><li>
<p>servers: String|Array - a node name or an array of node names</p>
</li><li>
<p>force_rediscovery: Boolean</p>
</li><li>
<p>additional_filters: ?</p>
</li><li>
<p>custom_rpmc_opts: Hash?</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String?</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses rpc_exec</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3042
3043
3044
3045
3046
3047
3048
3049
3050
3051
3052
3053
3054
3055
3056
3057
3058
3059</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3042</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rpc_get_fact'>rpc_get_fact</span><span class='lparen'>(</span><span class='id identifier rubyid_fact'>fact</span><span class='comma'>,</span> <span class='id identifier rubyid_servers'>servers</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span><span class='op'>=</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_additional_filters'>additional_filters</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_custom_rpc_opts'>custom_rpc_opts</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_custom_rpc_opts'>custom_rpc_opts</span> <span class='op'>?</span> <span class='id identifier rubyid_custom_rpc_opts'>custom_rpc_opts</span> <span class='op'>:</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_options'>rpc_options</span>
  <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:filter</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fact</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:filter</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fact</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_additional_filters'>additional_filters</span> <span class='kw'>if</span> <span class='id identifier rubyid_additional_filters'>additional_filters</span>

  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: rpc_get_fact: fact=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_fact'>fact</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rpcutil</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_servers'>servers</span><span class='comma'>,</span> <span class='id identifier rubyid_force_rediscovery'>force_rediscovery</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_get_fact'>get_fact</span><span class='lparen'>(</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_fact'>fact</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='const'>Integer</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:statuscode</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>

      <span class='comment'># Yield the sender and the value to the block
</span>      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_rvalue'>rvalue</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:senderid</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span> <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rpc_get_facts_for_all_nodes-class_method">
  
    + (<tt>Object</tt>) <strong>rpc_get_facts_for_all_nodes</strong>(fact_list)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given a list of facts, get those facts for all nodes that respond.</p>

<p>INPUTS:</p>
<ul><li>
<p>facts: Enumerable of Strings (fact names)</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Map of Fact to String</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>uses MCollectiveApplicationContainerProxy.rpc_options</p>
</li><li>
<p>uses MCollective::RPC::Client</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3149
3150
3151
3152
3153
3154
3155
3156
3157
3158
3159
3160
3161
3162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3149</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rpc_get_facts_for_all_nodes'>rpc_get_facts_for_all_nodes</span><span class='lparen'>(</span><span class='id identifier rubyid_fact_list'>fact_list</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_node_fact_map'>node_fact_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_get_facts'>get_facts</span><span class='lparen'>(</span><span class='symbol'>:facts</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_fact_list'>fact_list</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:statuscode</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_fact_map'>fact_map</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_sender'>sender</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:senderid</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_fact_map'>fact_map</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_sender'>sender</span>
        <span class='id identifier rubyid_node_fact_map'>node_fact_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_sender'>sender</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_fact_map'>fact_map</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_node_fact_map'>node_fact_map</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rpc_options-class_method">
  
    + (<tt>Object</tt>) <strong>rpc_options</strong>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Make a deep copy of the RPC options hash</p>

<p>INPUTS:</p>

<p>RETURNS:</p>
<ul><li>
<p>Object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>Simple copy by Marshall load/dump</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2976
2977
2978
2979</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2976</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rpc_options'>rpc_options</span>
  <span class='comment'># Make a deep copy of the default options
</span>  <span class='const'>Marshal</span><span class='op'>::</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='const'>Marshal</span><span class='op'>::</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_msg_broker'>msg_broker</span><span class='lbracket'>[</span><span class='symbol'>:rpc_options</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rvalue-class_method">
  
    + (<tt>Object</tt>) <strong>rvalue</strong>(response)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the value of the MCollective response for both a single result and a
multiple result structure</p>

<p>INPUTS:</p>
<ul><li>
<p>response: an MCollective::Response object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String: value string</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>returns value from body or data</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2995
2996
2997
2998
2999
3000
3001
3002
3003
3004
3005</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2995</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_rvalue'>rvalue</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="valid_gear_sizes_impl-class_method">
  
    + (<tt>Object</tt>) <strong>valid_gear_sizes_impl</strong>(user) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;class method&gt;&gt;</p>

<p>Determine what gear sizes are valid for a given user</p>

<p>INPUT:</p>
<ul><li>
<p>user: a reference to a user object</p>
</li></ul>

<p>RETURN:</p>
<ul><li>
<p>list of strings: names of gear sizes</p>
</li></ul>

<p>NOTE:</p>
<ul><li>
<p>an operation on User?</p>
</li><li>
<p>Uses only operations and attributes of user</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 55</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_valid_gear_sizes_impl'>valid_gear_sizes_impl</span><span class='lparen'>(</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_user_capabilities'>user_capabilities</span> <span class='op'>=</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_get_capabilities'>get_capabilities</span>
  <span class='id identifier rubyid_capability_gear_sizes'>capability_gear_sizes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_capability_gear_sizes'>capability_gear_sizes</span> <span class='op'>=</span> <span class='id identifier rubyid_user_capabilities'>user_capabilities</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gear_sizes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_user_capabilities'>user_capabilities</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gear_sizes</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_auth_method'>auth_method</span> <span class='op'>==</span> <span class='symbol'>:broker_auth</span>
    <span class='kw'>return</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_openshift'>openshift</span><span class='lbracket'>[</span><span class='symbol'>:gear_sizes</span><span class='rbracket'>]</span> <span class='op'>|</span> <span class='id identifier rubyid_capability_gear_sizes'>capability_gear_sizes</span>
  <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_capability_gear_sizes'>capability_gear_sizes</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>and</span> <span class='op'>!</span><span class='id identifier rubyid_capability_gear_sizes'>capability_gear_sizes</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_capability_gear_sizes'>capability_gear_sizes</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_openshift'>openshift</span><span class='lbracket'>[</span><span class='symbol'>:default_gear_capabilities</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_alias-instance_method">
  
    - (<tt>Object</tt>) <strong>add_alias</strong>(gear, server_alias) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add an application alias to a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>server_alias: String - a new FQDN for the gear</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String: stdout from a command</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls execute_direct</p>
</li><li>
<p>executes the &#39;add-alias&#39; action on the node</p>
</li><li>
<p>method on Gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1283
1284
1285
1286
1287
1288</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1283</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_alias'>add_alias</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_server_alias'>server_alias</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-alias-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='op'>=</span><span class='id identifier rubyid_server_alias'>server_alias</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>add-alias</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_authorized_ssh_key-instance_method">
  
    - (<tt>Object</tt>) <strong>add_authorized_ssh_key</strong>(gear, ssh_key, key_type = nil, comment = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add an ssh key to a gear on the remote node. See
node/bin/oo-authorized-ssh-key-add.</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>ssh_key: String - an SSH RSA or DSA public key string</p>
</li><li>
<p>key_type: String, Enum [rsa|dsa]</p>
</li><li>
<p>comment: String - identify the key</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>MCollective result string: STDOUT from a command.</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>calls oo-authorized-ssh-key-add on the node</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


511
512
513
514
515
516
517
518</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 511</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_authorized_ssh_key'>add_authorized_ssh_key</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='comma'>,</span> <span class='id identifier rubyid_key_type'>key_type</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_comment'>comment</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-key-type</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_key_type'>key_type</span> <span class='kw'>if</span> <span class='id identifier rubyid_key_type'>key_type</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-key-comment</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_comment'>comment</span> <span class='kw'>if</span> <span class='id identifier rubyid_comment'>comment</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>authorized-ssh-key-add</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_broker_auth_key-instance_method">
  
    - (<tt>Object</tt>) <strong>add_broker_auth_key</strong>(gear, iv, token) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a broker auth key.  The broker auth key allows an application to
request scaling and other actions from the broker.</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>iv: String - SSL initialization vector</p>
</li><li>
<p>token: String - a broker auth key</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>mcollective parsed result string (stdout)</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>calls oo-broker-auth-key-add</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


607
608
609
610
611
612
613</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 607</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_broker_auth_key'>add_broker_auth_key</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_iv'>iv</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-iv</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_iv'>iv</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-token</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>broker-auth-key-add</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_component-instance_method">
  
    - (<tt>Object</tt>) <strong>add_component</strong>(gear, component, template_git_url = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a component to an existing gear on the node</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: string representing cartridge name</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Array [ResultIO, String]</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>Exception</p>
</li></ul>

<p>CATCHES:</p>
<ul><li>
<p>Exception</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses run_cartridge_command</p>
</li><li>
<p>runs “configure” on a “component”</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 835</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_component'>add_component</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_template_git_url'>template_git_url</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_cart_data'>cart_data</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_downloaded_cart'>downloaded_cart</span> <span class='op'>=</span>  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_downloaded_cart_map'>downloaded_cart_map</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>versioned_name</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='op'>==</span><span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span><span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_downloaded_cart'>downloaded_cart</span>
    <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-cartridge-manifest</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_downloaded_cart'>downloaded_cart</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>original_manifest</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-software-version</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_downloaded_cart'>downloaded_cart</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_template_git_url'>template_git_url</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>  <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_template_git_url'>template_git_url</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-template-git-url</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_template_git_url'>template_git_url</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>configure</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_component_details'>component_details</span> <span class='op'>=</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_appInfoIO'>appInfoIO</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_appInfoIO'>appInfoIO</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span>
  <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_debugIO'>debugIO</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_component_details'>component_details</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_component_details'>component_details</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_result_io'>result_io</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_env_var-instance_method">
  
    - (<tt>Object</tt>) <strong>add_env_var</strong>(gear, key, value) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add an environment variable on gear on a remote node. Calls oo-env-var-add
on the remote node</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>key: String - environment variable name</p>
</li><li>
<p>value: String - environment variable value</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>MCollective result string: STDOUT from a command.</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>calls oo-env-var-add on the node</p>
</li><li>
<p>Should be a method on Gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


562
563
564
565
566
567
568</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 562</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_env_var'>add_env_var</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-value</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>env-var-add</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_ssl_cert-instance_method">
  
    - (<tt>Object</tt>) <strong>add_ssl_cert</strong>(gear, ssl_cert, priv_key, server_alias, passphrase = &#39;&#39;) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add an SSL certificate to a gear on the remote node and associate it with a
server name. See node/bin/oo-ssl-cert-add</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>priv_key: String - the private key value</p>
</li><li>
<p>server_alias: String - the name of the server which will offer this key</p>
</li><li>
<p>passphrase: String - the private key passphrase or &#39;&#39; if its
unencrypted.</p>
</li></ul>

<p>RETURNS: a parsed MCollective result</p>

<p>NOTES:</p>
<ul><li>
<p>calls node script oo-ssl-cert-add</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


465
466
467
468
469
470
471
472
473</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 465</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_ssl_cert'>add_ssl_cert</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssl_cert'>ssl_cert</span><span class='comma'>,</span> <span class='id identifier rubyid_priv_key'>priv_key</span><span class='comma'>,</span> <span class='id identifier rubyid_server_alias'>server_alias</span><span class='comma'>,</span> <span class='id identifier rubyid_passphrase'>passphrase</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssl-cert</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>       <span class='op'>=</span> <span class='id identifier rubyid_ssl_cert'>ssl_cert</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-priv-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>       <span class='op'>=</span> <span class='id identifier rubyid_priv_key'>priv_key</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-alias-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>     <span class='op'>=</span> <span class='id identifier rubyid_server_alias'>server_alias</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-passphrase</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>     <span class='op'>=</span> <span class='id identifier rubyid_passphrase'>passphrase</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ssl-cert-add</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build_base_component_args-instance_method">
  
    - (<tt>Object</tt>) <strong>build_base_component_args</strong>(component, existing_args = {}) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


353
354
355
356
357
358
359
360
361
362
363
364
365
366</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 353</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_existing_args'>existing_args</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_existing_args'>existing_args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--cart-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cart'>cart</span>
  <span class='id identifier rubyid_existing_args'>existing_args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--component-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_component_name'>component_name</span>
  <span class='id identifier rubyid_existing_args'>existing_args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-software-version</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>
  <span class='id identifier rubyid_existing_args'>existing_args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--cartridge-vendor</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span>
  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_clist'>clist</span> <span class='op'>=</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_clist'>clist</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='op'>==</span><span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_vendor'>cartridge_vendor</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='id identifier rubyid_existing_args'>existing_args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--cart-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_clist'>clist</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_existing_args'>existing_args</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build_base_gear_args-instance_method">
  
    - (<tt>Object</tt>) <strong>build_base_gear_args</strong>(gear, quota_blocks = nil, quota_files = nil) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


338
339
340
341
342
343
344
345
346
347
348
349
350
351</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 338</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_files'>quota_files</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-app-uuid</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-app-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-container-uuid</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-container-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-quota-blocks</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span> <span class='kw'>if</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-quota-files</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_quota_files'>quota_files</span> <span class='kw'>if</span> <span class='id identifier rubyid_quota_files'>quota_files</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-namespace</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_domain'>domain</span><span class='period'>.</span><span class='id identifier rubyid_namespace'>namespace</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-uid</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span> <span class='kw'>if</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-request-id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='symbol'>:user_action_log_uuid</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_args'>args</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="component_status-instance_method">
  
    - (<tt>Object</tt>) <strong>component_status</strong>(gear, component)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the status a component service</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>component: String: a component name</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO?</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>method on gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2439
2440
2441
2442
2443
2444
2445</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2439</span>

<span class='kw'>def</span> <span class='id identifier rubyid_component_status'>component_status</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>

  <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="conceal_port-instance_method">
  
    - (<tt>Object</tt>) <strong>conceal_port</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>hide a TCP port (?)</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undetermined content</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls run_cartridge_command</p>
</li><li>
<p>executes “conceal-port” action.</p>
</li><li>
<p>method on Gear or Cart?</p>
</li></ul>

<p>Deprecated: remove from the REST API and then delete this.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1241
1242
1243
1244
1245
1246</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1241</span>

<span class='kw'>def</span> <span class='id identifier rubyid_conceal_port'>conceal_port</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>conceal-port</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create-instance_method">
  
    - (<tt>Object</tt>) <strong>create</strong>(gear, quota_blocks = nil, quota_files = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;instance method&gt;&gt;</p>

<p>Execute the &#39;app-create&#39; script on a node.</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>quota_blocks: Integer - max file space in blocks</p>
</li><li>
<p>quota_files: Integer - max files count</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>MCollective “result”, stdout and exit code</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>should raise an exception on fail to cause revert rather than in-line</p>
</li><li>
<p>causes oo-app-create to execute on a node</p>
</li></ul>

<p>Constructs a shell command line to be executed by the MCollective agent on
the node.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 389</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_files'>quota_files</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_files'>quota_files</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>app-create</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

    <span class='kw'>begin</span>
      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ooex'>ooex</span>
      <span class='comment'># destroy the gear in case of failures
</span>      <span class='comment'># the UID will be unreserved up as part of rollback
</span>      <span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>

      <span class='comment'># raise the exception if this is the last retry
</span>      <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_ooex'>ooex</span> <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>==</span> <span class='int'>10</span>

      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_ooex'>ooex</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>==</span> <span class='int'>129</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_has_uid_or_gid?'>has_uid_or_gid?</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span> <span class='comment'># Code to indicate uid already taken
</span>        <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span> <span class='op'>=</span> <span class='id identifier rubyid_reserve_uid'>reserve_uid</span>
        <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_ooex'>ooex</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="destroy-instance_method">
  
    - (<tt>Object</tt>) <strong>destroy</strong>(gear, keep_uid = false, uid = nil, skip_hooks = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove a gear from a node Optionally release a reserved UID from the
District.</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>keep_uid: boolean</p>
</li><li>
<p>uid: Integer: reserved UID</p>
</li><li>
<p>skip_hooks: boolean</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>STDOUT from the remote command</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


436
437
438
439
440
441
442
443
444
445
446
447
448</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 436</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_keep_uid'>keep_uid</span><span class='op'>=</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_uid'>uid</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_skip_hooks'>skip_hooks</span><span class='op'>=</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--skip-hooks</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_skip_hooks'>skip_hooks</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>app-destroy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_uid'>uid</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span> <span class='kw'>unless</span> <span class='id identifier rubyid_uid'>uid</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_keep_uid'>keep_uid</span>
    <span class='id identifier rubyid_unreserve_uid'>unreserve_uid</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_result_io'>result_io</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="do_with_retry-instance_method">
  
    - (<tt>Object</tt>) <strong>do_with_retry</strong>(action, num_tries = 2)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Try some action until it passes or exceeds a maximum number of tries</p>

<p>INPUTS:</p>
<ul><li>
<p>action: Block: a code block or method with no arguments</p>
</li><li>
<p>num_tries: Integer</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>unknown: the result of the action</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>Exception</p>
</li></ul>

<p>CATCHES:</p>
<ul><li>
<p>Exception</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses log_debug</p>
</li><li>
<p>just loops retrys</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2288
2289
2290
2291
2292
2293
2294
2295
2296
2297
2298
2299
2300
2301</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2288</span>

<span class='kw'>def</span> <span class='id identifier rubyid_do_with_retry'>do_with_retry</span><span class='lparen'>(</span><span class='id identifier rubyid_action'>action</span><span class='comma'>,</span> <span class='id identifier rubyid_num_tries'>num_tries</span><span class='op'>=</span><span class='int'>2</span><span class='rparen'>)</span>
  <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_num_tries'>num_tries</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span> <span class='op'>&gt;</span> <span class='int'>1</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Action &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_action'>action</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; succeeded on try </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_content'>.  You can ignore previous error messages or following mcollective debug related to &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_action'>action</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='kw'>break</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Error performing </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_action'>action</span><span class='embexpr_end'>}</span><span class='tstring_content'> on existing app on try </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>==</span> <span class='id identifier rubyid_num_tries'>num_tries</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="embedded_carts-instance_method">
  
    - (<tt>Object</tt>) <strong>embedded_carts</strong>(app = nil)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initializes the list of cartridges which are “standalone” or framework</p>

<p>INPUTS:</p>

<p>RETURNS:</p>
<ul><li>
<p>Array of String</p>
</li></ul>

<p>SIDE EFFECTS:</p>
<ul><li>
<p>initialize @embedded_carts</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>Uses CartridgeCache</p>
</li><li>
<p>Why not just ask the CartridgeCache every time?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2338
2339
2340</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2338</span>

<span class='kw'>def</span> <span class='id identifier rubyid_embedded_carts'>embedded_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='ivar'>@embedded_carts</span> <span class='op'>||=</span> <span class='const'>CartridgeCache</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_names'>cartridge_names</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>embedded</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="execute_direct-instance_method">
  
    - (<tt>Object</tt>) <strong>execute_direct</strong>(cartridge, action, args, log_debug_output = true)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>INPUTS:</p>
<ul><li>
<p>cartridge: String, a cartridge name</p>
</li><li>
<p>action: String, and action name</p>
</li><li>
<p>args: Hash: command arguments</p>
</li><li>
<p>long_debug_output: Boolean</p>
</li></ul>

<p>RETURNS: *</p>

<p>NOTES:</p>
<ul><li>
<p>“cartridge_do” is a catch-all agent message handler</p>
</li><li>
<p>the real switches are the cartridge and action arguments</p>
</li><li>
<p>uses MCollective::RPC::Client</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2485
2486
2487
2488
2489
2490
2491
2492
2493
2494
2495
2496
2497
2498
2499
2500
2501
2502
2503
2504
2505
2506
2507
2508
2509
2510</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2485</span>

<span class='kw'>def</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_cartridge'>cartridge</span><span class='comma'>,</span> <span class='id identifier rubyid_action'>action</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_log_debug_output'>log_debug_output</span><span class='op'>=</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--cart-name</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--cart-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cartridge'>cartridge</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_mc_args'>mc_args</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:cartridge</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_cartridge'>cartridge</span><span class='comma'>,</span>
              <span class='symbol'>:action</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_action'>action</span><span class='comma'>,</span>
              <span class='symbol'>:args</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_args'>args</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_start_time'>start_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_options'>rpc_options</span>
  <span class='id identifier rubyid_rpc_client'>rpc_client</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_get_rpc_client'>get_rpc_client</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>begin</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: rpc_client.custom_request(&#39;cartridge_do&#39;, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mc_args'>mc_args</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='embexpr_beg'>#{</span><span class='ivar'>@id</span><span class='embexpr_end'>}</span><span class='tstring_content'>, {&#39;identity&#39; =&gt; </span><span class='embexpr_beg'>#{</span><span class='ivar'>@id</span><span class='embexpr_end'>}</span><span class='tstring_content'>}) (Request ID: </span><span class='embexpr_beg'>#{</span><span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='symbol'>:user_action_log_uuid</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_custom_request'>custom_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cartridge_do</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_mc_args'>mc_args</span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@id</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> (Request ID: </span><span class='embexpr_beg'>#{</span><span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='symbol'>:user_action_log_uuid</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_log_debug_output'>log_debug_output</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error processing custom_request for action </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_action'>action</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='rparen'>)</span>
  <span class='kw'>ensure</span>
    <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_disconnect'>disconnect</span>
  <span class='kw'>end</span>
  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: MCollective Response Time (execute_direct: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_action'>action</span><span class='embexpr_end'>}</span><span class='tstring_content'>): </span><span class='embexpr_beg'>#{</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='op'>-</span> <span class='id identifier rubyid_start_time'>start_time</span><span class='embexpr_end'>}</span><span class='tstring_content'>s  (Request ID: </span><span class='embexpr_beg'>#{</span><span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='symbol'>:user_action_log_uuid</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_log_debug_output'>log_debug_output</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expose_port-instance_method">
  
    - (<tt>Object</tt>) <strong>expose_port</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1218
1219
1220
1221
1222
1223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1218</span>

<span class='kw'>def</span> <span class='id identifier rubyid_expose_port'>expose_port</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>expose-port</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="force_stop-instance_method">
  
    - (<tt>Object</tt>) <strong>force_stop</strong>(gear, cart) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Force gear services to stop</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: Gear object</p>
</li><li>
<p>cart: Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>result string from STDOUT</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>calls force-stop</p>
</li><li>
<p>method on Node?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1004
1005
1006
1007
1008</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1004</span>

<span class='kw'>def</span> <span class='id identifier rubyid_force_stop'>force_stop</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>force-stop</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="framework_carts-instance_method">
  
    - (<tt>Object</tt>) <strong>framework_carts</strong>(app = nil)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initializes the list of cartridges which are “standalone” or framework</p>

<p>INPUTS:</p>

<p>RETURNS:</p>
<ul><li>
<p>Array of String</p>
</li></ul>

<p>SIDE EFFECTS:</p>
<ul><li>
<p>initialize @framework_carts</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses CartridgeCache</p>
</li><li>
<p>why not just ask the CartidgeCache?</p>
</li><li>
<p>that is: Why use an instance var at all?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2319
2320
2321</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2319</span>

<span class='kw'>def</span> <span class='id identifier rubyid_framework_carts'>framework_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='ivar'>@framework_carts</span> <span class='op'>||=</span> <span class='const'>CartridgeCache</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_names'>cartridge_names</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>web_framework</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="frontend_backup-instance_method">
  
    - (<tt>Object</tt>) <strong>frontend_backup</strong>(gear) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Extracts the frontend httpd server configuration from a gear.</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String - backup blob from the front-end server</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>executes the &#39;frontend-backup&#39; action on the gear.</p>
</li><li>
<p>method on the FrontendHttpd class</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1327
1328
1329
1330
1331
1332
1333
1334
1335
1336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1327</span>

<span class='kw'>def</span> <span class='id identifier rubyid_frontend_backup'>frontend_backup</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-container-uuid</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='op'>=</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-container-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='op'>=</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-namespace</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='op'>=</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_domain'>domain</span><span class='period'>.</span><span class='id identifier rubyid_namespace'>namespace</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>frontend-backup</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="frontend_restore-instance_method">
  
    - (<tt>Object</tt>) <strong>frontend_restore</strong>(backup) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Transmits the frontend httpd server configuration to a gear.</p>

<p>INPUTS:</p>
<ul><li>
<p>backup: string which was previously returned by frontend_backup</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String - “parsed result” of an MCollective reply</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>executes the &#39;frontend-backup&#39; action on the gear.</p>
</li><li>
<p>method on the FrontendHttpd class</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1353
1354
1355
1356</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1353</span>

<span class='kw'>def</span> <span class='id identifier rubyid_frontend_restore'>frontend_restore</span><span class='lparen'>(</span><span class='id identifier rubyid_backup'>backup</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>frontend-restore</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-backup</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_backup'>backup</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_active_capacity-instance_method">
  
    - (<tt>Object</tt>) <strong>get_active_capacity</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the “active capacity” of a node</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>Float: the “active capacity” of a node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


703
704
705</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 703</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_active_capacity'>get_active_capacity</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active_capacity</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_add_authorized_ssh_key_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_add_authorized_ssh_key_job</strong>(gear, ssh_key, key_type = nil, comment = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to add an authorized key</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>ssh_key: String - SSH public key string</p>
</li><li>
<p>key_type: String, Enum [dsa|rsa]</p>
</li><li>
<p>comment: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1416
1417
1418
1419
1420
1421
1422
1423</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1416</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_add_authorized_ssh_key_job'>get_add_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='comma'>,</span> <span class='id identifier rubyid_key_type'>key_type</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_comment'>comment</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-key-type</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_key_type'>key_type</span> <span class='kw'>if</span> <span class='id identifier rubyid_key_type'>key_type</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-key-comment</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_comment'>comment</span> <span class='kw'>if</span> <span class='id identifier rubyid_comment'>comment</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>authorized-ssh-key-add</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_app_status-instance_method">
  
    - (<tt>Object</tt>) <strong>get_app_status</strong>(app) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get the status of an application</p>

<p>INPUT: app: an Application object</p>

<p>RETURN:</p>
<ul><li>
<p>Array: [idle, leave_stopped, quota_file, quota_blocks]</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls get_cart_status</p>
</li><li>
<p>method on app or gear?</p>
</li><li>
<p>just a shortcut?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2063
2064
2065
2066
2067
2068
2069
2070
2071
2072
2073
2074
2075</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2063</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_app_status'>get_app_status</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_web_framework'>web_framework</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_requires'>requires</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_feature'>feature</span><span class='op'>|</span>
    <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='const'>CartridgeCache</span><span class='period'>.</span><span class='id identifier rubyid_find_cartridge'>find_cartridge</span><span class='lparen'>(</span><span class='id identifier rubyid_feature'>feature</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_categories'>categories</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>web_framework</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_web_framework'>web_framework</span> <span class='op'>=</span> <span class='id identifier rubyid_cart'>cart</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
    <span class='kw'>break</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_component_instances'>component_instances</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_get_components_for_feature'>get_components_for_feature</span><span class='lparen'>(</span><span class='id identifier rubyid_web_framework'>web_framework</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_gear'>gear</span> <span class='op'>=</span> <span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span><span class='period'>.</span><span class='id identifier rubyid_gears'>gears</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid_get_cart_status'>get_cart_status</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component_instances'>component_instances</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_available_cartridges-instance_method">
  
    - (<tt>Object</tt>) <strong>get_available_cartridges</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;class method&gt;&gt;</p>

<p>&lt;&lt;query&gt;&gt;</p>

<p>Query all nodes for all available cartridges</p>

<p>INPUTS:</p>
<ul><li>
<p>none</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>An array of OpenShift::Cartridge objects</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct and @@C_CONTROLLER</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185
186
187
188
189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 183</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_available_cartridges'>get_available_cartridges</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--porcelain</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-descriptors</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cartridge-list</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart_data'>cart_data</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_resultIO'>resultIO</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart_data'>cart_data</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Cartridge</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_from_descriptor'>from_descriptor</span><span class='lparen'>(</span><span class='const'>YAML</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_broker_auth_key_add_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_broker_auth_key_add_job</strong>(gear, iv, token) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to add a broker auth key</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>iv: ??</p>
</li><li>
<p>token: ??</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1481
1482
1483
1484
1485
1486
1487</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1481</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_broker_auth_key_add_job'>get_broker_auth_key_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_iv'>iv</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-iv</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_iv'>iv</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-token</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>broker-auth-key-add</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_broker_auth_key_remove_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_broker_auth_key_remove_job</strong>(gear) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to remove a broker auth key</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1501
1502
1503
1504
1505</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1501</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_broker_auth_key_remove_job'>get_broker_auth_key_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>broker-auth-key-remove</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_capacity-instance_method">
  
    - (<tt>Object</tt>) <strong>get_capacity</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the “capacity” of a node</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>Float: the “capacity” of a node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


686
687
688</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 686</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_capacity'>get_capacity</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>capacity</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_cart_status-instance_method">
  
    - (<tt>Object</tt>) <strong>get_cart_status</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get the status of a cartridge in a gear?</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart_name: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Array: [idle, leave_stopped, quota_file, quota_blocks]</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses do_with_retry</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2090
2091
2092
2093
2094
2095
2096
2097
2098
2099
2100
2101
2102
2103
2104
2105
2106
2107
2108
2109
2110
2111
2112
2113
2114
2115
2116
2117
2118
2119
2120
2121
2122
2123
2124
2125
2126
2127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2090</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_cart_status'>get_cart_status</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_source_container'>source_container</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span>
  <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_idle'>idle</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_quota_blocks'>quota_blocks</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_quota_files'>quota_files</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Getting existing app &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; status before moving</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_do_with_retry'>do_with_retry</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attributes</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status</span><span class='tstring_end'>&#39;</span></span>
        <span class='kw'>case</span> <span class='id identifier rubyid_value'>value</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALREADY_STOPPED</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ALREADY_IDLED</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='op'>=</span> <span class='kw'>true</span>
          <span class='id identifier rubyid_idle'>idle</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>end</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>quota_blocks</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_quota_blocks'>quota_blocks</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>quota_files</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_quota_files'>quota_files</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_cart_name'>cart_name</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_idle'>idle</span>
    <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Gear component &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart_name'>cart_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; was idle</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span>
    <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Gear component &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart_name'>cart_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; was stopped</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Gear component &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart_name'>cart_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; was running</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_idle'>idle</span><span class='comma'>,</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_files'>quota_files</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_conceal_port_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_conceal_port_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1206
1207
1208
1209
1210</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1206</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_conceal_port_job'>get_conceal_port_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>conceal-port</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_district_uuid-instance_method">
  
    - (<tt>Object</tt>) <strong>get_district_uuid</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the district UUID (membership handle) of a
node</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>String: the UUID of a node&#39;s district</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


720
721
722</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 720</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_district_uuid'>get_district_uuid</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>district_uuid</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_env_var_add_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_env_var_add_job</strong>(gear, key, value) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get status on an add env var job?</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>key: an environment variable name</p>
</li><li>
<p>value: and environment variable value</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1372
1373
1374
1375
1376
1377
1378</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1372</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_env_var_add_job'>get_env_var_add_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-value</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>env-var-add</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_env_var_remove_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_env_var_remove_job</strong>(gear, key) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to remove an environment variable</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>key: an environment variable name</p>
</li><li>
<p>value: and environment variable value</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1394
1395
1396
1397
1398
1399</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1394</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_env_var_remove_job'>get_env_var_remove_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>env-var-remove</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_execute_connector_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_execute_connector_job</strong>(gear, component, connector_name, connection_type, input_args, pub_cart = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to execute a connector hook ??</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li><li>
<p>connector_name: String</p>
</li><li>
<p>input_args: Array of String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1522
1523
1524
1525
1526
1527
1528
1529
1530
1531
1532
1533
1534
1535
1536
1537</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1522</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_execute_connector_job'>get_execute_connector_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_connector_name'>connector_name</span><span class='comma'>,</span> <span class='id identifier rubyid_connection_type'>connection_type</span><span class='comma'>,</span> <span class='id identifier rubyid_input_args'>input_args</span><span class='comma'>,</span> <span class='id identifier rubyid_pub_cart'>pub_cart</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--hook-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_connector_name'>connector_name</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--publishing-cart-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_pub_cart'>pub_cart</span> <span class='kw'>if</span> <span class='id identifier rubyid_pub_cart'>pub_cart</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--connection-type</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_connection_type'>connection_type</span>
  <span class='comment'># Need to pass down args as hash for subscriber ENV hooks only
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_connection_type'>connection_type</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ENV:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_pub_cart'>pub_cart</span>
    <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--input-args</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_input_args'>input_args</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--input-args</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_input_args'>input_args</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>connector-execute</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_expose_port_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_expose_port_job</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>expose a TCP port</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undetermined content</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls run_cartridge_command</p>
</li><li>
<p>executes &#39;expose-port&#39; action.</p>
</li><li>
<p>method on Gear or Cart?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1200
1201
1202
1203
1204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1200</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_expose_port_job'>get_expose_port_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>expose-port</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_fix_authorized_ssh_keys_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_fix_authorized_ssh_keys_job</strong>(gear, ssh_keys) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to remove existing authorized ssh keys and add the provided
ones to the gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>ssh_keys: Array - SSH public key list</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1460
1461
1462
1463
1464
1465</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1460</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_fix_authorized_ssh_keys_job'>get_fix_authorized_ssh_keys_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_keys'>ssh_keys</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-keys</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ssh_keys'>ssh_keys</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>key</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>comment</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>authorized-ssh-keys-replace</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_force_stop_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_force_stop_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1010
1011
1012
1013
1014</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1010</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_force_stop_job'>get_force_stop_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>force-stop</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_gear_envs-instance_method">
  
    - (<tt>Object</tt>) <strong>get_gear_envs</strong>(gear_uuid) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a hash of env variables for a given gear uuid</p>

<p>INPUTS:</p>
<ul><li>
<p>gear_uuid: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Hash</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses rpc_exec</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2257
2258
2259
2260
2261
2262
2263
2264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2257</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_gear_envs'>get_gear_envs</span><span class='lparen'>(</span><span class='id identifier rubyid_gear_uuid'>gear_uuid</span><span class='rparen'>)</span>
  <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_get_gear_envs'>get_gear_envs</span><span class='lparen'>(</span><span class='symbol'>:uuid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear_uuid'>gear_uuid</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_ip_address-instance_method">
  
    - (<tt>Object</tt>) <strong>get_ip_address</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the public IP address of a Node</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>String: the public IP address of a node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


737
738
739</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 737</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_ip_address'>get_ip_address</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ipaddress</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_node_details-instance_method">
  
    - (<tt>Object</tt>) <strong>get_node_details</strong>(name_list) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get details about instance&#39;s node</p>

<p>RETURN:</p>
<ul><li>
<p>Map: name =&gt; values for one node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls rpc_get_facts_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2138
2139
2140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2138</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_node_details'>get_node_details</span><span class='lparen'>(</span><span class='id identifier rubyid_name_list'>name_list</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_rpc_get_facts_direct'>rpc_get_facts_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_name_list'>name_list</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_node_profile-instance_method">
  
    - (<tt>Object</tt>) <strong>get_node_profile</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the “node profile” of a Node</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>String: the “node profile” of a node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


771
772
773</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 771</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_node_profile'>get_node_profile</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>node_profile</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_public_hostname-instance_method">
  
    - (<tt>Object</tt>) <strong>get_public_hostname</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the public hostname of a Node</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>String: the public hostname of a node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


669
670
671</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 669</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_public_hostname'>get_public_hostname</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>public_hostname</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_public_ip_address-instance_method">
  
    - (<tt>Object</tt>) <strong>get_public_ip_address</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the public IP address of a Node</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>String: the public IP address of a node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


754
755
756</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 754</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_public_ip_address'>get_public_ip_address</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>public_ip</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_quota-instance_method">
  
    - (<tt>Object</tt>) <strong>get_quota</strong>(gear) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;object method&gt;&gt;</p>

<p>&lt;&lt;attribute getter&gt;&gt;</p>

<p>Request the disk quotas from a Gear on a node</p>

<p>RETURNS:</p>
<ul><li>
<p>an array with following information:</p>
</li></ul>

<p>[Filesystem, blocks_used, blocks_soft_limit, blocks_hard_limit,
inodes_used, inodes_soft_limit, inodes_hard_limit]</p>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>Uses execute_direct</p>
</li><li>
<p>A method on the gear object</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_quota'>get_quota</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--uuid</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='id identifier rubyid_reply'>reply</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>get-quota</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_reply'>reply</span> <span class='kw'>and</span> <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_mcoll_result'>mcoll_result</span> <span class='op'>=</span> <span class='id identifier rubyid_reply'>reply</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_mcoll_result'>mcoll_result</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='kw'>defined?</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:exitcode</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to get quota for user: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (error getting result from node).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (error getting result from node).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_quota_blocks-instance_method">
  
    - (<tt>Object</tt>) <strong>get_quota_blocks</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the quota blocks of a Node</p>

<p>Is this disk available or the default quota limit? It&#39;s from Facter.</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>String: the “quota blocks” of a node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


791
792
793</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 791</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_quota_blocks'>get_quota_blocks</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>quota_blocks</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_quota_files-instance_method">
  
    - (<tt>Object</tt>) <strong>get_quota_files</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;accessor&gt;&gt; Get the quota files of a Node</p>

<p>Is this disk available or the default quota limit? It&#39;s from Facter.</p>

<p>INPUTS: none</p>

<p>RETURNS:</p>
<ul><li>
<p>String: the “quota files” of a node</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on Node</p>
</li><li>
<p>calls rpc_get_fact_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


811
812
813</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 811</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_quota_files'>get_quota_files</span>
  <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>quota_files</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_reload_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_reload_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1069
1070
1071
1072
1073</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1069</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_reload_job'>get_reload_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>reload</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_remove_authorized_ssh_key_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_remove_authorized_ssh_key_job</strong>(gear, ssh_key, comment = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to remove an authorized key.</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>ssh_key: String - SSH public key string</p>
</li><li>
<p>comment: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1439
1440
1441
1442
1443
1444
1445</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1439</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_remove_authorized_ssh_key_job'>get_remove_authorized_ssh_key_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='comma'>,</span> <span class='id identifier rubyid_comment'>comment</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-comment</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_comment'>comment</span> <span class='kw'>if</span> <span class='id identifier rubyid_comment'>comment</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>authorized-ssh-key-remove</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_restart_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_restart_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1039
1040
1041
1042
1043</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1039</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_restart_job'>get_restart_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>restart</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_show_gear_quota_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_show_gear_quota_job</strong>(gear) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to check the disk quota on a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1612
1613
1614
1615
1616
1617</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1612</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_show_gear_quota_job'>get_show_gear_quota_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--uuid</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>get-quota</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_show_port_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_show_port_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1212
1213
1214
1215
1216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_show_port_job'>get_show_port_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>show-port</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_show_state_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_show_state_job</strong>(gear) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to return the state of a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1574
1575
1576
1577
1578</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1574</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_show_state_job'>get_show_state_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>app-state-show</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_start_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_start_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


953
954
955
956
957</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 953</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_start_job'>get_start_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>start</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_status_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_status_job</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to get status of an application</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1594
1595
1596
1597
1598</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1594</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_status_job'>get_status_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_stop_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_stop_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


983
984
985
986
987</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 983</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_stop_job'>get_stop_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stop</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_threaddump_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_threaddump_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1151
1152
1153
1154
1155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1151</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_threaddump_job'>get_threaddump_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>threaddump</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_tidy_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_tidy_job</strong>(gear, component) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1119
1120
1121
1122
1123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1119</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_tidy_job'>get_tidy_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tidy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_unsubscribe_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_unsubscribe_job</strong>(gear, component, publish_cart_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to unsubscribe</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li><li>
<p>publish_cart_name: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1553
1554
1555
1556
1557
1558
1559
1560</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1553</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_unsubscribe_job'>get_unsubscribe_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_publish_cart_name'>publish_cart_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--publishing-cart-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_publish_cart_name'>publish_cart_name</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unsubscribe</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_update_gear_quota_job-instance_method">
  
    - (<tt>Object</tt>) <strong>get_update_gear_quota_job</strong>(gear, storage_in_gb, inodes) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a job to change the disk quotas on a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a RemoteJob object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses RemoteJob</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1631
1632
1633
1634
1635
1636
1637
1638
1639</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1631</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_update_gear_quota_job'>get_update_gear_quota_job</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_storage_in_gb'>storage_in_gb</span><span class='comma'>,</span> <span class='id identifier rubyid_inodes'>inodes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--uuid</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='comment'># quota command acts on 1K blocks
</span>  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--blocks</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Integer</span><span class='lparen'>(</span><span class='id identifier rubyid_storage_in_gb'>storage_in_gb</span> <span class='op'>*</span> <span class='int'>1024</span> <span class='op'>*</span> <span class='int'>1024</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--inodes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_inodes'>inodes</span> <span class='kw'>unless</span> <span class='id identifier rubyid_inodes'>inodes</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_job'>job</span> <span class='op'>=</span> <span class='const'>RemoteJob</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift-origin-node</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>set-quota</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_job'>job</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_app?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>has_app?</strong>(app_uuid, app_name)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether this server has the specified app</p>

<p>INPUTS:</p>
<ul><li>
<p>app_uuid: String</p>
</li><li>
<p>app_name: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Boolean</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses rpc_exec</p>
</li><li>
<p>loops over all nodes</p>
</li><li>
<p>No longer being used</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2608
2609
2610
2611
2612
2613
2614
2615
2616</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2608</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_app?'>has_app?</span><span class='lparen'>(</span><span class='id identifier rubyid_app_uuid'>app_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_app_name'>app_name</span><span class='rparen'>)</span>
  <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_has_app'>has_app</span><span class='lparen'>(</span><span class='symbol'>:uuid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_app_uuid'>app_uuid</span><span class='comma'>,</span>
                   <span class='symbol'>:application</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_app_name'>app_name</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span> <span class='op'>==</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_app_cartridge?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>has_app_cartridge?</strong>(app_uuid, gear_uuid, cart)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether this gear has the specified cartridge</p>

<p>INPUTS:</p>
<ul><li>
<p>gear_uuid: String</p>
</li><li>
<p>cartridge: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Boolean</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses rpc_exec</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2677
2678
2679
2680
2681
2682
2683
2684</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2677</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_app_cartridge?'>has_app_cartridge?</span><span class='lparen'>(</span><span class='id identifier rubyid_app_uuid'>app_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_gear_uuid'>gear_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span>
  <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_has_app_cartridge'>has_app_cartridge</span><span class='lparen'>(</span><span class='symbol'>:app_uuid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_app_uuid'>app_uuid</span><span class='comma'>,</span> <span class='symbol'>:gear_uuid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_gear_uuid'>gear_uuid</span><span class='comma'>,</span> <span class='symbol'>:cartridge</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span> <span class='op'>==</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_embedded_app?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>has_embedded_app?</strong>(app_uuid, embedded_type)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether this server has the specified embedded app</p>

<p>INPUTS:</p>
<ul><li>
<p>app_uuid: String</p>
</li><li>
<p>embedded_type: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Boolean</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses rpc_exec</p>
</li><li>
<p>No longer being used</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2632
2633
2634
2635
2636
2637
2638
2639
2640</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2632</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_embedded_app?'>has_embedded_app?</span><span class='lparen'>(</span><span class='id identifier rubyid_app_uuid'>app_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_embedded_type'>embedded_type</span><span class='rparen'>)</span>
  <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_has_embedded_app'>has_embedded_app</span><span class='lparen'>(</span><span class='symbol'>:uuid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_app_uuid'>app_uuid</span><span class='comma'>,</span>
                            <span class='symbol'>:embedded_type</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_embedded_type'>embedded_type</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span> <span class='op'>==</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_uid_or_gid?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>has_uid_or_gid?</strong>(uid)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether this server has already reserved the specified uid as a uid
or gid</p>

<p>INPUTS:</p>
<ul><li>
<p>uid: Integer</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Boolean</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses rpc_exec</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2654
2655
2656
2657
2658
2659
2660
2661
2662</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2654</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_uid_or_gid?'>has_uid_or_gid?</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_exec'>rpc_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_client'>client</span><span class='op'>|</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_has_uid_or_gid'>has_uid_or_gid</span><span class='lparen'>(</span><span class='symbol'>:uid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_uid'>uid</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_response'>response</span><span class='op'>|</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span> <span class='op'>==</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="log_debug-instance_method">
  
    - (<tt>Object</tt>) <strong>log_debug</strong>(message)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Wrap the log messages so it doesn&#39;t HAVE to be rails</p>

<p>INPUTS:</p>
<ul><li>
<p>message: String</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2453
2454
2455
2456</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2453</span>

<span class='kw'>def</span> <span class='id identifier rubyid_log_debug'>log_debug</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='id identifier rubyid_message'>message</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="log_error-instance_method">
  
    - (<tt>Object</tt>) <strong>log_error</strong>(message)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Wrap the log messages so it doesn&#39;t HAVE to be rails</p>

<p>INPUTS:</p>
<ul><li>
<p>message: String</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2464
2465
2466
2467</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2464</span>

<span class='kw'>def</span> <span class='id identifier rubyid_log_error'>log_error</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_message'>message</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_gear-instance_method">
  
    - (<tt>Object</tt>) <strong>move_gear</strong>(gear, destination_container, destination_district_uuid, change_district, node_profile) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1773
1774
1775
1776
1777
1778
1779
1780
1781
1782
1783
1784
1785
1786
1787
1788
1789
1790
1791
1792
1793
1794
1795
1796
1797
1798
1799
1800
1801
1802
1803
1804
1805
1806
1807
1808
1809
1810
1811
1812
1813
1814
1815
1816
1817
1818
1819
1820
1821
1822
1823
1824
1825
1826
1827
1828
1829
1830
1831
1832
1833
1834
1835
1836
1837
1838
1839
1840
1841
1842
1843
1844
1845
1846
1847
1848
1849
1850
1851
1852
1853
1854
1855
1856
1857
1858
1859
1860
1861
1862
1863
1864
1865
1866
1867
1868
1869
1870
1871
1872
1873
1874
1875
1876
1877
1878
1879
1880
1881
1882
1883
1884
1885
1886
1887
1888
1889
1890
1891
1892
1893
1894
1895
1896
1897
1898
1899
1900
1901
1902
1903</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1773</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_gear'>move_gear</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_change_district'>change_district</span><span class='comma'>,</span> <span class='id identifier rubyid_node_profile'>node_profile</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_reply'>reply</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_state_map'>state_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span><span class='period'>.</span><span class='id identifier rubyid_get_district_uuid'>get_district_uuid</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NONE</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Move gear *not* supported without districts.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># resolve destination_container according to district
</span>  <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_district_changed'>district_changed</span> <span class='op'>=</span> <span class='id identifier rubyid_resolve_destination'>resolve_destination</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_change_district'>change_district</span><span class='comma'>,</span> <span class='id identifier rubyid_node_profile'>node_profile</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_source_container'>source_container</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>==</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
    <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot move a gear within the same node. The source container and destination container are the same.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error moving app. Destination container same as source container.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_destination_node_profile'>destination_node_profile</span> <span class='op'>=</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_get_node_profile'>get_node_profile</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_get_node_profile'>get_node_profile</span> <span class='op'>!=</span> <span class='id identifier rubyid_destination_node_profile'>destination_node_profile</span> <span class='kw'>and</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_scalable'>scalable</span>
    <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot change node_profile for *scalable* application gear - this operation is not supported. The destination container&#39;s node profile is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_node_profile'>destination_node_profile</span><span class='embexpr_end'>}</span><span class='tstring_content'>, while the gear&#39;s node_profile is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error moving app.  Cannot change node profile for *scalable* app.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># get the state of all cartridges
</span>  <span class='id identifier rubyid_quota_blocks'>quota_blocks</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_quota_files'>quota_files</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_idle'>idle</span><span class='comma'>,</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_files'>quota_files</span> <span class='op'>=</span> <span class='id identifier rubyid_get_app_status'>get_app_status</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_gi'>gi</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span>
  <span class='id identifier rubyid_gi'>gi</span><span class='period'>.</span><span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cinst'>cinst</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_state_map'>state_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_idle'>idle</span><span class='comma'>,</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='comment'># pre-move
</span>    <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_move_gear_pre'>move_gear_pre</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_district_changed'>district_changed</span>
      <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_reserve_uid'>reserve_uid</span><span class='lparen'>(</span><span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Reserved uid &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; on district: &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='kw'>begin</span>
      <span class='comment'># rsync gear with destination container
</span>      <span class='id identifier rubyid_rsync_destination_container'>rsync_destination_container</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_files'>quota_files</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_start_order'>start_order</span><span class='comma'>,</span><span class='id identifier rubyid_stop_order'>stop_order</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_calculate_component_orders'>calculate_component_orders</span>
      <span class='id identifier rubyid_gi_comps'>gi_comps</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span><span class='period'>.</span><span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
      <span class='id identifier rubyid_start_order'>start_order</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cinst'>cinst</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_gi_comps'>gi_comps</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
        <span class='id identifier rubyid_idle'>idle</span><span class='comma'>,</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='op'>=</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_cart'>cart</span><span class='rbracket'>]</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_scalable'>scalable</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='const'>CartridgeCache</span><span class='period'>.</span><span class='id identifier rubyid_find_cartridge'>find_cartridge</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_categories'>categories</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>web_proxy</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>begin</span>
            <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_expose_port'>expose_port</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='rparen'>)</span>
          <span class='kw'>rescue</span> <span class='const'>Exception</span><span class='op'>=&gt;</span><span class='id identifier rubyid_e'>e</span>
            <span class='comment'># just pass because some embedded cartridges do not have expose-port hook implemented (e.g. jenkins-client)
</span>          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='comment'># start the gears again and change DNS entry
</span>      <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_move_gear_post'>move_gear_post</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='rparen'>)</span>
      <span class='comment'># app.elaborate_descriptor
</span>      <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_execute_connections'>execute_connections</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_scalable'>scalable</span>
        <span class='comment'># execute connections restart the haproxy service, so stop it explicitly if needed
</span>        <span class='id identifier rubyid_stop_order'>stop_order</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cinst'>cinst</span><span class='op'>|</span>
          <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_gi_comps'>gi_comps</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span>
          <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
          <span class='id identifier rubyid_idle'>idle</span><span class='comma'>,</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='op'>=</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_cart'>cart</span><span class='rbracket'>]</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='kw'>and</span> <span class='const'>CartridgeCache</span><span class='period'>.</span><span class='id identifier rubyid_find_cartridge'>find_cartridge</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_categories'>categories</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>web_proxy</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Explicitly stopping cartridge &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; after move on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='rparen'>)</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>

    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_server_identity'>server_identity</span> <span class='op'>=</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
      <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span> <span class='op'>=</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_get_node_profile'>get_node_profile</span>
      <span class='comment'># remove-httpd-proxy of destination
</span>      <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Moving failed.  Rolling back gear &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; with remove-httpd-proxy on &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_gi'>gi</span><span class='period'>.</span><span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cinst'>cinst</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_framework_carts'>framework_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cart'>cart</span>
          <span class='kw'>begin</span>
            <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_cinst'>cinst</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:run_cartridge_command</span><span class='comma'>,</span> <span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>remove-httpd-proxy</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>
          <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
            <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Remove httpd proxy with cart &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; failed on &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;  - gear: &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, app: &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='comment'># destroy destination
</span>      <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Moving failed.  Rolling back gear &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; with delete on &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='op'>!</span><span class='id identifier rubyid_district_changed'>district_changed</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_gi_comps'>gi_comps</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span><span class='period'>.</span><span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
      <span class='id identifier rubyid_start_order'>start_order</span><span class='comma'>,</span><span class='id identifier rubyid_stop_order'>stop_order</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_calculate_component_orders'>calculate_component_orders</span>
      <span class='comment'># start source
</span>      <span class='id identifier rubyid_start_order'>start_order</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cinst'>cinst</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_gi_comps'>gi_comps</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
        <span class='id identifier rubyid_idle'>idle</span><span class='comma'>,</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='op'>=</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_cart'>cart</span><span class='rbracket'>]</span>
        <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span>
          <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_cinst'>cinst</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>start</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_raise'>raise</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_move_gear_destroy_old'>move_gear_destroy_old</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_district_changed'>district_changed</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Successfully moved gear with uuid &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; of app &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; from &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_reply'>reply</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_gear_destroy_old-instance_method">
  
    - (<tt>Object</tt>) <strong>move_gear_destroy_old</strong>(gear, source_container, destination_container, district_changed) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove and destroy a old gear after migration</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>source_container: ??</p>
</li><li>
<p>destination_container ??</p>
</li><li>
<p>district_changed: boolean</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO object</p>
</li></ul>

<p>CATCHES:</p>
<ul><li>
<p>Exception</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses source_container.destroy</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1923
1924
1925
1926
1927
1928
1929
1930
1931
1932
1933
1934</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1923</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_gear_destroy_old'>move_gear_destroy_old</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_district_changed'>district_changed</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_reply'>reply</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Deconfiguring old app &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> after move</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='op'>!</span><span class='id identifier rubyid_district_changed'>district_changed</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: The application &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; with gear uuid &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; is now moved to &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; but not completely deconfigured from &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_reply'>reply</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_gear_post-instance_method">
  
    - (<tt>Object</tt>) <strong>move_gear_post</strong>(gear, destination_container, state_map) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Re-start a gear after migration</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>destination_container: an ApplicationContainerProxy object?</p>
</li><li>
<p>state_map: ??</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses OpenShift::DnsService</p>
</li></ul>

<p>*</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1657
1658
1659
1660
1661
1662
1663
1664
1665
1666
1667
1668
1669
1670
1671
1672
1673
1674
1675
1676
1677
1678
1679
1680
1681
1682
1683
1684
1685
1686
1687
1688
1689
1690</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1657</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_gear_post'>move_gear_post</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_reply'>reply</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_gi'>gi</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span>
  <span class='id identifier rubyid_gear_components'>gear_components</span> <span class='op'>=</span> <span class='id identifier rubyid_gi'>gi</span><span class='period'>.</span><span class='id identifier rubyid_all_component_instances'>all_component_instances</span>
  <span class='id identifier rubyid_start_order'>start_order</span><span class='comma'>,</span> <span class='id identifier rubyid_stop_order'>stop_order</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_calculate_component_orders'>calculate_component_orders</span>
  <span class='id identifier rubyid_source_container'>source_container</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span>
  <span class='id identifier rubyid_start_order'>start_order</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cinst'>cinst</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_gear_components'>gear_components</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
    <span class='id identifier rubyid_idle'>idle</span><span class='comma'>,</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='op'>=</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_cart'>cart</span><span class='rbracket'>]</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span>
      <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Starting cartridge &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; after move on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_cinst'>cinst</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:run_cartridge_command</span><span class='comma'>,</span> <span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>start</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Fixing DNS and mongo for gear &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; after move</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Changing server identity of &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; from &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_server_identity'>server_identity</span> <span class='op'>=</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span> <span class='op'>=</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_get_node_profile'>get_node_profile</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_dns'>dns</span> <span class='op'>=</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>DnsService</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span>
    <span class='id identifier rubyid_public_hostname'>public_hostname</span> <span class='op'>=</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_get_public_hostname'>get_public_hostname</span>
    <span class='id identifier rubyid_dns'>dns</span><span class='period'>.</span><span class='id identifier rubyid_modify_application'>modify_application</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_domain'>domain</span><span class='period'>.</span><span class='id identifier rubyid_namespace'>namespace</span><span class='comma'>,</span> <span class='id identifier rubyid_public_hostname'>public_hostname</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_dns'>dns</span><span class='period'>.</span><span class='id identifier rubyid_publish'>publish</span>
  <span class='kw'>ensure</span>
    <span class='id identifier rubyid_dns'>dns</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_reply'>reply</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_gear_pre-instance_method">
  
    - (<tt>Object</tt>) <strong>move_gear_pre</strong>(gear, state_map) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Prepare to move a gear from one node to another</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: A Gear object</p>
</li><li>
<p>state_map: ??</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO object</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses ResultIO</p>
</li><li>
<p>ResultIO is <strong>composed</strong></p>
</li><li>
<p>uses Container (from gear)</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1707
1708
1709
1710
1711
1712
1713
1714
1715
1716
1717
1718
1719
1720
1721
1722
1723
1724
1725
1726
1727
1728
1729
1730
1731
1732
1733
1734
1735
1736
1737
1738
1739
1740</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1707</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_gear_pre'>move_gear_pre</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_reply'>reply</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_source_container'>source_container</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span>
  <span class='id identifier rubyid_gi_comps'>gi_comps</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span><span class='period'>.</span><span class='id identifier rubyid_all_component_instances'>all_component_instances</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>
  <span class='id identifier rubyid_start_order'>start_order</span><span class='comma'>,</span><span class='id identifier rubyid_stop_order'>stop_order</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_calculate_component_orders'>calculate_component_orders</span>
  <span class='id identifier rubyid_stop_order'>stop_order</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_cinst'>cinst</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_gi_comps'>gi_comps</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_is_sparse?'>is_sparse?</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_sparse_carts'>sparse_carts</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_host_singletons'>host_singletons</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
    <span class='id identifier rubyid_idle'>idle</span><span class='comma'>,</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span> <span class='op'>=</span> <span class='id identifier rubyid_state_map'>state_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_cart'>cart</span><span class='rbracket'>]</span>
    <span class='comment'># stop the cartridge if it needs to
</span>    <span class='kw'>unless</span> <span class='id identifier rubyid_leave_stopped'>leave_stopped</span>
      <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Stopping existing app cartridge &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; before moving</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>begin</span>
        <span class='id identifier rubyid_do_with_retry'>do_with_retry</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>stop</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
          <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>rescue</span> <span class='const'>Exception</span><span class='op'>=&gt;</span><span class='id identifier rubyid_e'>e</span>
        <span class='comment'># a force-stop will be applied if its a framework cartridge, so ignore the failure on stop
</span>        <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_framework_carts'>framework_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cart'>cart</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_framework_carts'>framework_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_cart'>cart</span>
        <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Force stopping existing app cartridge &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; before moving</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_do_with_retry'>do_with_retry</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>force-stop</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
          <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_force_stop'>force_stop</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_cinst'>cinst</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_reply'>reply</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_gear_secure-instance_method">
  
    - (<tt>Object</tt>) <strong>move_gear_secure</strong>(gear, destination_container, destination_district_uuid, change_district, node_profile) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Move a gear from one node to another</p>

<p>INPUTS</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>destination_container: An ApplicationContainerProxy?</p>
</li><li>
<p>destination_district_uuid: String</p>
</li><li>
<p>change_district: Boolean</p>
</li><li>
<p>node_profile: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::UserException</p>
</li></ul>

<p>CATCHES:</p>
<ul><li>
<p>Exception</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses resolve_destination</p>
</li><li>
<p>uses rsync_destination_container</p>
</li><li>
<p>uses move_gear_destroy_old</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1766
1767
1768
1769
1770
1771</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1766</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_gear_secure'>move_gear_secure</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_change_district'>change_district</span><span class='comma'>,</span> <span class='id identifier rubyid_node_profile'>node_profile</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='const'>Application</span><span class='period'>.</span><span class='id identifier rubyid_run_in_application_lock'>run_in_application_lock</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_move_gear'>move_gear</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_change_district'>change_district</span><span class='comma'>,</span> <span class='id identifier rubyid_node_profile'>node_profile</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_result-instance_method">
  
    - (<tt>Object</tt>) <strong>parse_result</strong>(mcoll_reply, gear = nil, command = nil)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Cull wanted information out of an MCollective::Reply object INPUTS:</p>
<ul><li>
<p>mcoll_reply: MCollective::RPC::Reply</p>
</li><li>
<p>gear: A Gear object</p>
</li><li>
<p>command: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Object: (Sanitized Result)</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::InvalidNodeException</p>
</li><li>
<p>OpenShift::NodeException</p>
</li><li>
<p>OpenShift::UserException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses find_app</p>
</li><li>
<p>uses sanitize_result</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2531
2532
2533
2534
2535
2536
2537
2538
2539
2540
2541
2542
2543
2544
2545
2546
2547
2548
2549
2550
2551
2552
2553
2554
2555
2556
2557
2558
2559
2560
2561
2562
2563</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2531</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span> <span class='kw'>unless</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_mcoll_result'>mcoll_result</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_reply'>mcoll_reply</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_mcoll_result'>mcoll_result</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='kw'>defined?</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:exitcode</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_server_identity'>server_identity</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span> <span class='op'>?</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_find_app'>find_app</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='kw'>nil</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_server_identity'>server_identity</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@id</span> <span class='op'>!=</span> <span class='id identifier rubyid_server_identity'>server_identity</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>InvalidNodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (invalid  node).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_server_identity'>server_identity</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (error getting result from node).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_gear_id'>gear_id</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_parse_output'>parse_output</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_gear_id'>gear_id</span><span class='rparen'>)</span>

  <span class='comment'># raise an exception in case of non-zero exit code from the node
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_debugIO'>debugIO</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Command return code: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_hasUserActionableError'>hasUserActionableError</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_errorIO'>errorIO</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exitcode'>exitcode</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (invalid exit code from node).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="post_configure_component-instance_method">
  
    - (<tt>Object</tt>) <strong>post_configure_component</strong>(gear, component, template_git_url = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Post configuration for a cartridge on a gear.</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>component: component_instance object</p>
</li><li>
<p>template_git_url: a url of a git repo containing a cart overlay</p>
</li></ul>

<p>RETURNS ResultIO: the result of running post-configure on the cartridge</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 872</span>

<span class='kw'>def</span> <span class='id identifier rubyid_post_configure_component'>post_configure_component</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_template_git_url'>template_git_url</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_cart_data'>cart_data</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>

  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_template_git_url'>template_git_url</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>  <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_template_git_url'>template_git_url</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-template-git-url</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_template_git_url'>template_git_url</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_framework_carts'>framework_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span> <span class='kw'>or</span> <span class='id identifier rubyid_embedded_carts'>embedded_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_result_io'>result_io</span> <span class='op'>=</span> <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>post-configure</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='comment'>#no-op
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_component_details'>component_details</span> <span class='op'>=</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_appInfoIO'>appInfoIO</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_appInfoIO'>appInfoIO</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span>
  <span class='id identifier rubyid_result_io'>result_io</span><span class='period'>.</span><span class='id identifier rubyid_debugIO'>debugIO</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_component_details'>component_details</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_component_details'>component_details</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_result_io'>result_io</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reload-instance_method">
  
    - (<tt>Object</tt>) <strong>reload</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>“reload” cart services on a gear. Accept config update without restarting?</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undefined content</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses run_cartridge_command</p>
</li><li>
<p>uses restart_component</p>
</li><li>
<p>method on Gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1061
1062
1063
1064
1065
1066
1067</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1061</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reload'>reload</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_run_cartridge_command_ignore_components'>run_cartridge_command_ignore_components</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reload</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reload_component-instance_method">
  
    - (<tt>Object</tt>) <strong>reload_component</strong>(gear, component)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reload a component service</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>component: String: a component name</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO?</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>method on gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2418
2419
2420
2421
2422
2423
2424</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2418</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reload_component'>reload_component</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>

  <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reload</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_alias-instance_method">
  
    - (<tt>Object</tt>) <strong>remove_alias</strong>(gear, server_alias) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>remove an application alias to a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>server_alias: String - a new FQDN for the gear</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String: stdout from a command</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls execute_direct</p>
</li><li>
<p>executes the &#39;remove-alias&#39; action on the gear.</p>
</li><li>
<p>method on Gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1305
1306
1307
1308
1309
1310</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1305</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_alias'>remove_alias</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_server_alias'>server_alias</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-alias-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='op'>=</span><span class='id identifier rubyid_server_alias'>server_alias</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>remove-alias</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_authorized_ssh_key-instance_method">
  
    - (<tt>Object</tt>) <strong>remove_authorized_ssh_key</strong>(gear, ssh_key, comment = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>remove an ssh key from a gear on a remote node. See
node/bin/oo-authorized-ssh-key-remove</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>ssh_key: String - an SSH RSA or DSA public key string</p>
</li><li>
<p>comment: String - identify the key</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>MCollective result string: STDOUT from a command.</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>calls oo-authorized-ssh-key-remove on the node</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


536
537
538
539
540
541
542</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 536</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_authorized_ssh_key'>remove_authorized_ssh_key</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span><span class='comma'>,</span> <span class='id identifier rubyid_comment'>comment</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ssh_key'>ssh_key</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-ssh-comment</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_comment'>comment</span> <span class='kw'>if</span> <span class='id identifier rubyid_comment'>comment</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>authorized-ssh-key-remove</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_broker_auth_key-instance_method">
  
    - (<tt>Object</tt>) <strong>remove_broker_auth_key</strong>(gear) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove a broker auth key. The broker auth key allows an application to
request scaling and other actions from the broker.</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>mcollective parsed result string (stdout)</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>calls oo-broker-auth-key-remove</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


629
630
631
632
633</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 629</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_broker_auth_key'>remove_broker_auth_key</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>broker-auth-key-remove</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_component-instance_method">
  
    - (<tt>Object</tt>) <strong>remove_component</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove a component from a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>component: String: a component name</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO? String?</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>method on gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 909</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_component'>remove_component</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>

  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Deconfiguring cartridge &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; in application &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; on node &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>=</span> <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>deconfigure</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_has_app_cartridge?'>has_app_cartridge?</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span>
    <span class='kw'>else</span>
      <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Cartridge &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cart'>cart</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; not found on within application &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;.  Continuing with deconfigure.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_resultIO'>resultIO</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_env_var-instance_method">
  
    - (<tt>Object</tt>) <strong>remove_env_var</strong>(gear, key) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove an environment variable on gear on a remote node</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>key: String - environment variable name</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>MCollective result string: STDOUT from a command.</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>calls oo-env-var-remove on the node</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


584
585
586
587
588
589</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 584</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_env_var'>remove_env_var</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>env-var-remove</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_ssl_cert-instance_method">
  
    - (<tt>Object</tt>) <strong>remove_ssl_cert</strong>(gear, server_alias) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>remove an SSL certificate to a gear on the remote node. See
node/bin/oo-ssl-cert-remove</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>server_alias: String - the name of the server which will offer this key</p>
</li></ul>

<p>RETURNS: a parsed MCollective result</p>

<p>NOTES:</p>
<ul><li>
<p>calls node script oo-ssl-cert-remove</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


487
488
489
490
491
492</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 487</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_ssl_cert'>remove_ssl_cert</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_server_alias'>server_alias</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--with-alias-name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>     <span class='op'>=</span> <span class='id identifier rubyid_server_alias'>server_alias</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ssl-cert-remove</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reserve_uid-instance_method">
  
    - (<tt>Object</tt>) <strong>reserve_uid</strong>(district_uuid = nil, preferred_uid = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reserve a UID within a district or service</p>

<p>UIDs must be unique in a district to allow migration without requiring
reassigning Username (Gear UUID) and Unix User UID on migrate Perhaps a
query on the nodes for “next UID”?</p>

<p>INPUTS:</p>
<ul><li>
<p>district_uuid: String: District handle or identifier</p>
</li><li>
<p>preferred_uid: Integer</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::OOException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>a method on District class of the node.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


295
296
297
298
299
300
301
302
303
304
305
306
307
308
309</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 295</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reserve_uid'>reserve_uid</span><span class='lparen'>(</span><span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_preferred_uid'>preferred_uid</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reserved_uid'>reserved_uid</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_msg_broker'>msg_broker</span><span class='lbracket'>[</span><span class='symbol'>:districts</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:enabled</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='ivar'>@district</span>
      <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>=</span> <span class='ivar'>@district</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>=</span> <span class='id identifier rubyid_get_district_uuid'>get_district_uuid</span> <span class='kw'>unless</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NONE</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_reserved_uid'>reserved_uid</span> <span class='op'>=</span> <span class='const'>District</span><span class='op'>::</span><span class='id identifier rubyid_reserve_uid'>reserve_uid</span><span class='lparen'>(</span><span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_preferred_uid'>preferred_uid</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>OOException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>uid could not be reserved in target district &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;.  Please ensure the target district has available capacity.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_reserved_uid'>reserved_uid</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_reserved_uid'>reserved_uid</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolve_destination-instance_method">
  
    - (<tt>Object</tt>) <strong>resolve_destination</strong>(gear, destination_container, destination_district_uuid, change_district, node_profile) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>destination_container: ??</p>
</li><li>
<p>destination_district_uuid: String</p>
</li><li>
<p>change_district: Boolean</p>
</li><li>
<p>node_profile: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Array: [destination_container, destination_district_uuid, district_changed]</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::UserException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses MCollectiveApplicationContainerProxy.find_available_impl</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1954
1955
1956
1957
1958
1959
1960
1961
1962
1963
1964
1965
1966
1967
1968
1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1954</span>

<span class='kw'>def</span> <span class='id identifier rubyid_resolve_destination'>resolve_destination</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_change_district'>change_district</span><span class='comma'>,</span> <span class='id identifier rubyid_node_profile'>node_profile</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_required_uid'>required_uid</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span>
  <span class='id identifier rubyid_source_container'>source_container</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span>
  <span class='id identifier rubyid_source_district_uuid'>source_district_uuid</span> <span class='op'>=</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_get_district_uuid'>get_district_uuid</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_node_profile'>node_profile</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_destination_container'>destination_container</span> <span class='kw'>or</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span> <span class='kw'>or</span> <span class='op'>!</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_msg_broker'>msg_broker</span><span class='lbracket'>[</span><span class='symbol'>:node_profile_enabled</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Option node_profile &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_node_profile'>node_profile</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; is being ignored either in favor of destination district/container </span><span class='tstring_end'>&quot;</span></span>\
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>or node_profile is disabled in msg broker configuration.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_node_profile'>node_profile</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span> <span class='kw'>and</span> <span class='op'>!</span><span class='id identifier rubyid_change_district'>change_district</span>
      <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span> <span class='op'>=</span> <span class='id identifier rubyid_source_district_uuid'>source_district_uuid</span> <span class='kw'>unless</span> <span class='id identifier rubyid_source_district_uuid'>source_district_uuid</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NONE</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>

    <span class='comment'># Check to see if the gear&#39;s current district and the destination district are the same
</span>    <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>not</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span> <span class='op'>==</span> <span class='id identifier rubyid_source_district_uuid'>source_district_uuid</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_required_uid'>required_uid</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_least_preferred_server_identities'>least_preferred_server_identities</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_destination_gear_size'>destination_gear_size</span> <span class='op'>=</span> <span class='id identifier rubyid_node_profile'>node_profile</span> <span class='op'>||</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_group_instance'>group_instance</span><span class='period'>.</span><span class='id identifier rubyid_gear_size'>gear_size</span>
    <span class='id identifier rubyid_destination_container'>destination_container</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_find_available_impl'>find_available_impl</span><span class='lparen'>(</span><span class='id identifier rubyid_destination_gear_size'>destination_gear_size</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_gear_exists_in_district'>gear_exists_in_district</span><span class='comma'>,</span> <span class='id identifier rubyid_required_uid'>required_uid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Destination container: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span> <span class='op'>=</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_get_district_uuid'>get_district_uuid</span>
  <span class='kw'>else</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span>
      <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Destination district uuid &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; is being ignored in favor of destination container </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span> <span class='op'>=</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_get_district_uuid'>get_district_uuid</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Source district uuid: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_district_uuid'>source_district_uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Destination district uuid: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_district_changed'>district_changed</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span> <span class='op'>!=</span> <span class='id identifier rubyid_source_district_uuid'>source_district_uuid</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>==</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>UserException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error moving gear.  Old and new servers are the same: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_district_changed'>district_changed</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="restart-instance_method">
  
    - (<tt>Object</tt>) <strong>restart</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Stop and restart cart services on a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undefined content</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses run_cartridge_command</p>
</li><li>
<p>uses restart_component</p>
</li><li>
<p>method on Gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1031
1032
1033
1034
1035
1036
1037</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1031</span>

<span class='kw'>def</span> <span class='id identifier rubyid_restart'>restart</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_run_cartridge_command_ignore_components'>run_cartridge_command_ignore_components</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>restart</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="restart_component-instance_method">
  
    - (<tt>Object</tt>) <strong>restart_component</strong>(gear, component)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Restart a component service</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>component: String: a component name</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO?</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>method on gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2397
2398
2399
2400
2401
2402
2403</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2397</span>

<span class='kw'>def</span> <span class='id identifier rubyid_restart_component'>restart_component</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>

  <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>restart</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rpc_get_fact_direct-instance_method">
  
    - (<tt>Object</tt>) <strong>rpc_get_fact_direct</strong>(fact)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given a known fact and node, get a single fact directly. This is
significantly faster then the get_facts method If multiple nodes of the
same name exist, it will pick just one</p>

<p>INPUTS:</p>
<ul><li>
<p>fact: String</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>uses MCollectiveApplicationContainerProxy.rpc_options</p>
</li><li>
<p>uses MCollective::RPC::Client</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3079
3080
3081
3082
3083
3084
3085
3086
3087
3088
3089
3090
3091
3092
3093
3094
3095</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3079</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rpc_get_fact_direct'>rpc_get_fact_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_fact'>fact</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_options'>rpc_options</span>

    <span class='id identifier rubyid_rpc_client'>rpc_client</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_get_rpc_client'>get_rpc_client</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rpcutil</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_custom_request'>custom_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>get_fact</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='symbol'>:fact</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_fact'>fact</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@id</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span> <span class='op'>&amp;&amp;</span> <span class='kw'>defined?</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:data</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (error getting fact).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_disconnect'>disconnect</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rpc_get_facts_direct-instance_method">
  
    - (<tt>Object</tt>) <strong>rpc_get_facts_direct</strong>(facts)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given a list of facts, get the facts directly for instance&#39;s node. This
is significantly faster then the get_facts method. If multiple nodes of the
same name exist, it will pick just one.</p>

<p>INPUTS:</p>
<ul><li>
<p>facts: Enumerable of Strings (fact names)</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Map of fact name to fact value for this instance&#39;s node</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>uses MCollectiveApplicationContainerProxy.rpc_options</p>
</li><li>
<p>uses MCollective::RPC::Client</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3115
3116
3117
3118
3119
3120
3121
3122
3123
3124
3125
3126
3127
3128
3129
3130
3131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3115</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rpc_get_facts_direct'>rpc_get_facts_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_facts'>facts</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_options'>rpc_options</span>

    <span class='id identifier rubyid_rpc_client'>rpc_client</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_get_rpc_client'>get_rpc_client</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_custom_request'>custom_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>get_facts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='symbol'>:facts</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_facts'>facts</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@id</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span> <span class='op'>&amp;&amp;</span> <span class='kw'>defined?</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:data</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (error getting facts).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_disconnect'>disconnect</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rsuccess-instance_method">
  
    - (<tt>Object</tt>) <strong>rsuccess</strong>(response)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>true if the response indicates success</p>

<p>INPUTS:</p>
<ul><li>
<p>response</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>Boolean</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on custom response object?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3019
3020
3021</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 3019</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rsuccess'>rsuccess</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:statuscode</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>==</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rsync_destination_container-instance_method">
  
    - (<tt>Object</tt>) <strong>rsync_destination_container</strong>(gear, destination_container, destination_district_uuid, quota_blocks, quota_files) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>copy the file contents of a gear on this node to a new gear on another</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>destination_container: an ApplicationContainerProxxy object</p>
</li><li>
<p>destination_district_uuid: String: a UUID handle</p>
</li><li>
<p>quota_blocks: Integer</p>
</li><li>
<p>quota_files: Integer</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses broker configuration rsync_keyfile</p>
</li><li>
<p>uses ssh-agent</p>
</li><li>
<p>uses ssh-add</p>
</li><li>
<p>uses rsync</p>
</li><li>
<p>runs all three commands in a single backtick eval</p>
</li><li>
<p>writes the eval output to log_debug</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2023
2024
2025
2026
2027
2028
2029
2030
2031
2032
2033
2034
2035
2036
2037
2038
2039
2040
2041
2042
2043
2044
2045
2046
2047</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2023</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rsync_destination_container'>rsync_destination_container</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='comma'>,</span> <span class='id identifier rubyid_destination_district_uuid'>destination_district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_files'>quota_files</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_reply'>reply</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_source_container'>source_container</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_get_proxy'>get_proxy</span>
  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Creating new account for gear &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_blocks'>quota_blocks</span><span class='comma'>,</span> <span class='id identifier rubyid_quota_files'>quota_files</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Moving content for app &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, gear &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_rsync_keyfile'>rsync_keyfile</span> <span class='op'>=</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_auth'>auth</span><span class='lbracket'>[</span><span class='symbol'>:rsync_keyfile</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='backtick'>`</span><span class='tstring_content'>eval \`ssh-agent\`; ssh-add </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rsync_keyfile'>rsync_keyfile</span><span class='embexpr_end'>}</span><span class='tstring_content'>; ssh -o StrictHostKeyChecking=no -A root@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_get_ip_address'>get_ip_address</span><span class='embexpr_end'>}</span><span class='tstring_content'> &quot;rsync -aAX -e &#39;ssh -o StrictHostKeyChecking=no&#39; /var/lib/openshift/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>/ root@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_get_ip_address'>get_ip_address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:/var/lib/openshift/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>/&quot;; ssh-agent -k</span><span class='tstring_end'>`</span></span>
  <span class='kw'>if</span> <span class='gvar'>$?</span><span class='period'>.</span><span class='id identifier rubyid_exitstatus'>exitstatus</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error moving app &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, gear &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Moving system components for app &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, gear &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_log_debug'>log_debug</span> <span class='backtick'>`</span><span class='tstring_content'>eval \`ssh-agent\`; ssh-add </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rsync_keyfile'>rsync_keyfile</span><span class='embexpr_end'>}</span><span class='tstring_content'>; ssh -o StrictHostKeyChecking=no -A root@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_get_ip_address'>get_ip_address</span><span class='embexpr_end'>}</span><span class='tstring_content'> &quot;rsync -aAX -e &#39;ssh -o StrictHostKeyChecking=no&#39; --include &#39;.httpd.d/&#39; --include &#39;.httpd.d/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>_***&#39; --include &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_domain'>domain</span><span class='period'>.</span><span class='id identifier rubyid_namespace'>namespace</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; --include &#39;.last_access/&#39; --include &#39;.last_access/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; --exclude &#39;*&#39; /var/lib/openshift/ root@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_get_ip_address'>get_ip_address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:/var/lib/openshift/&quot;; exit_code=$?; ssh-agent -k; exit $exit_code</span><span class='tstring_end'>`</span></span>
  <span class='kw'>if</span> <span class='gvar'>$?</span><span class='period'>.</span><span class='id identifier rubyid_exitstatus'>exitstatus</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error moving system components for app &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;, gear &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Transfer the front-end configuration to the new gear
</span>  <span class='id identifier rubyid_backup'>backup</span> <span class='op'>=</span> <span class='id identifier rubyid_source_container'>source_container</span><span class='period'>.</span><span class='id identifier rubyid_frontend_backup'>frontend_backup</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_destination_container'>destination_container</span><span class='period'>.</span><span class='id identifier rubyid_frontend_restore'>frontend_restore</span><span class='lparen'>(</span><span class='id identifier rubyid_backup'>backup</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reply'>reply</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run_cartridge_command-instance_method">
  
    - (<tt>Object</tt>) <strong>run_cartridge_command</strong>(framework, gear, command, arguments, allow_move = true)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Execute a cartridge hook command in a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>framework:</p>
</li><li>
<p>gear: a Gear object</p>
</li><li>
<p>command: the hook command to run on the node?</p>
</li><li>
<p>arg: ??</p>
</li><li>
<p>allow_move: Boolean</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>Exception</p>
</li></ul>

<p>CATCHES:</p>
<ul><li>
<p>OpenShift::InvalidNodeException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2722
2723
2724
2725
2726
2727
2728
2729
2730
2731
2732
2733
2734
2735
2736
2737
2738
2739
2740
2741
2742
2743
2744
2745
2746
2747
2748
2749
2750</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2722</span>

<span class='kw'>def</span> <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_framework'>framework</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_allow_move'>allow_move</span><span class='op'>=</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span>
  <span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_framework'>framework</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='id identifier rubyid_arguments'>arguments</span><span class='rparen'>)</span>

  <span class='kw'>begin</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>InvalidNodeException</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_command'>command</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>configure</span><span class='tstring_end'>&#39;</span></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_allow_move'>allow_move</span>
        <span class='ivar'>@id</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_server_identity'>server_identity</span>
        <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: Changing server identity of &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; from &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_server_identity'>server_identity</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; to &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_dns_service'>dns_service</span> <span class='op'>=</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>DnsService</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span>
        <span class='id identifier rubyid_dns_service'>dns_service</span><span class='period'>.</span><span class='id identifier rubyid_modify_application'>modify_application</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_domain'>domain</span><span class='period'>.</span><span class='id identifier rubyid_namespace'>namespace</span><span class='comma'>,</span> <span class='id identifier rubyid_get_public_hostname'>get_public_hostname</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_dns_service'>dns_service</span><span class='period'>.</span><span class='id identifier rubyid_publish'>publish</span>
        <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_server_identity'>server_identity</span> <span class='op'>=</span> <span class='ivar'>@id</span>
        <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
        <span class='comment'>#retry
</span>        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_framework'>framework</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='id identifier rubyid_arguments'>arguments</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_resultIO'>resultIO</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_resultIO'>resultIO</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run_cartridge_command_ignore_components-instance_method">
  
    - (<tt>Object</tt>) <strong>run_cartridge_command_ignore_components</strong>(cart, gear, command, arguments, allow_move = true)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method wraps run_cartridge_command to acknowledge and consistently
support the behavior until cartridges and components are handled as
distinct concepts within the runtime.</p>

<p>If the cart specified is in the framework_carts or embedded_carts list, the
arguments will pass through to run_cartridge_command. Otherwise, a new
ResultIO will be returned.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2691
2692
2693
2694
2695
2696
2697
2698</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2691</span>

<span class='kw'>def</span> <span class='id identifier rubyid_run_cartridge_command_ignore_components'>run_cartridge_command_ignore_components</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_allow_move'>allow_move</span><span class='op'>=</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_framework_carts'>framework_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_embedded_carts'>embedded_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_allow_move'>allow_move</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_district-instance_method">
  
    - (<tt>Object</tt>) <strong>set_district</strong>(uuid, active) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set the district of a node</p>

<p>INPUTS:</p>
<ul><li>
<p>uuid: String</p>
</li><li>
<p>active: String (?)</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO?</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses MCollective::RPC::Client</p>
</li><li>
<p>uses ApplicationContainerProxy @id</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2229
2230
2231
2232
2233
2234
2235
2236
2237
2238
2239
2240
2241
2242
2243
2244</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2229</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_district'>set_district</span><span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_active'>active</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mc_args'>mc_args</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:uuid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='comma'>,</span>
              <span class='symbol'>:active</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_active'>active</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_options'>rpc_options</span>
  <span class='id identifier rubyid_rpc_client'>rpc_client</span> <span class='op'>=</span> <span class='const'>MCollectiveApplicationContainerProxy</span><span class='period'>.</span><span class='id identifier rubyid_get_rpc_client'>get_rpc_client</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>openshift</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>begin</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: rpc_client.custom_request(&#39;set_district&#39;, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mc_args'>mc_args</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='embexpr_beg'>#{</span><span class='ivar'>@id</span><span class='embexpr_end'>}</span><span class='tstring_content'>, {&#39;identity&#39; =&gt; </span><span class='embexpr_beg'>#{</span><span class='ivar'>@id</span><span class='embexpr_end'>}</span><span class='tstring_content'>})</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_custom_request'>custom_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>set_district</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_mc_args'>mc_args</span><span class='comma'>,</span> <span class='ivar'>@id</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>identity</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@id</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEBUG: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>ensure</span>
    <span class='id identifier rubyid_rpc_client'>rpc_client</span><span class='period'>.</span><span class='id identifier rubyid_disconnect'>disconnect</span>
  <span class='kw'>end</span>
  <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_quota-instance_method">
  
    - (<tt>Object</tt>) <strong>set_quota</strong>(gear, storage_in_gb, inodes) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>&lt;&lt;object method&gt;&gt;</p>

<p>&lt;&lt;attribute setter&gt;&gt;</p>

<p>Set blocks hard limit and inodes hard limit for uuid. Effects disk quotas
on Gear on Node</p>

<p>INPUT:</p>
<ul><li>
<p>gear: A Gear object</p>
</li><li>
<p>storage_in_gb: integer</p>
</li><li>
<p>inodes: integer</p>
</li></ul>

<p>RETURNS</p>
<ul><li>
<p>Not sure, mcoll_result? a string?</p>
</li></ul>

<p>RAISES:</p>
<ul><li>
<p>OpenShift::NodeException</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>a pair of attribute setters on a Gear object</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 255</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_quota'>set_quota</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_storage_in_gb'>storage_in_gb</span><span class='comma'>,</span> <span class='id identifier rubyid_inodes'>inodes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--uuid</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='comment'># quota command acts on 1K blocks
</span>  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--blocks</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Integer</span><span class='lparen'>(</span><span class='id identifier rubyid_storage_in_gb'>storage_in_gb</span> <span class='op'>*</span> <span class='int'>1024</span> <span class='op'>*</span> <span class='int'>1024</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>--inodes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_inodes'>inodes</span> <span class='kw'>unless</span> <span class='id identifier rubyid_inodes'>inodes</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_reply'>reply</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>set-quota</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_reply'>reply</span> <span class='kw'>and</span> <span class='id identifier rubyid_reply'>reply</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_mcoll_result'>mcoll_result</span> <span class='op'>=</span> <span class='id identifier rubyid_reply'>reply</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_mcoll_result'>mcoll_result</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='kw'>defined?</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:output</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>=</span> <span class='id identifier rubyid_mcoll_result'>mcoll_result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:exitcode</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to set quota for user: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_exitcode'>exitcode</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (error getting result from node).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>NodeException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Node execution failure (error getting result from node).  If the problem persists please contact Red Hat support.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>143</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="show_port-instance_method">
  
    - (<tt>Object</tt>) <strong>show_port</strong>(gear, cart) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get information on a TCP port</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undetermined content</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls run_cartridge_command</p>
</li><li>
<p>executes “show-port” action</p>
</li><li>
<p>method on Gear or Cart?</p>
</li></ul>

<p>Deprecated: remove from the REST API and then delete this.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1264
1265
1266</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1264</span>

<span class='kw'>def</span> <span class='id identifier rubyid_show_port'>show_port</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span>
  <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="show_state-instance_method">
  
    - (<tt>Object</tt>) <strong>show_state</strong>(gear) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the operating state of a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: Gear Object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>mcollective result string (stdout)</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses execute_direct</p>
</li><li>
<p>calls oo-app-state-show</p>
</li><li>
<p>Should be a method on Gear object</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


650
651
652
653
654</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 650</span>

<span class='kw'>def</span> <span class='id identifier rubyid_show_state'>show_state</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>app-state-show</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start-instance_method">
  
    - (<tt>Object</tt>) <strong>start</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Start cartridge services within a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undetermined state</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses run_cartridge_command</p>
</li><li>
<p>uses start_component</p>
</li><li>
<p>should be a method on Gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


945
946
947
948
949
950
951</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 945</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_run_cartridge_command_ignore_components'>run_cartridge_command_ignore_components</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>start</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start_component-instance_method">
  
    - (<tt>Object</tt>) <strong>start_component</strong>(gear, component)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Start a component service</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>component: String: a component name</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO?</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>method on gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2355
2356
2357
2358
2359
2360
2361</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2355</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start_component'>start_component</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>

  <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>start</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="status-instance_method">
  
    - (<tt>Object</tt>) <strong>status</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the status from cart services in an existing Gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>A ResultIO object of undetermined content</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on gear or cartridge?</p>
</li><li>
<p>uses run_cartridge_command</p>
</li><li>
<p>component_status</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1090
1091
1092
1093
1094
1095
1096</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1090</span>

<span class='kw'>def</span> <span class='id identifier rubyid_status'>status</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_run_cartridge_command_ignore_components'>run_cartridge_command_ignore_components</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop-instance_method">
  
    - (<tt>Object</tt>) <strong>stop</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Stop cartridge services within a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undetermined state</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>uses run_cartridge_command</p>
</li><li>
<p>uses stop_component</p>
</li><li>
<p>uses start_component</p>
</li><li>
<p>should be a method on Gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


975
976
977
978
979
980
981</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 975</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stop'>stop</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_run_cartridge_command_ignore_components'>run_cartridge_command_ignore_components</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>stop</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop_component-instance_method">
  
    - (<tt>Object</tt>) <strong>stop_component</strong>(gear, component)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Stop a component service</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>component: String: a component name</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>ResultIO?</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>method on gear?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2376
2377
2378
2379
2380
2381
2382</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 2376</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stop_component'>stop_component</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>

  <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>stop</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="system_messages-instance_method">
  
    - (<tt>Object</tt>) <strong>system_messages</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>“retrieve the system messages”</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undetermined content</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls run_cartridge_command</p>
</li><li>
<p>method on Gear or Cart?</p>
</li><li>
<p>only applies to the “framework” services</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1172</span>

<span class='kw'>def</span> <span class='id identifier rubyid_system_messages'>system_messages</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_framework_carts'>framework_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>system-messages</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="threaddump-instance_method">
  
    - (<tt>Object</tt>) <strong>threaddump</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>dump the cartridge threads</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>a ResultIO of undetermined content</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>calls run_cartridge_command</p>
</li><li>
<p>method on Gear or Cart?</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_threaddump'>threaddump</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cart'>cart</span> <span class='op'>=</span> <span class='id identifier rubyid_component'>component</span><span class='period'>.</span><span class='id identifier rubyid_cartridge_name'>cartridge_name</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_component_args'>build_base_component_args</span><span class='lparen'>(</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_framework_carts'>framework_carts</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_run_cartridge_command'>run_cartridge_command</span><span class='lparen'>(</span><span class='id identifier rubyid_cart'>cart</span><span class='comma'>,</span> <span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>threaddump</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='const'>ResultIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tidy-instance_method">
  
    - (<tt>Object</tt>) <strong>tidy</strong>(gear, component) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Clean up unneeded artifacts in a gear</p>

<p>INPUTS:</p>
<ul><li>
<p>gear: a Gear object</p>
</li><li>
<p>cart: a Cartridge object</p>
</li></ul>

<p>RETURNS:</p>
<ul><li>
<p>String: stdout from a command</p>
</li></ul>

<p>NOTES</p>
<ul><li>
<p>calls the &#39;tidy&#39; hook on a Gear or app?</p>
</li><li>
<p>doesn&#39;t use cart input</p>
</li><li>
<p>calls execute_direct</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1113
1114
1115
1116
1117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 1113</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tidy'>tidy</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='comma'>,</span> <span class='id identifier rubyid_component'>component</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_build_base_gear_args'>build_base_gear_args</span><span class='lparen'>(</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_execute_direct'>execute_direct</span><span class='lparen'>(</span><span class='cvar'>@@C_CONTROLLER</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tidy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parse_result'>parse_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unreserve_uid-instance_method">
  
    - (<tt>Object</tt>) <strong>unreserve_uid</strong>(uid, district_uuid = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Release a UID reservation within a District</p>

<p>UIDs must be unique in a district to allow migration without requiring
reassigning Username (Gear UUID) and Unix User UID on migrate Perhaps a
query on the nodes for “next UID”?</p>

<p>INPUTS:</p>
<ul><li>
<p>uid: Integer - the UID to unreserve within the district</p>
</li><li>
<p>district_uuid: String - district handle or identifier</p>
</li></ul>

<p>NOTES:</p>
<ul><li>
<p>method on the District object.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


324
325
326
327
328
329
330
331
332
333
334
335
336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/plugins/msg-broker/mcollective/lib/openshift/mcollective_application_container_proxy.rb', line 324</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unreserve_uid'>unreserve_uid</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_msg_broker'>msg_broker</span><span class='lbracket'>[</span><span class='symbol'>:districts</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:enabled</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='ivar'>@district</span>
      <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>=</span> <span class='ivar'>@district</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>=</span> <span class='id identifier rubyid_get_district_uuid'>get_district_uuid</span> <span class='kw'>unless</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_district_uuid'>district_uuid</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NONE</span><span class='tstring_end'>&#39;</span></span>
      <span class='comment'>#cleanup
</span>      <span class='const'>District</span><span class='op'>::</span><span class='id identifier rubyid_unreserve_uid'>unreserve_uid</span><span class='lparen'>(</span><span class='id identifier rubyid_district_uuid'>district_uuid</span><span class='comma'>,</span> <span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Jul 25 21:11:11 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>