<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: OpenShift::Runtime::FrontendProxyServer
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../OpenShift.html" title="OpenShift (module)">OpenShift</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Runtime.html" title="OpenShift::Runtime (module)">Runtime</a></span></span>
     &raquo; 
    <span class="title">FrontendProxyServer</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: OpenShift::Runtime::FrontendProxyServer
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">OpenShift::Runtime::FrontendProxyServer</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="NodeLogger.html" title="OpenShift::Runtime::NodeLogger (module)">NodeLogger</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<h2 id="label-Frontend+Proxy+Server">Frontend Proxy Server<span><a href="#label-Frontend+Proxy+Server">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<p>Represents the front-end proxy server on the system. Upon initialization,
defaults necessary to compute ranges are extracted from Openshift::Config.</p>

<p>Note: This is the HAProxy implementation; other implementations may vary.</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="NodeLogger.html" title="OpenShift::Runtime::NodeLogger (module)">NodeLogger</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="NodeLogger.html#DEFAULT_LOGGER_CLASS-constant" title="OpenShift::Runtime::NodeLogger::DEFAULT_LOGGER_CLASS (constant)">NodeLogger::DEFAULT_LOGGER_CLASS</a></span></p>





  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add-instance_method" title="#add (instance method)">- (Object) <strong>add</strong>(uid, ip, port) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds a new proxy mapping for the specified UID, IP and target port using
the next available proxy port in the user&#39;s range.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">- (Object) <strong>delete</strong>(uid, ip, port) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Deletes an existing proxy mapping for the specified UID, IP and port.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_all-instance_method" title="#delete_all (instance method)">- (Object) <strong>delete_all</strong>(proxy_ports, ignore_errors = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Deletes all proxy ports in the specified array.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_all_for_uid-instance_method" title="#delete_all_for_uid (instance method)">- (Object) <strong>delete_all_for_uid</strong>(uid, ignore_errors = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Deletes any existing proxy ports associated with the given UID.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_mapped_proxy_port-instance_method" title="#find_mapped_proxy_port (instance method)">- (Object) <strong>find_mapped_proxy_port</strong>(uid, ip, port) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find the proxy port for a given UID, IP and target port.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (FrontendProxyServer) <strong>initialize</strong> </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of FrontendProxyServer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#port_range-instance_method" title="#port_range (instance method)">- (Object) <strong>port_range</strong>(uid) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a Range representing the valid proxy port values for the given UID.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#system_proxy_delete-instance_method" title="#system_proxy_delete (instance method)">- (Object) <strong>system_proxy_delete</strong>(*ports) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>System interface to delete one or more proxy entries.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#system_proxy_set-instance_method" title="#system_proxy_set (instance method)">- (Object) <strong>system_proxy_set</strong>(*mappings) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>System interface to set a proxy entry.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#system_proxy_show-instance_method" title="#system_proxy_show (instance method)">- (Object) <strong>system_proxy_show</strong>(proxy_port) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>System interface to show an existing proxy entry.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="NodeLogger.html" title="OpenShift::Runtime::NodeLogger (module)">NodeLogger</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="NodeLogger.html#context-class_method" title="OpenShift::Runtime::NodeLogger.context (method)">context</a></span>, <span class='object_link'><a href="NodeLogger.html#create_logger-class_method" title="OpenShift::Runtime::NodeLogger.create_logger (method)">create_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#disable-class_method" title="OpenShift::Runtime::NodeLogger.disable (method)">disable</a></span>, <span class='object_link'><a href="NodeLogger.html#load_config-class_method" title="OpenShift::Runtime::NodeLogger.load_config (method)">load_config</a></span>, <span class='object_link'><a href="NodeLogger.html#logger-class_method" title="OpenShift::Runtime::NodeLogger.logger (method)">logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger-instance_method" title="OpenShift::Runtime::NodeLogger#logger (method)">#logger</a></span>, <span class='object_link'><a href="NodeLogger.html#set_logger-class_method" title="OpenShift::Runtime::NodeLogger.set_logger (method)">set_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#stderr-class_method" title="OpenShift::Runtime::NodeLogger.stderr (method)">stderr</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="OpenShift::Runtime::FrontendProxyServer (class)">FrontendProxyServer</a></span></tt>) <strong>initialize</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A new instance of FrontendProxyServer</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='comment'># Extract config values and compute the port range this proxy
</span>  <span class='comment'># instance should act upon, relative to the given container/user.
</span>  <span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Config</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='ivar'>@port_begin</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PORT_BEGIN</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>35531</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@ports_per_user</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PORTS_PER_USER</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@uid_begin</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UID_BEGIN</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>500</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add-instance_method">
  
    - (<tt>Object</tt>) <strong>add</strong>(uid, ip, port) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Adds a new proxy mapping for the specified UID, IP and target port using
the next available proxy port in the user&#39;s range.</p>

<p>Returns an Integer value for the mapped proxy port on success. Raises a
FrontendProxyServerException if the mapping attempt fails or if no ports
are left available to map.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FrontendProxyServerException.html" title="OpenShift::Runtime::FrontendProxyServerException (class)">FrontendProxyServerException</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 145</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No UID specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No IP specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_ip'>ip</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No port specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_port'>port</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid port specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_port'>port</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Integer</span>

  <span class='id identifier rubyid_requested_addr'>requested_addr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ip'>ip</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_port_range'>port_range</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='op'>|</span>
    <span class='comment'># Get the existing mapped address for this proxy port
</span>    <span class='id identifier rubyid_current_addr'>current_addr</span> <span class='op'>=</span> <span class='id identifier rubyid_system_proxy_show'>system_proxy_show</span><span class='lparen'>(</span><span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='rparen'>)</span>

    <span class='comment'># If there&#39;s already a mapping for this proxy port, return
</span>    <span class='comment'># the existing mapping if it matches the request, otherwise
</span>    <span class='comment'># skip it as being already in use
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_current_addr'>current_addr</span> <span class='op'>!=</span> <span class='kw'>nil</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_current_addr'>current_addr</span> <span class='op'>==</span> <span class='id identifier rubyid_requested_addr'>requested_addr</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_proxy_port'>proxy_port</span>
      <span class='kw'>else</span>
        <span class='kw'>next</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'># No existing mapping exists, so attempt to create one
</span>    <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span> <span class='op'>=</span> <span class='id identifier rubyid_system_proxy_set'>system_proxy_set</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='symbol'>:proxy_port</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='comma'>,</span> <span class='symbol'>:addr</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_requested_addr'>requested_addr</span><span class='rbrace'>}</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_rc'>rc</span> <span class='op'>!=</span> <span class='int'>0</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>FrontendProxyServerException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>System proxy set for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='embexpr_end'>}</span><span class='tstring_content'>=&gt;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_requested_addr'>requested_addr</span><span class='embexpr_end'>}</span><span class='tstring_content'> failed(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rc'>rc</span><span class='embexpr_end'>}</span><span class='tstring_content'>): stdout: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_out'>out</span><span class='embexpr_end'>}</span><span class='tstring_content'> stderr: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_err'>err</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_proxy_port'>proxy_port</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>FrontendProxyServerException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No ports were left available to map </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_requested_addr'>requested_addr</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete-instance_method">
  
    - (<tt>Object</tt>) <strong>delete</strong>(uid, ip, port) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Deletes an existing proxy mapping for the specified UID, IP and port.</p>

<p>Returns nil on success or a FrontendProxyServerException on failure.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 78</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No UID specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No IP specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_ip'>ip</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No port specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_port'>port</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid port specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_port'>port</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Integer</span>

  <span class='id identifier rubyid_target_addr'>target_addr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ip'>ip</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_mapped_proxy_port'>mapped_proxy_port</span> <span class='op'>=</span> <span class='id identifier rubyid_find_mapped_proxy_port'>find_mapped_proxy_port</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>

  <span class='comment'># No existing mapping, nothing to do.
</span>  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_mapped_proxy_port'>mapped_proxy_port</span> <span class='op'>==</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span> <span class='op'>=</span> <span class='id identifier rubyid_system_proxy_delete'>system_proxy_delete</span><span class='lparen'>(</span><span class='id identifier rubyid_mapped_proxy_port'>mapped_proxy_port</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_rc'>rc</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>FrontendProxyServerException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>System proxy failed to delete </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mapped_proxy_port'>mapped_proxy_port</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target_addr'>target_addr</span><span class='embexpr_end'>}</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rc'>rc</span><span class='embexpr_end'>}</span><span class='tstring_content'>): stdout: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_out'>out</span><span class='embexpr_end'>}</span><span class='tstring_content'> stderr: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_err'>err</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_all-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_all</strong>(proxy_ports, ignore_errors = true) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Deletes all proxy ports in the specified array.</p>

<p>If ignore_errors is specified, any delete attempts will be logged and
ignored. Otherwise, any exception will be immediately be re-raised.</p>

<p>Returns the exit code from the call to system_proxy_delete if no exception
is raised.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 122</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_all'>delete_all</span><span class='lparen'>(</span><span class='id identifier rubyid_proxy_ports'>proxy_ports</span><span class='comma'>,</span> <span class='id identifier rubyid_ignore_errors'>ignore_errors</span><span class='op'>=</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No proxy ports specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_proxy_ports'>proxy_ports</span> <span class='op'>==</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span> <span class='op'>=</span> <span class='id identifier rubyid_system_proxy_delete'>system_proxy_delete</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_proxy_ports'>proxy_ports</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_rc'>rc</span> <span class='op'>!=</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>System proxy delete of port(s) </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_proxy_ports'>proxy_ports</span><span class='embexpr_end'>}</span><span class='tstring_content'> failed(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rc'>rc</span><span class='embexpr_end'>}</span><span class='tstring_content'>): stdout: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_out'>out</span><span class='embexpr_end'>}</span><span class='tstring_content'> stderr: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_err'>err</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_ignore_errors'>ignore_errors</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>FrontendProxyServerException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_rc'>rc</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_all_for_uid-instance_method">
  
    - (<tt>Object</tt>) <strong>delete_all_for_uid</strong>(uid, ignore_errors = true) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Deletes any existing proxy ports associated with the given UID.</p>

<p>If ignore_errors is specified, any delete attempts will be logged and
ignored. Otherwise, any exception will be immediately be re-raised.</p>

<p>Returns nil on success.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


105
106
107
108
109
110
111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 105</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_all_for_uid'>delete_all_for_uid</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_ignore_errors'>ignore_errors</span><span class='op'>=</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No UID specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span> <span class='op'>==</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_proxy_ports'>proxy_ports</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_port_range'>port_range</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='op'>|</span> <span class='id identifier rubyid_proxy_ports'>proxy_ports</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_proxy_port'>proxy_port</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_delete_all'>delete_all</span><span class='lparen'>(</span><span class='id identifier rubyid_proxy_ports'>proxy_ports</span><span class='comma'>,</span> <span class='id identifier rubyid_ignore_errors'>ignore_errors</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_mapped_proxy_port-instance_method">
  
    - (<tt>Object</tt>) <strong>find_mapped_proxy_port</strong>(uid, ip, port) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find the proxy port for a given UID, IP and target port.</p>

<p>Examples:</p>

<pre class="ruby"><span class="ruby-identifier">find_mapped_proxy_port</span>(<span class="ruby-value">500</span>, <span class="ruby-string">&#39;127.0.0.1&#39;</span>, <span class="ruby-value">8080</span>)
=<span class="ruby-operator">&gt;</span> <span class="ruby-value">35531</span>
</pre>

<p>Returns the proxy port if found, otherwise nil.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_mapped_proxy_port'>find_mapped_proxy_port</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No UID specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No IP specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_ip'>ip</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No port specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_port'>port</span> <span class='op'>==</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid port specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_port'>port</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Integer</span>

  <span class='id identifier rubyid_target_addr'>target_addr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ip'>ip</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_mapped_proxy_port'>mapped_proxy_port</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_port_range'>port_range</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='op'>|</span>
    <span class='id identifier rubyid_current_addr'>current_addr</span> <span class='op'>=</span> <span class='id identifier rubyid_system_proxy_show'>system_proxy_show</span><span class='lparen'>(</span><span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_current_addr'>current_addr</span> <span class='op'>==</span> <span class='id identifier rubyid_target_addr'>target_addr</span>
      <span class='id identifier rubyid_mapped_proxy_port'>mapped_proxy_port</span> <span class='op'>=</span> <span class='id identifier rubyid_proxy_port'>proxy_port</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_mapped_proxy_port'>mapped_proxy_port</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="port_range-instance_method">
  
    - (<tt>Object</tt>) <strong>port_range</strong>(uid) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a Range representing the valid proxy port values for the given UID.</p>

<p>The port proxy range is determined by configuration and must produce
identical results to the abstract cartridge provided range.</p>

<p>Note, due to a mismatch between dev and prod this is intentionally not
GEAR_MIN_UID and the range must wrap back around on itself.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_port_range'>port_range</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_proxy_port_begin'>proxy_port_begin</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span> <span class='op'>-</span> <span class='ivar'>@uid_begin</span><span class='rparen'>)</span> <span class='op'>%</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>65536</span> <span class='op'>-</span> <span class='ivar'>@port_begin</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='ivar'>@ports_per_user</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='ivar'>@ports_per_user</span> <span class='op'>+</span> <span class='ivar'>@port_begin</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_proxy_port_begin'>proxy_port_begin</span> <span class='op'>...</span> <span class='lparen'>(</span><span class='id identifier rubyid_proxy_port_begin'>proxy_port_begin</span> <span class='op'>+</span> <span class='ivar'>@ports_per_user</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="system_proxy_delete-instance_method">
  
    - (<tt>Object</tt>) <strong>system_proxy_delete</strong>(*ports) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>System interface to delete one or more proxy entries.</p>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">system_proxy_delete</span>(<span class="ruby-value">30000</span>)
=<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">out</span>, <span class="ruby-identifier">err</span>, <span class="ruby-identifier">rc</span>]

<span class="ruby-identifier">system_proxy_delete</span>(<span class="ruby-value">30000</span>, <span class="ruby-value">30001</span>, <span class="ruby-value">30002</span>)
=<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">out</span>, <span class="ruby-identifier">err</span>, <span class="ruby-identifier">rc</span>]
</pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


221
222
223
224
225
226
227
228
229
230
231</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 221</span>

<span class='kw'>def</span> <span class='id identifier rubyid_system_proxy_delete'>system_proxy_delete</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_ports'>ports</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ports'>ports</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_ports'>ports</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_cmd'>cmd</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>%{</span><span class='tstring_content'>openshift-port-proxy-cfg setproxy</span><span class='tstring_end'>}</span></span>
    <span class='id identifier rubyid_ports'>ports</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_port'>port</span><span class='op'>|</span> <span class='id identifier rubyid_cmd'>cmd</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_content'> delete</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Runtime</span><span class='op'>::</span><span class='const'>Utils</span><span class='op'>::</span><span class='id identifier rubyid_oo_spawn'>oo_spawn</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='int'>0</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="system_proxy_set-instance_method">
  
    - (<tt>Object</tt>) <strong>system_proxy_set</strong>(*mappings) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>System interface to set a proxy entry. Expects a varargs array of hashes
with keys :proxy_port and :addr representing a mapping entry.</p>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">system_proxy_set</span>({:<span class="ruby-identifier">proxy_port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">30000</span>, :<span class="ruby-identifier">addr</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;127.0.0.1:8080&quot;</span>})
=<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">out</span>, <span class="ruby-identifier">err</span>, <span class="ruby-identifier">rc</span>]

<span class="ruby-identifier">system_proxy_set</span>(
  {:<span class="ruby-identifier">proxy_port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">30000</span>, :<span class="ruby-identifier">addr</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;127.0.0.1:8080&quot;</span>},
  {:<span class="ruby-identifier">proxy_port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">30001</span>, :<span class="ruby-identifier">addr</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;127.0.0.1:8081&quot;</span>}
)
=<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">out</span>, <span class="ruby-identifier">err</span>, <span class="ruby-identifier">rc</span>]
</pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


247
248
249
250
251
252
253
254
255
256
257</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 247</span>

<span class='kw'>def</span> <span class='id identifier rubyid_system_proxy_set'>system_proxy_set</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_mappings'>mappings</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_mappings'>mappings</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_mappings'>mappings</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_cmd'>cmd</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>%{</span><span class='tstring_content'>openshift-port-proxy-cfg setproxy</span><span class='tstring_end'>}</span></span>
    <span class='id identifier rubyid_mappings'>mappings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mapping'>mapping</span><span class='op'>|</span> <span class='id identifier rubyid_cmd'>cmd</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>%Q{</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mapping'>mapping</span><span class='lbracket'>[</span><span class='symbol'>:proxy_port</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> &quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mapping'>mapping</span><span class='lbracket'>[</span><span class='symbol'>:addr</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>&quot;</span><span class='tstring_end'>}</span></span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Runtime</span><span class='op'>::</span><span class='const'>Utils</span><span class='op'>::</span><span class='id identifier rubyid_oo_spawn'>oo_spawn</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='int'>0</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="system_proxy_show-instance_method">
  
    - (<tt>Object</tt>) <strong>system_proxy_show</strong>(proxy_port) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>System interface to show an existing proxy entry.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


260
261
262
263
264
265
266
267</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/home/fedora/origin-server/node/lib/openshift-origin-node/model/frontend_proxy.rb', line 260</span>

<span class='kw'>def</span> <span class='id identifier rubyid_system_proxy_show'>system_proxy_show</span><span class='lparen'>(</span><span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No proxy port specified</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_proxy_port'>proxy_port</span> <span class='op'>!=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_rc'>rc</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenShift</span><span class='op'>::</span><span class='const'>Runtime</span><span class='op'>::</span><span class='const'>Utils</span><span class='op'>::</span><span class='id identifier rubyid_oo_spawn'>oo_spawn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>%{</span><span class='tstring_content'>openshift-port-proxy-cfg showproxy </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_proxy_port'>proxy_port</span><span class='embexpr_end'>}</span><span class='tstring_content'> | awk &#39;{ print $2 }&#39;</span><span class='tstring_end'>}</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_chomp!'>chomp!</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='op'>?</span> <span class='id identifier rubyid_target'>target</span> <span class='op'>:</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Sep  6 22:05:43 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>